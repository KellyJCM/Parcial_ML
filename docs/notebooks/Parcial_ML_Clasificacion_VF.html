
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Clasificación &#8212; Parcial de Machine Learning</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/Parcial_ML_Clasificacion_VF';</script>
    <link rel="canonical" href="/Parcial_ML/notebooks/Parcial_ML_Clasificacion_VF.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Welcome to your Jupyter Book" href="../intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Parcial de Machine Learning - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Parcial de Machine Learning - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><strong>Clasificación</strong></a></li>




</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/KellyJCM/Parcial_ML" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/KellyJCM/Parcial_ML/issues/new?title=Issue%20on%20page%20%2Fnotebooks/Parcial_ML_Clasificacion_VF.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/Parcial_ML_Clasificacion_VF.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Clasificación</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#"><strong>Clasificación</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#lectura-de-datos"><strong>Lectura de Datos</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-exploratorio-de-datos-eda"><strong>Análisis Exploratorio de Datos - EDA</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#descripcion-de-los-tipos-de-variables">Descripción de los tipos de variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estadisticas-descriptivas-basicas">Estadísticas descriptivas básicas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conteo-de-valores-nulos-y-porcentaje-de-datos-faltantes">Conteo de valores nulos y porcentaje de datos faltantes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imputacion-de-datos-faltantes-variables-numericas">Imputación  de datos faltantes variables numericas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacion-de-variance-inflation-factor-vif">Implementación de Variance Inflation Factor (VIF)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imputacion-de-datos-faltantes-variables-categoricas">Imputación de datos faltantes variables categóricas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-categoricas-multicolinealidad-usando-la-prueba-chi2-contingency">Variables Categoricas: Multicolinealidad usando la prueba chi2_contingency()</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-de-las-variables">Visualización de las variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-simetria">Analisis de Simetría</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-datos-atipicos">Analisis de datos atipicos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-dispersion">Analisis de Dispersión</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-casi-constantes">Variables casi constantes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-bivariado">Analisis bivariado</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-clasificacion"><strong>Modelos de Clasificación</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocesamiento">Preprocesamiento</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#logistic-regression">Logistic Regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bayesian-classification">Bayesian Classification</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#random-forest">Random Forest</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#xgboost">XGBoost</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#knn">KNN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mlp">MLP</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#svm">SVM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mejor-modelo">Mejor Modelo</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#test"><strong>Test</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imputacion-de-datos-nulos">Imputación de datos nulos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#predecir-la-variable-de-respuesta">Predecir la variable de respuesta</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="clasificacion">
<h1><strong>Clasificación</strong><a class="headerlink" href="#clasificacion" title="Link to this heading">#</a></h1>
<p><strong>Integrantes</strong></p>
<ul class="simple">
<li><p>Kelly Carrascal</p></li>
<li><p>Sebastián Herazo</p></li>
</ul>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="lectura-de-datos">
<h1><strong>Lectura de Datos</strong><a class="headerlink" href="#lectura-de-datos" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="c1"># Leer archivos de transacciones</span>
<span class="n">train_transaction</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;train_transaction.csv&#39;</span><span class="p">)</span>
<span class="n">test_transaction</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;test_transaction.csv&#39;</span><span class="p">)</span>

<span class="c1"># Leer archivos de identidad</span>
<span class="n">train_identity</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;train_identity.csv&#39;</span><span class="p">)</span>
<span class="n">test_identity</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;test_identity.csv&#39;</span><span class="p">)</span>

<span class="c1"># Visualizar dimensiones de cada dataset</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Train Transaction:&quot;</span><span class="p">,</span> <span class="n">train_transaction</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test Transaction:&quot;</span><span class="p">,</span> <span class="n">test_transaction</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Train Identity:&quot;</span><span class="p">,</span> <span class="n">train_identity</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test Identity:&quot;</span><span class="p">,</span> <span class="n">test_identity</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># Vista previa de los datasets</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Vista previa de train_transaction:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">train_transaction</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Vista previa de train_identity:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">train_identity</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="c1"># Leer archivos de transacciones</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">train_transaction</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;train_transaction.csv&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">test_transaction</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;test_transaction.csv&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="c1"># Leer archivos de identidad</span>

<span class="nn">File ~\.conda\envs\sklearn_env\lib\site-packages\pandas\io\parsers\readers.py:1026,</span> in <span class="ni">read_csv</span><span class="nt">(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, date_format, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options, dtype_backend)</span>
<span class="g g-Whitespace">   </span><span class="mi">1013</span> <span class="n">kwds_defaults</span> <span class="o">=</span> <span class="n">_refine_defaults_read</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1014</span>     <span class="n">dialect</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1015</span>     <span class="n">delimiter</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1022</span>     <span class="n">dtype_backend</span><span class="o">=</span><span class="n">dtype_backend</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1023</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1024</span> <span class="n">kwds</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwds_defaults</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1026</span> <span class="k">return</span> <span class="n">_read</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="n">kwds</span><span class="p">)</span>

<span class="nn">File ~\.conda\envs\sklearn_env\lib\site-packages\pandas\io\parsers\readers.py:620,</span> in <span class="ni">_read</span><span class="nt">(filepath_or_buffer, kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">617</span> <span class="n">_validate_names</span><span class="p">(</span><span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;names&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">619</span> <span class="c1"># Create the parser.</span>
<span class="ne">--&gt; </span><span class="mi">620</span> <span class="n">parser</span> <span class="o">=</span> <span class="n">TextFileReader</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">622</span> <span class="k">if</span> <span class="n">chunksize</span> <span class="ow">or</span> <span class="n">iterator</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">623</span>     <span class="k">return</span> <span class="n">parser</span>

<span class="nn">File ~\.conda\envs\sklearn_env\lib\site-packages\pandas\io\parsers\readers.py:1620,</span> in <span class="ni">TextFileReader.__init__</span><span class="nt">(self, f, engine, **kwds)</span>
<span class="g g-Whitespace">   </span><span class="mi">1617</span>     <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwds</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">1619</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="p">:</span> <span class="n">IOHandles</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="ne">-&gt; </span><span class="mi">1620</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_engine</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="p">)</span>

<span class="nn">File ~\.conda\envs\sklearn_env\lib\site-packages\pandas\io\parsers\readers.py:1880,</span> in <span class="ni">TextFileReader._make_engine</span><span class="nt">(self, f, engine)</span>
<span class="g g-Whitespace">   </span><span class="mi">1878</span>     <span class="k">if</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mode</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1879</span>         <span class="n">mode</span> <span class="o">+=</span> <span class="s2">&quot;b&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1880</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="o">=</span> <span class="n">get_handle</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1881</span>     <span class="n">f</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1882</span>     <span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1883</span>     <span class="n">encoding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1884</span>     <span class="n">compression</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;compression&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1885</span>     <span class="n">memory_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memory_map&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1886</span>     <span class="n">is_text</span><span class="o">=</span><span class="n">is_text</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1887</span>     <span class="n">errors</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding_errors&quot;</span><span class="p">,</span> <span class="s2">&quot;strict&quot;</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1888</span>     <span class="n">storage_options</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;storage_options&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1889</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1890</span> <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="g g-Whitespace">   </span><span class="mi">1891</span> <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="o">.</span><span class="n">handle</span>

<span class="nn">File ~\.conda\envs\sklearn_env\lib\site-packages\pandas\io\common.py:873,</span> in <span class="ni">get_handle</span><span class="nt">(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">868</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">869</span>     <span class="c1"># Check whether the filename is to be opened in binary mode.</span>
<span class="g g-Whitespace">    </span><span class="mi">870</span>     <span class="c1"># Binary mode does not support &#39;encoding&#39; and &#39;newline&#39;.</span>
<span class="g g-Whitespace">    </span><span class="mi">871</span>     <span class="k">if</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span> <span class="ow">and</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">872</span>         <span class="c1"># Encoding</span>
<span class="ne">--&gt; </span><span class="mi">873</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">874</span>             <span class="n">handle</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">875</span>             <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">876</span>             <span class="n">encoding</span><span class="o">=</span><span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">877</span>             <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">878</span>             <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">879</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">880</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">881</span>         <span class="c1"># Binary mode</span>
<span class="g g-Whitespace">    </span><span class="mi">882</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;train_transaction.csv&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge del conjunto de entrenamiento</span>
<span class="n">train_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">train_transaction</span><span class="p">,</span> <span class="n">train_identity</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;TransactionID&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Merge del conjunto de prueba</span>
<span class="n">test_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">test_transaction</span><span class="p">,</span> <span class="n">test_identity</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;TransactionID&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Confirmar dimensiones después del merge</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Train merged shape:&quot;</span><span class="p">,</span> <span class="n">train_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test merged shape:&quot;</span><span class="p">,</span> <span class="n">test_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># Vista previa del dataset combinado</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Vista previa de train_df:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">train_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Train merged shape: (590540, 434)
Test merged shape: (506691, 433)

Vista previa de train_df:
   TransactionID  isFraud  TransactionDT  TransactionAmt ProductCD  card1  \
0        2987000        0          86400            68.5         W  13926   
1        2987001        0          86401            29.0         W   2755   
2        2987002        0          86469            59.0         W   4663   
3        2987003        0          86499            50.0         W  18132   
4        2987004        0          86506            50.0         H   4497   

   card2  card3       card4  card5  ...                id_31  id_32  \
0    NaN  150.0    discover  142.0  ...                  NaN    NaN   
1  404.0  150.0  mastercard  102.0  ...                  NaN    NaN   
2  490.0  150.0        visa  166.0  ...                  NaN    NaN   
3  567.0  150.0  mastercard  117.0  ...                  NaN    NaN   
4  514.0  150.0  mastercard  102.0  ...  samsung browser 6.2   32.0   

       id_33           id_34  id_35 id_36 id_37  id_38  DeviceType  \
0        NaN             NaN    NaN   NaN   NaN    NaN         NaN   
1        NaN             NaN    NaN   NaN   NaN    NaN         NaN   
2        NaN             NaN    NaN   NaN   NaN    NaN         NaN   
3        NaN             NaN    NaN   NaN   NaN    NaN         NaN   
4  2220x1080  match_status:2      T     F     T      T      mobile   

                      DeviceInfo  
0                            NaN  
1                            NaN  
2                            NaN  
3                            NaN  
4  SAMSUNG SM-G892A Build/NRD90M  

[5 rows x 434 columns]
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="analisis-exploratorio-de-datos-eda">
<h1><strong>Análisis Exploratorio de Datos - EDA</strong><a class="headerlink" href="#analisis-exploratorio-de-datos-eda" title="Link to this heading">#</a></h1>
<section id="descripcion-de-los-tipos-de-variables">
<h2>Descripción de los tipos de variables<a class="headerlink" href="#descripcion-de-los-tipos-de-variables" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tipos de variables</span>
<span class="n">tipos_variables</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tipos de variables en el dataset:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tipos_variables</span><span class="p">)</span>

<span class="c1"># Detalle de los tipos por columna</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Tipos por columna:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">train_df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tipos de variables en el dataset:
 float64    399
object      31
int64        4
Name: count, dtype: int64

Tipos por columna:
TransactionID       int64
isFraud             int64
TransactionDT       int64
TransactionAmt    float64
ProductCD          object
                   ...   
id_36              object
id_37              object
id_38              object
DeviceType         object
DeviceInfo         object
Length: 434, dtype: object
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><strong>Variables tipo float64 (399 columnas):</strong> La mayoría de las columnas del dataset son variables numéricas, lo que indica que estas variables puedan requerir imputación de valores nulos y escalamiento.</p></li>
<li><p><strong>Variables tipo object (31 columnas):</strong> Estas columnas corresponden a variables categóricas o texto, como códigos de productos, tipos de tarjeta, dominios de correo o firmas digitales. Deberán ser codificadas antes de aplicar modelos de clasificación (con one-hot encoding).</p></li>
<li><p><strong>Variables tipo int64 (4 columnas):</strong> Estas son variables enteras, posiblemente identificadores o variables binarias como isFraud, que es nuestra variable objetivo. También puede incluir marcas de tiempo o contadores discretos.</p></li>
</ul>
</section>
<section id="estadisticas-descriptivas-basicas">
<h2>Estadísticas descriptivas básicas<a class="headerlink" href="#estadisticas-descriptivas-basicas" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Número de observaciones y estadísticas numéricas</span>
<span class="n">stats_basicas</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Estadísticas básicas:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">stats_basicas</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Estadísticas básicas:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>TransactionID</th>
      <td>590540.0</td>
      <td>3.282270e+06</td>
      <td>1.704744e+05</td>
      <td>2987000.000</td>
      <td>3134634.750</td>
      <td>3282269.500</td>
      <td>3429904.25</td>
      <td>3.577539e+06</td>
    </tr>
    <tr>
      <th>isFraud</th>
      <td>590540.0</td>
      <td>3.499001e-02</td>
      <td>1.837546e-01</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.00</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>TransactionDT</th>
      <td>590540.0</td>
      <td>7.372311e+06</td>
      <td>4.617224e+06</td>
      <td>86400.000</td>
      <td>3027057.750</td>
      <td>7306527.500</td>
      <td>11246620.00</td>
      <td>1.581113e+07</td>
    </tr>
    <tr>
      <th>TransactionAmt</th>
      <td>590540.0</td>
      <td>1.350272e+02</td>
      <td>2.391625e+02</td>
      <td>0.251</td>
      <td>43.321</td>
      <td>68.769</td>
      <td>125.00</td>
      <td>3.193739e+04</td>
    </tr>
    <tr>
      <th>card1</th>
      <td>590540.0</td>
      <td>9.898735e+03</td>
      <td>4.901170e+03</td>
      <td>1000.000</td>
      <td>6019.000</td>
      <td>9678.000</td>
      <td>14184.00</td>
      <td>1.839600e+04</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>id_22</th>
      <td>5169.0</td>
      <td>1.600271e+01</td>
      <td>6.897665e+00</td>
      <td>10.000</td>
      <td>14.000</td>
      <td>14.000</td>
      <td>14.00</td>
      <td>4.400000e+01</td>
    </tr>
    <tr>
      <th>id_24</th>
      <td>4747.0</td>
      <td>1.280093e+01</td>
      <td>2.372447e+00</td>
      <td>11.000</td>
      <td>11.000</td>
      <td>11.000</td>
      <td>15.00</td>
      <td>2.600000e+01</td>
    </tr>
    <tr>
      <th>id_25</th>
      <td>5132.0</td>
      <td>3.296089e+02</td>
      <td>9.746109e+01</td>
      <td>100.000</td>
      <td>321.000</td>
      <td>321.000</td>
      <td>371.00</td>
      <td>5.480000e+02</td>
    </tr>
    <tr>
      <th>id_26</th>
      <td>5163.0</td>
      <td>1.490703e+02</td>
      <td>3.210199e+01</td>
      <td>100.000</td>
      <td>119.000</td>
      <td>149.000</td>
      <td>169.00</td>
      <td>2.160000e+02</td>
    </tr>
    <tr>
      <th>id_32</th>
      <td>77586.0</td>
      <td>2.650860e+01</td>
      <td>3.737502e+00</td>
      <td>0.000</td>
      <td>24.000</td>
      <td>24.000</td>
      <td>32.00</td>
      <td>3.200000e+01</td>
    </tr>
  </tbody>
</table>
<p>403 rows × 8 columns</p>
</div></div></div>
</div>
<p>Dado que por el número de columnas (403) es alto, se complica la visualización de las estadisticas de todas las columnas, por lo tanto se mostrarán por partes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mostrar las estadísticas básicas solo para las primeras 60 columnas</span>
<span class="n">display</span><span class="p">(</span><span class="n">train_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">60</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>TransactionID</th>
      <td>590540.0</td>
      <td>3.282270e+06</td>
      <td>1.704744e+05</td>
      <td>2987000.000</td>
      <td>3.134635e+06</td>
      <td>3.282270e+06</td>
      <td>3.429904e+06</td>
      <td>3.577539e+06</td>
    </tr>
    <tr>
      <th>isFraud</th>
      <td>590540.0</td>
      <td>3.499001e-02</td>
      <td>1.837546e-01</td>
      <td>0.000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>TransactionDT</th>
      <td>590540.0</td>
      <td>7.372311e+06</td>
      <td>4.617224e+06</td>
      <td>86400.000</td>
      <td>3.027058e+06</td>
      <td>7.306528e+06</td>
      <td>1.124662e+07</td>
      <td>1.581113e+07</td>
    </tr>
    <tr>
      <th>TransactionAmt</th>
      <td>590540.0</td>
      <td>1.350272e+02</td>
      <td>2.391625e+02</td>
      <td>0.251</td>
      <td>4.332100e+01</td>
      <td>6.876900e+01</td>
      <td>1.250000e+02</td>
      <td>3.193739e+04</td>
    </tr>
    <tr>
      <th>card1</th>
      <td>590540.0</td>
      <td>9.898735e+03</td>
      <td>4.901170e+03</td>
      <td>1000.000</td>
      <td>6.019000e+03</td>
      <td>9.678000e+03</td>
      <td>1.418400e+04</td>
      <td>1.839600e+04</td>
    </tr>
    <tr>
      <th>card2</th>
      <td>581607.0</td>
      <td>3.625555e+02</td>
      <td>1.577932e+02</td>
      <td>100.000</td>
      <td>2.140000e+02</td>
      <td>3.610000e+02</td>
      <td>5.120000e+02</td>
      <td>6.000000e+02</td>
    </tr>
    <tr>
      <th>card3</th>
      <td>588975.0</td>
      <td>1.531949e+02</td>
      <td>1.133644e+01</td>
      <td>100.000</td>
      <td>1.500000e+02</td>
      <td>1.500000e+02</td>
      <td>1.500000e+02</td>
      <td>2.310000e+02</td>
    </tr>
    <tr>
      <th>card5</th>
      <td>586281.0</td>
      <td>1.992789e+02</td>
      <td>4.124445e+01</td>
      <td>100.000</td>
      <td>1.660000e+02</td>
      <td>2.260000e+02</td>
      <td>2.260000e+02</td>
      <td>2.370000e+02</td>
    </tr>
    <tr>
      <th>addr1</th>
      <td>524834.0</td>
      <td>2.907338e+02</td>
      <td>1.017411e+02</td>
      <td>100.000</td>
      <td>2.040000e+02</td>
      <td>2.990000e+02</td>
      <td>3.300000e+02</td>
      <td>5.400000e+02</td>
    </tr>
    <tr>
      <th>addr2</th>
      <td>524834.0</td>
      <td>8.680063e+01</td>
      <td>2.690623e+00</td>
      <td>10.000</td>
      <td>8.700000e+01</td>
      <td>8.700000e+01</td>
      <td>8.700000e+01</td>
      <td>1.020000e+02</td>
    </tr>
    <tr>
      <th>dist1</th>
      <td>238269.0</td>
      <td>1.185022e+02</td>
      <td>3.718720e+02</td>
      <td>0.000</td>
      <td>3.000000e+00</td>
      <td>8.000000e+00</td>
      <td>2.400000e+01</td>
      <td>1.028600e+04</td>
    </tr>
    <tr>
      <th>dist2</th>
      <td>37627.0</td>
      <td>2.318554e+02</td>
      <td>5.290535e+02</td>
      <td>0.000</td>
      <td>7.000000e+00</td>
      <td>3.700000e+01</td>
      <td>2.060000e+02</td>
      <td>1.162300e+04</td>
    </tr>
    <tr>
      <th>C1</th>
      <td>590540.0</td>
      <td>1.409246e+01</td>
      <td>1.335690e+02</td>
      <td>0.000</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>3.000000e+00</td>
      <td>4.685000e+03</td>
    </tr>
    <tr>
      <th>C2</th>
      <td>590540.0</td>
      <td>1.526973e+01</td>
      <td>1.546689e+02</td>
      <td>0.000</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>3.000000e+00</td>
      <td>5.691000e+03</td>
    </tr>
    <tr>
      <th>C3</th>
      <td>590540.0</td>
      <td>5.643987e-03</td>
      <td>1.505356e-01</td>
      <td>0.000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>2.600000e+01</td>
    </tr>
    <tr>
      <th>C4</th>
      <td>590540.0</td>
      <td>4.092185e+00</td>
      <td>6.884846e+01</td>
      <td>0.000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>2.253000e+03</td>
    </tr>
    <tr>
      <th>C5</th>
      <td>590540.0</td>
      <td>5.571526e+00</td>
      <td>2.578698e+01</td>
      <td>0.000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.000000e+00</td>
      <td>3.490000e+02</td>
    </tr>
    <tr>
      <th>C6</th>
      <td>590540.0</td>
      <td>9.071082e+00</td>
      <td>7.150847e+01</td>
      <td>0.000</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>2.000000e+00</td>
      <td>2.253000e+03</td>
    </tr>
    <tr>
      <th>C7</th>
      <td>590540.0</td>
      <td>2.848478e+00</td>
      <td>6.172730e+01</td>
      <td>0.000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>2.255000e+03</td>
    </tr>
    <tr>
      <th>C8</th>
      <td>590540.0</td>
      <td>5.144574e+00</td>
      <td>9.537857e+01</td>
      <td>0.000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>3.331000e+03</td>
    </tr>
    <tr>
      <th>C9</th>
      <td>590540.0</td>
      <td>4.480240e+00</td>
      <td>1.667490e+01</td>
      <td>0.000</td>
      <td>0.000000e+00</td>
      <td>1.000000e+00</td>
      <td>2.000000e+00</td>
      <td>2.100000e+02</td>
    </tr>
    <tr>
      <th>C10</th>
      <td>590540.0</td>
      <td>5.240343e+00</td>
      <td>9.558144e+01</td>
      <td>0.000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>3.257000e+03</td>
    </tr>
    <tr>
      <th>C11</th>
      <td>590540.0</td>
      <td>1.024152e+01</td>
      <td>9.433629e+01</td>
      <td>0.000</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>2.000000e+00</td>
      <td>3.188000e+03</td>
    </tr>
    <tr>
      <th>C12</th>
      <td>590540.0</td>
      <td>4.076227e+00</td>
      <td>8.666622e+01</td>
      <td>0.000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>3.188000e+03</td>
    </tr>
    <tr>
      <th>C13</th>
      <td>590540.0</td>
      <td>3.253992e+01</td>
      <td>1.293648e+02</td>
      <td>0.000</td>
      <td>1.000000e+00</td>
      <td>3.000000e+00</td>
      <td>1.200000e+01</td>
      <td>2.918000e+03</td>
    </tr>
    <tr>
      <th>C14</th>
      <td>590540.0</td>
      <td>8.295215e+00</td>
      <td>4.954426e+01</td>
      <td>0.000</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>2.000000e+00</td>
      <td>1.429000e+03</td>
    </tr>
    <tr>
      <th>D1</th>
      <td>589271.0</td>
      <td>9.434757e+01</td>
      <td>1.576604e+02</td>
      <td>0.000</td>
      <td>0.000000e+00</td>
      <td>3.000000e+00</td>
      <td>1.220000e+02</td>
      <td>6.400000e+02</td>
    </tr>
    <tr>
      <th>D2</th>
      <td>309743.0</td>
      <td>1.695632e+02</td>
      <td>1.773159e+02</td>
      <td>0.000</td>
      <td>2.600000e+01</td>
      <td>9.700000e+01</td>
      <td>2.760000e+02</td>
      <td>6.400000e+02</td>
    </tr>
    <tr>
      <th>D3</th>
      <td>327662.0</td>
      <td>2.834335e+01</td>
      <td>6.238472e+01</td>
      <td>0.000</td>
      <td>1.000000e+00</td>
      <td>8.000000e+00</td>
      <td>2.700000e+01</td>
      <td>8.190000e+02</td>
    </tr>
    <tr>
      <th>D4</th>
      <td>421618.0</td>
      <td>1.400024e+02</td>
      <td>1.910968e+02</td>
      <td>-122.000</td>
      <td>0.000000e+00</td>
      <td>2.600000e+01</td>
      <td>2.530000e+02</td>
      <td>8.690000e+02</td>
    </tr>
    <tr>
      <th>D5</th>
      <td>280699.0</td>
      <td>4.233596e+01</td>
      <td>8.900014e+01</td>
      <td>0.000</td>
      <td>1.000000e+00</td>
      <td>1.000000e+01</td>
      <td>3.200000e+01</td>
      <td>8.190000e+02</td>
    </tr>
    <tr>
      <th>D6</th>
      <td>73187.0</td>
      <td>6.980572e+01</td>
      <td>1.436693e+02</td>
      <td>-83.000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>4.000000e+01</td>
      <td>8.730000e+02</td>
    </tr>
    <tr>
      <th>D7</th>
      <td>38917.0</td>
      <td>4.163895e+01</td>
      <td>9.974326e+01</td>
      <td>0.000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.700000e+01</td>
      <td>8.430000e+02</td>
    </tr>
    <tr>
      <th>D8</th>
      <td>74926.0</td>
      <td>1.460581e+02</td>
      <td>2.316638e+02</td>
      <td>0.000</td>
      <td>9.583330e-01</td>
      <td>3.787500e+01</td>
      <td>1.879583e+02</td>
      <td>1.707792e+03</td>
    </tr>
    <tr>
      <th>D9</th>
      <td>74926.0</td>
      <td>5.610571e-01</td>
      <td>3.168796e-01</td>
      <td>0.000</td>
      <td>2.083330e-01</td>
      <td>6.666660e-01</td>
      <td>8.333330e-01</td>
      <td>9.583330e-01</td>
    </tr>
    <tr>
      <th>D10</th>
      <td>514518.0</td>
      <td>1.239821e+02</td>
      <td>1.826152e+02</td>
      <td>0.000</td>
      <td>0.000000e+00</td>
      <td>1.500000e+01</td>
      <td>1.970000e+02</td>
      <td>8.760000e+02</td>
    </tr>
    <tr>
      <th>D11</th>
      <td>311253.0</td>
      <td>1.466215e+02</td>
      <td>1.860426e+02</td>
      <td>-53.000</td>
      <td>0.000000e+00</td>
      <td>4.300000e+01</td>
      <td>2.740000e+02</td>
      <td>6.700000e+02</td>
    </tr>
    <tr>
      <th>D12</th>
      <td>64717.0</td>
      <td>5.403753e+01</td>
      <td>1.242746e+02</td>
      <td>-83.000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.300000e+01</td>
      <td>6.480000e+02</td>
    </tr>
    <tr>
      <th>D13</th>
      <td>61952.0</td>
      <td>1.790129e+01</td>
      <td>6.761443e+01</td>
      <td>0.000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>8.470000e+02</td>
    </tr>
    <tr>
      <th>D14</th>
      <td>62187.0</td>
      <td>5.772444e+01</td>
      <td>1.363125e+02</td>
      <td>-193.000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>2.000000e+00</td>
      <td>8.780000e+02</td>
    </tr>
    <tr>
      <th>D15</th>
      <td>501427.0</td>
      <td>1.637446e+02</td>
      <td>2.027267e+02</td>
      <td>-83.000</td>
      <td>0.000000e+00</td>
      <td>5.200000e+01</td>
      <td>3.140000e+02</td>
      <td>8.790000e+02</td>
    </tr>
    <tr>
      <th>V1</th>
      <td>311253.0</td>
      <td>9.999454e-01</td>
      <td>7.390206e-03</td>
      <td>0.000</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>V2</th>
      <td>311253.0</td>
      <td>1.045204e+00</td>
      <td>2.401329e-01</td>
      <td>0.000</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>8.000000e+00</td>
    </tr>
    <tr>
      <th>V3</th>
      <td>311253.0</td>
      <td>1.078075e+00</td>
      <td>3.208898e-01</td>
      <td>0.000</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>9.000000e+00</td>
    </tr>
    <tr>
      <th>V4</th>
      <td>311253.0</td>
      <td>8.464561e-01</td>
      <td>4.400533e-01</td>
      <td>0.000</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>6.000000e+00</td>
    </tr>
    <tr>
      <th>V5</th>
      <td>311253.0</td>
      <td>8.769907e-01</td>
      <td>4.759025e-01</td>
      <td>0.000</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>6.000000e+00</td>
    </tr>
    <tr>
      <th>V6</th>
      <td>311253.0</td>
      <td>1.045686e+00</td>
      <td>2.393849e-01</td>
      <td>0.000</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>9.000000e+00</td>
    </tr>
    <tr>
      <th>V7</th>
      <td>311253.0</td>
      <td>1.072870e+00</td>
      <td>3.047788e-01</td>
      <td>0.000</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>9.000000e+00</td>
    </tr>
    <tr>
      <th>V8</th>
      <td>311253.0</td>
      <td>1.027704e+00</td>
      <td>1.860694e-01</td>
      <td>0.000</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>8.000000e+00</td>
    </tr>
    <tr>
      <th>V9</th>
      <td>311253.0</td>
      <td>1.041529e+00</td>
      <td>2.263387e-01</td>
      <td>0.000</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>8.000000e+00</td>
    </tr>
    <tr>
      <th>V10</th>
      <td>311253.0</td>
      <td>4.639152e-01</td>
      <td>5.215221e-01</td>
      <td>0.000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.000000e+00</td>
      <td>4.000000e+00</td>
    </tr>
    <tr>
      <th>V11</th>
      <td>311253.0</td>
      <td>4.789865e-01</td>
      <td>5.524308e-01</td>
      <td>0.000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.000000e+00</td>
      <td>5.000000e+00</td>
    </tr>
    <tr>
      <th>V12</th>
      <td>514467.0</td>
      <td>5.597113e-01</td>
      <td>5.105330e-01</td>
      <td>0.000</td>
      <td>0.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>3.000000e+00</td>
    </tr>
    <tr>
      <th>V13</th>
      <td>514467.0</td>
      <td>5.991657e-01</td>
      <td>5.321851e-01</td>
      <td>0.000</td>
      <td>0.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>6.000000e+00</td>
    </tr>
    <tr>
      <th>V14</th>
      <td>514467.0</td>
      <td>9.995005e-01</td>
      <td>2.234497e-02</td>
      <td>0.000</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>V15</th>
      <td>514467.0</td>
      <td>1.223422e-01</td>
      <td>3.324217e-01</td>
      <td>0.000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>7.000000e+00</td>
    </tr>
    <tr>
      <th>V16</th>
      <td>514467.0</td>
      <td>1.234598e-01</td>
      <td>3.428411e-01</td>
      <td>0.000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.500000e+01</td>
    </tr>
    <tr>
      <th>V17</th>
      <td>514467.0</td>
      <td>1.340397e-01</td>
      <td>3.644565e-01</td>
      <td>0.000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.500000e+01</td>
    </tr>
    <tr>
      <th>V18</th>
      <td>514467.0</td>
      <td>1.353634e-01</td>
      <td>3.717633e-01</td>
      <td>0.000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.500000e+01</td>
    </tr>
    <tr>
      <th>V19</th>
      <td>514467.0</td>
      <td>8.163711e-01</td>
      <td>4.255119e-01</td>
      <td>0.000</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>7.000000e+00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>TransactionID: Identificador único, no es informativo para el modelo pero útil para trazabilidad.</p></li>
<li><p>isFraud: Promedio de 0.0349 (3.5%) indica fuerte desbalance de clases (fraudes son minoría).</p></li>
<li><p>TransactionDT: Marca de tiempo relativa. Puede transformarse en variables como día, hora o semana.</p></li>
<li><p>TransactionAmt: Rango desde <span class="math notranslate nohighlight">\(0.25 hasta \)</span>31,937.39, con media de <span class="math notranslate nohighlight">\(135 y mediana de \)</span>68.76. Tiene alta dispersión, lo cual indica que podría haber outliers. Además, hay fraudes que suelen estar en montos más pequeños o inusualmente grandes.</p></li>
<li><p>card1, card2, card3, card5: Todas con valores enteros. Pueden representar identificadores codificados del emisor o tipo de tarjeta. Aunque no son numéricas en sentido estricto, podrían actuar como variables categóricas de alta cardinalidad. Se debe considerar codificarlas con técnicas como frequency encoding o reducir su cardinalidad.</p></li>
<li><p>addr1, addr2: Direcciones codificadas, valores bastante concentrados.</p></li>
<li><p>dist1, dist2: Altamente dispersas. dist1 llega a 10,286 y dist2 hasta 11,623, lo cual sugiere valores extremos. Estas variables podrían contener ruido, pero también patrones importantes para identificar ubicaciones frecuentes. Se debe verificar correlación con isFraud.</p></li>
<li><p>C1–C14: Estas variables codifican recuentos de entidades asociadas (por ejemplo, número de emails, tarjetas, etc.): Muchas tienen valores mínimos en 0 y cuartiles muy bajos (ej: Q1 = Q2 = Q3 = 0 o 1). Algunas como C13 llegan hasta valores de 2,918. Aunque no conocemos su significado exacto, su comportamiento disperso sugiere que algunas podrían contener outliers. A pesar de ser codificadas, pueden usarse como variables numéricas directamente.</p></li>
<li><p>D1–D15 (intervalos de tiempo): Medidas de tiempo entre eventos (días, semanas, etc.). Algunos valores negativos en D4, D6, D11, D12, D14, etc., lo que puede representar errores o cálculos relativos. Gran cantidad de valores nulos (como en D6 o D13). Las variables D son muy útiles para medir la frecuencia y tiempo entre transacciones. Se pueden imputar los valores nulos.</p></li>
<li><p>Variables V1–V19 (codificadas por Vesta): Valores cercanos a 1 con desviación estándar baja en muchas (ej: V1, V14). Varios con moda = 1 y mediana = 1 → alta concentración en un solo valor. Algunas (V10, V11, V15–V18) tienen muchos ceros, lo que sugiere comportamiento binario o indicativo. Muchas de estas variables parecen ser flags o scores normalizados. Son candidatas fuertes para clasificación y no requieren transformación adicional, salvo normalización si el modelo lo necesita.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mostrar columnas 60 a 120</span>
<span class="n">display</span><span class="p">(</span><span class="n">train_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">60</span><span class="p">:</span><span class="mi">120</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>V20</th>
      <td>514467.0</td>
      <td>0.847843</td>
      <td>0.459451</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>V21</th>
      <td>514467.0</td>
      <td>0.129684</td>
      <td>0.339060</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>V22</th>
      <td>514467.0</td>
      <td>0.132292</td>
      <td>0.359415</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>V23</th>
      <td>514467.0</td>
      <td>1.034791</td>
      <td>0.247681</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>V24</th>
      <td>514467.0</td>
      <td>1.058097</td>
      <td>0.305485</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>V25</th>
      <td>514467.0</td>
      <td>0.977660</td>
      <td>0.185245</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>V26</th>
      <td>514467.0</td>
      <td>0.988040</td>
      <td>0.209302</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>V27</th>
      <td>514467.0</td>
      <td>0.000776</td>
      <td>0.028596</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>V28</th>
      <td>514467.0</td>
      <td>0.000830</td>
      <td>0.031133</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>V29</th>
      <td>514467.0</td>
      <td>0.387840</td>
      <td>0.510652</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>V30</th>
      <td>514467.0</td>
      <td>0.406436</td>
      <td>0.554311</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>V31</th>
      <td>514467.0</td>
      <td>0.140761</td>
      <td>0.355793</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>V32</th>
      <td>514467.0</td>
      <td>0.142417</td>
      <td>0.368278</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>V33</th>
      <td>514467.0</td>
      <td>0.130693</td>
      <td>0.340900</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>V34</th>
      <td>514467.0</td>
      <td>0.139154</td>
      <td>0.357549</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>V35</th>
      <td>421571.0</td>
      <td>0.542594</td>
      <td>0.516010</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>V36</th>
      <td>421571.0</td>
      <td>0.579198</td>
      <td>0.539039</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>V37</th>
      <td>421571.0</td>
      <td>1.108065</td>
      <td>0.690571</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>54.0</td>
    </tr>
    <tr>
      <th>V38</th>
      <td>421571.0</td>
      <td>1.162400</td>
      <td>0.858920</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>54.0</td>
    </tr>
    <tr>
      <th>V39</th>
      <td>421571.0</td>
      <td>0.166076</td>
      <td>0.451956</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>V40</th>
      <td>421571.0</td>
      <td>0.177145</td>
      <td>0.505786</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>V41</th>
      <td>421571.0</td>
      <td>0.999269</td>
      <td>0.027020</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>V42</th>
      <td>421571.0</td>
      <td>0.156118</td>
      <td>0.382896</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>V43</th>
      <td>421571.0</td>
      <td>0.168942</td>
      <td>0.433359</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>V44</th>
      <td>421571.0</td>
      <td>1.083891</td>
      <td>0.639143</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>48.0</td>
    </tr>
    <tr>
      <th>V45</th>
      <td>421571.0</td>
      <td>1.120779</td>
      <td>0.729774</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>48.0</td>
    </tr>
    <tr>
      <th>V46</th>
      <td>421571.0</td>
      <td>1.022286</td>
      <td>0.166719</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>V47</th>
      <td>421571.0</td>
      <td>1.038515</td>
      <td>0.231862</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>V48</th>
      <td>421571.0</td>
      <td>0.383174</td>
      <td>0.508189</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>V49</th>
      <td>421571.0</td>
      <td>0.397724</td>
      <td>0.542654</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>V50</th>
      <td>421571.0</td>
      <td>0.164746</td>
      <td>0.373995</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>V51</th>
      <td>421571.0</td>
      <td>0.170579</td>
      <td>0.403899</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>V52</th>
      <td>421571.0</td>
      <td>0.182695</td>
      <td>0.439002</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>V53</th>
      <td>513444.0</td>
      <td>0.577586</td>
      <td>0.511571</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>V54</th>
      <td>513444.0</td>
      <td>0.619982</td>
      <td>0.534635</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>V55</th>
      <td>513444.0</td>
      <td>1.067670</td>
      <td>0.391364</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>V56</th>
      <td>513444.0</td>
      <td>1.120979</td>
      <td>0.661129</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>51.0</td>
    </tr>
    <tr>
      <th>V57</th>
      <td>513444.0</td>
      <td>0.128312</td>
      <td>0.349094</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>V58</th>
      <td>513444.0</td>
      <td>0.132453</td>
      <td>0.372907</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>V59</th>
      <td>513444.0</td>
      <td>0.134433</td>
      <td>0.379291</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>V60</th>
      <td>513444.0</td>
      <td>0.142537</td>
      <td>0.418230</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>V61</th>
      <td>513444.0</td>
      <td>0.829785</td>
      <td>0.436617</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>V62</th>
      <td>513444.0</td>
      <td>0.867563</td>
      <td>0.483803</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>V63</th>
      <td>513444.0</td>
      <td>0.130743</td>
      <td>0.355262</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>V64</th>
      <td>513444.0</td>
      <td>0.141825</td>
      <td>0.406157</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>V65</th>
      <td>513444.0</td>
      <td>0.999663</td>
      <td>0.018353</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>V66</th>
      <td>513444.0</td>
      <td>0.981038</td>
      <td>0.216235</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>V67</th>
      <td>513444.0</td>
      <td>0.998121</td>
      <td>0.245912</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>V68</th>
      <td>513444.0</td>
      <td>0.000534</td>
      <td>0.023760</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>V69</th>
      <td>513444.0</td>
      <td>0.390200</td>
      <td>0.513696</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>V70</th>
      <td>513444.0</td>
      <td>0.407924</td>
      <td>0.554499</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>V71</th>
      <td>513444.0</td>
      <td>0.140639</td>
      <td>0.364303</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>V72</th>
      <td>513444.0</td>
      <td>0.145124</td>
      <td>0.389212</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>V73</th>
      <td>513444.0</td>
      <td>0.139982</td>
      <td>0.367098</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>V74</th>
      <td>513444.0</td>
      <td>0.152147</td>
      <td>0.393274</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>V75</th>
      <td>501376.0</td>
      <td>0.544278</td>
      <td>0.514318</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>V76</th>
      <td>501376.0</td>
      <td>0.587557</td>
      <td>0.538230</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>V77</th>
      <td>501376.0</td>
      <td>1.086893</td>
      <td>0.532958</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>30.0</td>
    </tr>
    <tr>
      <th>V78</th>
      <td>501376.0</td>
      <td>1.144462</td>
      <td>0.781474</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>31.0</td>
    </tr>
    <tr>
      <th>V79</th>
      <td>501376.0</td>
      <td>0.136867</td>
      <td>0.379904</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>7.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Variables V20 a V79:</p>
<ul class="simple">
<li><p>Altamente concentradas en 1 o 0: Muchas variables como V20, V23–V26, V41, V46–V47, V61–V67, V65 tienen: Mediana = 1, Mínimo = 0 y Máximo &gt; 1. Probablemente son variables binarias codificadas como scores o flags. Su alta concentración en 1 indica que en la mayoría de los casos se cumple cierta condición predefinida por el sistema de fraude de Vesta. Podrían ser muy relevantes para detectar fraudes.</p></li>
<li><p>Variables con moda en 0, con pocos valores altos: Ej: V21–V22, V27–V34, V50–V52, V57–V60, V63–V74. Estas tienen muchos ceros, pero algunas muestran valores hasta 15 o más (V32, V38, V45, V60). Estas variables probablemente capturan eventos poco frecuentes o desviaciones puntuales. Si bien tienen muchos ceros (como no coincidencias, ausencia de eventos, etc.), los valores más altos podrían ser indicadores fuertes de fraude.</p></li>
<li><p>Variables con valores más altos y varianza mayor: V37–V38, V44–V45, V55–V56, V77–V78. Máximos de hasta 50+ indican presencia de outliers o recuentos altos, lo cual puede ser útil para detección de anomalías. Posiblemente codifican frecuencias, cantidades de intentos, o repeticiones por usuario/tarjeta, y valores atípicos aquí podrían indicar riesgo elevado de fraude.</p></li>
<li><p>Variables con muy baja media y desviación pequeña: V27, V28, V68: media cercana a cero, desviación &lt; 0.03. Estas variables tienen comportamiento casi constante y podrían no aportar mucha información.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mostrar columnas 121 a 180</span>
<span class="n">display</span><span class="p">(</span><span class="n">train_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">121</span><span class="p">:</span><span class="mi">180</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>V81</th>
      <td>501376.0</td>
      <td>0.152696</td>
      <td>0.452298</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>V82</th>
      <td>501376.0</td>
      <td>0.844610</td>
      <td>0.422529</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>V83</th>
      <td>501376.0</td>
      <td>0.881965</td>
      <td>0.470757</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>V84</th>
      <td>501376.0</td>
      <td>0.137145</td>
      <td>0.361875</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>V85</th>
      <td>501376.0</td>
      <td>0.149788</td>
      <td>0.419445</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>V86</th>
      <td>501376.0</td>
      <td>1.064885</td>
      <td>0.419807</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>30.0</td>
    </tr>
    <tr>
      <th>V87</th>
      <td>501376.0</td>
      <td>1.099456</td>
      <td>0.511281</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>30.0</td>
    </tr>
    <tr>
      <th>V88</th>
      <td>501376.0</td>
      <td>0.999246</td>
      <td>0.027447</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>V89</th>
      <td>501376.0</td>
      <td>0.000902</td>
      <td>0.031943</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>V90</th>
      <td>501376.0</td>
      <td>0.401862</td>
      <td>0.516153</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>V91</th>
      <td>501376.0</td>
      <td>0.420461</td>
      <td>0.561865</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>V92</th>
      <td>501376.0</td>
      <td>0.150322</td>
      <td>0.375682</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>V93</th>
      <td>501376.0</td>
      <td>0.154812</td>
      <td>0.402314</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>V94</th>
      <td>501376.0</td>
      <td>0.137007</td>
      <td>0.343878</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>V95</th>
      <td>590226.0</td>
      <td>1.038019</td>
      <td>21.034304</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>880.0</td>
    </tr>
    <tr>
      <th>V96</th>
      <td>590226.0</td>
      <td>3.005190</td>
      <td>40.239490</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>1410.0</td>
    </tr>
    <tr>
      <th>V97</th>
      <td>590226.0</td>
      <td>1.718933</td>
      <td>27.700449</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>976.0</td>
    </tr>
    <tr>
      <th>V98</th>
      <td>590226.0</td>
      <td>0.061985</td>
      <td>0.284995</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>V99</th>
      <td>590226.0</td>
      <td>0.894986</td>
      <td>2.722552</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>88.0</td>
    </tr>
    <tr>
      <th>V100</th>
      <td>590226.0</td>
      <td>0.273504</td>
      <td>0.947176</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>28.0</td>
    </tr>
    <tr>
      <th>V101</th>
      <td>590226.0</td>
      <td>0.889249</td>
      <td>20.582571</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>869.0</td>
    </tr>
    <tr>
      <th>V102</th>
      <td>590226.0</td>
      <td>1.827229</td>
      <td>35.928456</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1285.0</td>
    </tr>
    <tr>
      <th>V103</th>
      <td>590226.0</td>
      <td>1.279288</td>
      <td>25.685642</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>928.0</td>
    </tr>
    <tr>
      <th>V104</th>
      <td>590226.0</td>
      <td>0.085433</td>
      <td>0.648718</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>V105</th>
      <td>590226.0</td>
      <td>0.281145</td>
      <td>3.373948</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>99.0</td>
    </tr>
    <tr>
      <th>V106</th>
      <td>590226.0</td>
      <td>0.164584</td>
      <td>1.825665</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>55.0</td>
    </tr>
    <tr>
      <th>V107</th>
      <td>590226.0</td>
      <td>0.999580</td>
      <td>0.020494</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>V108</th>
      <td>590226.0</td>
      <td>1.004613</td>
      <td>0.081146</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>V109</th>
      <td>590226.0</td>
      <td>1.014816</td>
      <td>0.127769</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>V110</th>
      <td>590226.0</td>
      <td>1.007739</td>
      <td>0.097290</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>V111</th>
      <td>590226.0</td>
      <td>1.002563</td>
      <td>0.070830</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>V112</th>
      <td>590226.0</td>
      <td>1.005356</td>
      <td>0.084617</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>V113</th>
      <td>590226.0</td>
      <td>1.003383</td>
      <td>0.074754</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>V114</th>
      <td>590226.0</td>
      <td>1.009298</td>
      <td>0.110179</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>V115</th>
      <td>590226.0</td>
      <td>1.032450</td>
      <td>0.190385</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>V116</th>
      <td>590226.0</td>
      <td>1.015738</td>
      <td>0.136770</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>V117</th>
      <td>590226.0</td>
      <td>1.000391</td>
      <td>0.035238</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>V118</th>
      <td>590226.0</td>
      <td>1.001474</td>
      <td>0.041011</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>V119</th>
      <td>590226.0</td>
      <td>1.000729</td>
      <td>0.036392</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>V120</th>
      <td>590226.0</td>
      <td>1.000874</td>
      <td>0.041684</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>V121</th>
      <td>590226.0</td>
      <td>1.004276</td>
      <td>0.067097</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>V122</th>
      <td>590226.0</td>
      <td>1.001759</td>
      <td>0.048636</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>V123</th>
      <td>590226.0</td>
      <td>1.031120</td>
      <td>0.228134</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>V124</th>
      <td>590226.0</td>
      <td>1.092975</td>
      <td>0.374103</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>V125</th>
      <td>590226.0</td>
      <td>1.050415</td>
      <td>0.280037</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>V126</th>
      <td>590226.0</td>
      <td>129.979417</td>
      <td>2346.951681</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>160000.0</td>
    </tr>
    <tr>
      <th>V127</th>
      <td>590226.0</td>
      <td>336.611559</td>
      <td>4238.666949</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>107.949997</td>
      <td>160000.0</td>
    </tr>
    <tr>
      <th>V128</th>
      <td>590226.0</td>
      <td>204.094038</td>
      <td>3010.258774</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>160000.0</td>
    </tr>
    <tr>
      <th>V129</th>
      <td>590226.0</td>
      <td>8.768944</td>
      <td>113.832828</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>55125.0</td>
    </tr>
    <tr>
      <th>V130</th>
      <td>590226.0</td>
      <td>92.165849</td>
      <td>315.960485</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>59.000000</td>
      <td>55125.0</td>
    </tr>
    <tr>
      <th>V131</th>
      <td>590226.0</td>
      <td>31.133302</td>
      <td>161.161258</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>55125.0</td>
    </tr>
    <tr>
      <th>V132</th>
      <td>590226.0</td>
      <td>103.513188</td>
      <td>2266.106140</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>93736.0</td>
    </tr>
    <tr>
      <th>V133</th>
      <td>590226.0</td>
      <td>204.889160</td>
      <td>3796.316755</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>133915.0</td>
    </tr>
    <tr>
      <th>V134</th>
      <td>590226.0</td>
      <td>145.972328</td>
      <td>2772.986817</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>98476.0</td>
    </tr>
    <tr>
      <th>V135</th>
      <td>590226.0</td>
      <td>17.250132</td>
      <td>293.847563</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>90750.0</td>
    </tr>
    <tr>
      <th>V136</th>
      <td>590226.0</td>
      <td>38.821196</td>
      <td>451.808411</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>90750.0</td>
    </tr>
    <tr>
      <th>V137</th>
      <td>590226.0</td>
      <td>26.365090</td>
      <td>348.332714</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>90750.0</td>
    </tr>
    <tr>
      <th>V138</th>
      <td>81945.0</td>
      <td>0.036439</td>
      <td>0.428490</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>22.0</td>
    </tr>
    <tr>
      <th>V139</th>
      <td>81945.0</td>
      <td>1.073915</td>
      <td>1.333924</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>33.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Variables V81–V94:</p></li>
</ul>
<p>Variables como V81, V84–V85, V92–V94: muchas con media baja, desviación baja, mediana y cuartiles en 0, pero con máximos hasta 7 o 19.
Variables como V82–V83, V86–V87: altas concentraciones en 1 con desviación algo mayor.</p>
<p>Algunas parecen flags o indicadores de actividad poco frecuente. Las variables con valores más altos (como V81 y V87) podrían representar repeticiones o intensidades inusuales. Como hay muchas concentradas en 0 pero con algunos valores altos, podrían ser útiles para detectar anomalías o comportamientos atípicos.</p>
<ul class="simple">
<li><p>Variables V95–V106:</p></li>
</ul>
<p>V95: media 1.03, std = 21.03, máximo = 880
V96: std = 40.24, máximo = 1410
V101–V103: similares, con valores máximos &gt;800
V126–V137: ¡valores extremos! Hasta 160,000 o 90,000</p>
<p>Estas variables tienen una dispersión enorme. Aunque la mayoría de los valores son cero, unos pocos alcanzan valores altísimos. Posiblemente representan conteos o acumulaciones.</p>
<ul class="simple">
<li><p>Variables V107–V125:</p></li>
</ul>
<p>Muchas están alrededor de 1.0, con desviaciones &lt; 0.1.
Ejemplo: V107–V122 → todos tienen valores mínimos en 0, máximos en 3–9, pero moda y mediana en 1.</p>
<p>Son muy constantes, casi flags, pero no completamente binarios. Relevantes en modelos de árboles (que separan bien valores aunque sean pocos distintos).</p>
<ul class="simple">
<li><p>Variables V126–V137</p></li>
</ul>
<p>V126: media = 130, std = 2346, máximo = 160,000
V127–V136: comportamiento similar</p>
<p>Claros outliers, posiblemente acumulaciones o identificadores codificados mal escalados. Aunque podrían contener información útil, deben tratarse antes del modelado.</p>
<ul class="simple">
<li><p>Variables V138–V139: muy pocos datos</p></li>
</ul>
<p>V138 y V139 tienen solo 81,945 observaciones (vs. &gt;500,000 en las demás)
Podrían tener muchos nulos o estar presentes solo en un subconjunto <a class="reference external" href="http://xn--especfico-k5a.Si">específico.Si</a> su aporte es alto, se puede imputar o usarlas selectivamente. Si no aportan nada, se pueden eliminar por escasa cobertura.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mostrar columnas 181 a 240</span>
<span class="n">display</span><span class="p">(</span><span class="n">train_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">181</span><span class="p">:</span><span class="mi">240</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>V141</th>
      <td>81945.0</td>
      <td>0.037696</td>
      <td>0.215133</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0000</td>
    </tr>
    <tr>
      <th>V142</th>
      <td>81945.0</td>
      <td>0.048581</td>
      <td>0.313888</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>9.0000</td>
    </tr>
    <tr>
      <th>V143</th>
      <td>81951.0</td>
      <td>8.397006</td>
      <td>55.267545</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>869.0000</td>
    </tr>
    <tr>
      <th>V144</th>
      <td>81951.0</td>
      <td>3.708484</td>
      <td>10.485633</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>62.0000</td>
    </tr>
    <tr>
      <th>V145</th>
      <td>81951.0</td>
      <td>22.112946</td>
      <td>64.371860</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>297.0000</td>
    </tr>
    <tr>
      <th>V146</th>
      <td>81945.0</td>
      <td>0.156276</td>
      <td>0.682328</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>24.0000</td>
    </tr>
    <tr>
      <th>V147</th>
      <td>81945.0</td>
      <td>0.168601</td>
      <td>0.750497</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>26.0000</td>
    </tr>
    <tr>
      <th>V148</th>
      <td>81945.0</td>
      <td>0.765001</td>
      <td>0.581425</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>20.0000</td>
    </tr>
    <tr>
      <th>V149</th>
      <td>81945.0</td>
      <td>0.775313</td>
      <td>0.628191</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>20.0000</td>
    </tr>
    <tr>
      <th>V150</th>
      <td>81951.0</td>
      <td>277.598028</td>
      <td>829.576922</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>3389.0000</td>
    </tr>
    <tr>
      <th>V151</th>
      <td>81951.0</td>
      <td>6.460190</td>
      <td>15.232324</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>57.0000</td>
    </tr>
    <tr>
      <th>V152</th>
      <td>81951.0</td>
      <td>9.432710</td>
      <td>21.554486</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>69.0000</td>
    </tr>
    <tr>
      <th>V153</th>
      <td>81945.0</td>
      <td>0.753200</td>
      <td>0.532649</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>18.0000</td>
    </tr>
    <tr>
      <th>V154</th>
      <td>81945.0</td>
      <td>0.757423</td>
      <td>0.546907</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>18.0000</td>
    </tr>
    <tr>
      <th>V155</th>
      <td>81945.0</td>
      <td>0.767381</td>
      <td>0.602678</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>24.0000</td>
    </tr>
    <tr>
      <th>V156</th>
      <td>81945.0</td>
      <td>0.777485</td>
      <td>0.647209</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>24.0000</td>
    </tr>
    <tr>
      <th>V157</th>
      <td>81945.0</td>
      <td>0.817573</td>
      <td>0.682016</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>24.0000</td>
    </tr>
    <tr>
      <th>V158</th>
      <td>81945.0</td>
      <td>0.833461</td>
      <td>0.734336</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>24.0000</td>
    </tr>
    <tr>
      <th>V159</th>
      <td>81951.0</td>
      <td>2719.299775</td>
      <td>8355.445049</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>55125.0000</td>
    </tr>
    <tr>
      <th>V160</th>
      <td>81951.0</td>
      <td>47453.181173</td>
      <td>142076.069162</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>641511.4375</td>
    </tr>
    <tr>
      <th>V161</th>
      <td>81945.0</td>
      <td>4.843938</td>
      <td>58.929757</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3300.0000</td>
    </tr>
    <tr>
      <th>V162</th>
      <td>81945.0</td>
      <td>6.594661</td>
      <td>69.195180</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3300.0000</td>
    </tr>
    <tr>
      <th>V163</th>
      <td>81945.0</td>
      <td>5.505955</td>
      <td>63.077887</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3300.0000</td>
    </tr>
    <tr>
      <th>V164</th>
      <td>81951.0</td>
      <td>877.888928</td>
      <td>6049.166505</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>93736.0000</td>
    </tr>
    <tr>
      <th>V165</th>
      <td>81951.0</td>
      <td>2239.912219</td>
      <td>8223.258928</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>98476.0000</td>
    </tr>
    <tr>
      <th>V166</th>
      <td>81951.0</td>
      <td>359.469437</td>
      <td>1244.463270</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>104060.0000</td>
    </tr>
    <tr>
      <th>V167</th>
      <td>139631.0</td>
      <td>3.929514</td>
      <td>42.200980</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>872.0000</td>
    </tr>
    <tr>
      <th>V168</th>
      <td>139631.0</td>
      <td>5.859501</td>
      <td>54.032468</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>964.0000</td>
    </tr>
    <tr>
      <th>V169</th>
      <td>139819.0</td>
      <td>0.168053</td>
      <td>0.904944</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>19.0000</td>
    </tr>
    <tr>
      <th>V170</th>
      <td>139819.0</td>
      <td>1.436779</td>
      <td>1.751143</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>48.0000</td>
    </tr>
    <tr>
      <th>V171</th>
      <td>139819.0</td>
      <td>1.690908</td>
      <td>2.444748</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>61.0000</td>
    </tr>
    <tr>
      <th>V172</th>
      <td>139631.0</td>
      <td>0.132012</td>
      <td>0.924894</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>31.0000</td>
    </tr>
    <tr>
      <th>V173</th>
      <td>139631.0</td>
      <td>0.055231</td>
      <td>0.264439</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>7.0000</td>
    </tr>
    <tr>
      <th>V174</th>
      <td>139819.0</td>
      <td>0.127794</td>
      <td>0.379763</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>8.0000</td>
    </tr>
    <tr>
      <th>V175</th>
      <td>139819.0</td>
      <td>0.212639</td>
      <td>0.857133</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>14.0000</td>
    </tr>
    <tr>
      <th>V176</th>
      <td>139631.0</td>
      <td>1.376979</td>
      <td>1.829420</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>48.0000</td>
    </tr>
    <tr>
      <th>V177</th>
      <td>139631.0</td>
      <td>3.529245</td>
      <td>41.310622</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>861.0000</td>
    </tr>
    <tr>
      <th>V178</th>
      <td>139631.0</td>
      <td>6.649283</td>
      <td>69.447364</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1235.0000</td>
    </tr>
    <tr>
      <th>V179</th>
      <td>139631.0</td>
      <td>4.869012</td>
      <td>50.489426</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>920.0000</td>
    </tr>
    <tr>
      <th>V180</th>
      <td>139819.0</td>
      <td>0.924123</td>
      <td>6.112630</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>83.0000</td>
    </tr>
    <tr>
      <th>V181</th>
      <td>139631.0</td>
      <td>0.253332</td>
      <td>1.248974</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>24.0000</td>
    </tr>
    <tr>
      <th>V182</th>
      <td>139631.0</td>
      <td>0.856243</td>
      <td>5.792934</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>83.0000</td>
    </tr>
    <tr>
      <th>V183</th>
      <td>139631.0</td>
      <td>0.484692</td>
      <td>2.946982</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>41.0000</td>
    </tr>
    <tr>
      <th>V184</th>
      <td>139819.0</td>
      <td>0.132364</td>
      <td>0.543699</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>16.0000</td>
    </tr>
    <tr>
      <th>V185</th>
      <td>139819.0</td>
      <td>0.173903</td>
      <td>0.699733</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>31.0000</td>
    </tr>
    <tr>
      <th>V186</th>
      <td>139631.0</td>
      <td>1.148799</td>
      <td>1.223529</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>38.0000</td>
    </tr>
    <tr>
      <th>V187</th>
      <td>139631.0</td>
      <td>1.843752</td>
      <td>9.884390</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>218.0000</td>
    </tr>
    <tr>
      <th>V188</th>
      <td>139819.0</td>
      <td>1.014755</td>
      <td>0.671207</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>30.0000</td>
    </tr>
    <tr>
      <th>V189</th>
      <td>139819.0</td>
      <td>1.038314</td>
      <td>0.792528</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>30.0000</td>
    </tr>
    <tr>
      <th>V190</th>
      <td>139631.0</td>
      <td>1.213083</td>
      <td>1.480318</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>42.0000</td>
    </tr>
    <tr>
      <th>V191</th>
      <td>139631.0</td>
      <td>1.058984</td>
      <td>0.677527</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>21.0000</td>
    </tr>
    <tr>
      <th>V192</th>
      <td>139631.0</td>
      <td>1.237361</td>
      <td>2.635961</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>44.0000</td>
    </tr>
    <tr>
      <th>V193</th>
      <td>139631.0</td>
      <td>1.149845</td>
      <td>1.714792</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>37.0000</td>
    </tr>
    <tr>
      <th>V194</th>
      <td>139819.0</td>
      <td>0.945773</td>
      <td>0.304158</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>7.0000</td>
    </tr>
    <tr>
      <th>V195</th>
      <td>139819.0</td>
      <td>0.954227</td>
      <td>0.376420</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>16.0000</td>
    </tr>
    <tr>
      <th>V196</th>
      <td>139631.0</td>
      <td>1.084580</td>
      <td>1.105834</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>38.0000</td>
    </tr>
    <tr>
      <th>V197</th>
      <td>139819.0</td>
      <td>0.949385</td>
      <td>0.336871</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>14.0000</td>
    </tr>
    <tr>
      <th>V198</th>
      <td>139819.0</td>
      <td>0.961951</td>
      <td>0.493065</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>21.0000</td>
    </tr>
    <tr>
      <th>V199</th>
      <td>139631.0</td>
      <td>1.270749</td>
      <td>1.671863</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>45.0000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>V141–V158:</p></li>
</ul>
<p>Variables como V141, V142, V146–V147 tienen medias bajas (∼0.04 a 0.17), desviaciones pequeñas, mediana 0, y valores máximos puntuales hasta 26.
V148–V158 muestran más valores con mediana = 1, aunque también tienen valores máximos de hasta 24.</p>
<p>Las primeras parecen flags esporádicos o condiciones que solo se activan en casos raros. Las de mediana 1 probablemente indican presencia habitual de una característica en transacciones regulares o fraudulentas. Aunque no presentan gran variabilidad, los valores máximos elevados podrían reflejar comportamientos anómalos.</p>
<ul class="simple">
<li><p>V159–V166:</p></li>
</ul>
<p>V159: media 2719, máx. 55,125
V160: media 47,453, máx. 641,511
V164–V166: máximos de hasta 104,060</p>
<p>Estas variables son las más extremas y dispersas de la serie V. Posiblemente representan acumulaciones, contadores históricos, o puntajes normalizados mal escalados.</p>
<ul class="simple">
<li><p>V167–V193:</p></li>
</ul>
<p>V167–V179: media baja pero grandes desviaciones → muchos ceros con algunos valores atípicos.
V180–V193: en su mayoría tienen mediana = 1, mínimo = 0, y valores máximos entre 16 y 218.</p>
<p>Se comportan como indicadores de comportamiento repetitivo o intensidad. Si bien la mayoría de los usuarios tiene valores bajos, algunos tienen recuentos altos → probablemente correlacionan con fraude. Estas variables podrían ser muy útiles en modelos no lineales como Random Forest, XGBoost, etc.</p>
<ul class="simple">
<li><p>V194–V199:</p></li>
</ul>
<p>Medias cercanas a 1 (0.94–1.27), desviación muy baja, mediana = 1.
Muy probablemente se usan como banderas binarias o puntajes de similitud, altamente concentradas. Si bien no aportan variabilidad, en combinación con otras variables pueden mejorar la capacidad predictiva del modelo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mostrar columnas 241 a 300</span>
<span class="n">display</span><span class="p">(</span><span class="n">train_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">241</span><span class="p">:</span><span class="mi">300</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>V201</th>
      <td>139819.0</td>
      <td>1.159106</td>
      <td>1.418618</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0000</td>
      <td>55.0</td>
    </tr>
    <tr>
      <th>V202</th>
      <td>139631.0</td>
      <td>444.147142</td>
      <td>4683.828419</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>104060.0</td>
    </tr>
    <tr>
      <th>V203</th>
      <td>139631.0</td>
      <td>1078.327538</td>
      <td>9105.607991</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>30.9244</td>
      <td>139777.0</td>
    </tr>
    <tr>
      <th>V204</th>
      <td>139631.0</td>
      <td>686.956931</td>
      <td>6048.980716</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>20.0000</td>
      <td>104060.0</td>
    </tr>
    <tr>
      <th>V205</th>
      <td>139631.0</td>
      <td>18.060417</td>
      <td>266.545451</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>55125.0</td>
    </tr>
    <tr>
      <th>V206</th>
      <td>139631.0</td>
      <td>6.189360</td>
      <td>191.474014</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>55125.0</td>
    </tr>
    <tr>
      <th>V207</th>
      <td>139631.0</td>
      <td>72.284098</td>
      <td>925.676660</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>55125.0</td>
    </tr>
    <tr>
      <th>V208</th>
      <td>139819.0</td>
      <td>8.888193</td>
      <td>59.047125</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>3300.0</td>
    </tr>
    <tr>
      <th>V209</th>
      <td>139819.0</td>
      <td>35.001872</td>
      <td>250.800822</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>8050.0</td>
    </tr>
    <tr>
      <th>V210</th>
      <td>139819.0</td>
      <td>14.391835</td>
      <td>86.523724</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>3300.0</td>
    </tr>
    <tr>
      <th>V211</th>
      <td>139631.0</td>
      <td>385.137037</td>
      <td>4541.837915</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>92888.0</td>
    </tr>
    <tr>
      <th>V212</th>
      <td>139631.0</td>
      <td>765.988339</td>
      <td>7496.120737</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>129006.0</td>
    </tr>
    <tr>
      <th>V213</th>
      <td>139631.0</td>
      <td>536.302802</td>
      <td>5471.664736</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>97628.0</td>
    </tr>
    <tr>
      <th>V214</th>
      <td>139631.0</td>
      <td>38.437547</td>
      <td>571.834283</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>104060.0</td>
    </tr>
    <tr>
      <th>V215</th>
      <td>139631.0</td>
      <td>133.208217</td>
      <td>1040.453748</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>104060.0</td>
    </tr>
    <tr>
      <th>V216</th>
      <td>139631.0</td>
      <td>71.107143</td>
      <td>680.267625</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>104060.0</td>
    </tr>
    <tr>
      <th>V217</th>
      <td>130430.0</td>
      <td>1.054619</td>
      <td>9.547354</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>303.0</td>
    </tr>
    <tr>
      <th>V218</th>
      <td>130430.0</td>
      <td>1.725784</td>
      <td>13.919876</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0000</td>
      <td>400.0</td>
    </tr>
    <tr>
      <th>V219</th>
      <td>130430.0</td>
      <td>1.367132</td>
      <td>12.044032</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0000</td>
      <td>378.0</td>
    </tr>
    <tr>
      <th>V220</th>
      <td>141416.0</td>
      <td>0.169472</td>
      <td>1.002463</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>V221</th>
      <td>141416.0</td>
      <td>1.274912</td>
      <td>2.728792</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0000</td>
      <td>384.0</td>
    </tr>
    <tr>
      <th>V222</th>
      <td>141416.0</td>
      <td>1.359005</td>
      <td>2.913772</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0000</td>
      <td>384.0</td>
    </tr>
    <tr>
      <th>V223</th>
      <td>130430.0</td>
      <td>0.093153</td>
      <td>0.402232</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>V224</th>
      <td>130430.0</td>
      <td>0.394748</td>
      <td>3.443310</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>144.0</td>
    </tr>
    <tr>
      <th>V225</th>
      <td>130430.0</td>
      <td>0.191758</td>
      <td>1.290820</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>51.0</td>
    </tr>
    <tr>
      <th>V226</th>
      <td>130430.0</td>
      <td>0.247612</td>
      <td>2.756449</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>242.0</td>
    </tr>
    <tr>
      <th>V227</th>
      <td>141416.0</td>
      <td>0.147975</td>
      <td>2.049363</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>360.0</td>
    </tr>
    <tr>
      <th>V228</th>
      <td>130430.0</td>
      <td>1.351928</td>
      <td>1.409722</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0000</td>
      <td>54.0</td>
    </tr>
    <tr>
      <th>V229</th>
      <td>130430.0</td>
      <td>1.638710</td>
      <td>4.316026</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0000</td>
      <td>176.0</td>
    </tr>
    <tr>
      <th>V230</th>
      <td>130430.0</td>
      <td>1.465476</td>
      <td>2.122783</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0000</td>
      <td>65.0</td>
    </tr>
    <tr>
      <th>V231</th>
      <td>130430.0</td>
      <td>0.765506</td>
      <td>8.877119</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>293.0</td>
    </tr>
    <tr>
      <th>V232</th>
      <td>130430.0</td>
      <td>1.005597</td>
      <td>10.460253</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>337.0</td>
    </tr>
    <tr>
      <th>V233</th>
      <td>130430.0</td>
      <td>0.908388</td>
      <td>10.149884</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>332.0</td>
    </tr>
    <tr>
      <th>V234</th>
      <td>141416.0</td>
      <td>2.092847</td>
      <td>11.323036</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>121.0</td>
    </tr>
    <tr>
      <th>V235</th>
      <td>130430.0</td>
      <td>0.184106</td>
      <td>0.902639</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>V236</th>
      <td>130430.0</td>
      <td>0.307667</td>
      <td>2.152332</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>45.0</td>
    </tr>
    <tr>
      <th>V237</th>
      <td>130430.0</td>
      <td>0.253500</td>
      <td>1.716634</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>39.0</td>
    </tr>
    <tr>
      <th>V238</th>
      <td>141416.0</td>
      <td>0.127956</td>
      <td>0.574657</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>V239</th>
      <td>141416.0</td>
      <td>0.136965</td>
      <td>0.616260</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>V240</th>
      <td>130430.0</td>
      <td>1.000997</td>
      <td>0.049522</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0000</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>V241</th>
      <td>130430.0</td>
      <td>1.000238</td>
      <td>0.022663</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0000</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>V242</th>
      <td>130430.0</td>
      <td>1.113463</td>
      <td>0.660110</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0000</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>V243</th>
      <td>130430.0</td>
      <td>1.178387</td>
      <td>1.398953</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0000</td>
      <td>57.0</td>
    </tr>
    <tr>
      <th>V244</th>
      <td>130430.0</td>
      <td>1.118562</td>
      <td>0.698807</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0000</td>
      <td>22.0</td>
    </tr>
    <tr>
      <th>V245</th>
      <td>141416.0</td>
      <td>0.876619</td>
      <td>1.821065</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0000</td>
      <td>262.0</td>
    </tr>
    <tr>
      <th>V246</th>
      <td>130430.0</td>
      <td>1.183723</td>
      <td>1.040363</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0000</td>
      <td>45.0</td>
    </tr>
    <tr>
      <th>V247</th>
      <td>130430.0</td>
      <td>1.025355</td>
      <td>0.281604</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0000</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>V248</th>
      <td>130430.0</td>
      <td>1.069493</td>
      <td>0.888341</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0000</td>
      <td>36.0</td>
    </tr>
    <tr>
      <th>V249</th>
      <td>130430.0</td>
      <td>1.042851</td>
      <td>0.528812</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0000</td>
      <td>22.0</td>
    </tr>
    <tr>
      <th>V250</th>
      <td>141416.0</td>
      <td>0.788588</td>
      <td>0.488386</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0000</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>V251</th>
      <td>141416.0</td>
      <td>0.794231</td>
      <td>0.501240</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0000</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>V252</th>
      <td>130430.0</td>
      <td>1.032048</td>
      <td>0.389546</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0000</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>V253</th>
      <td>130430.0</td>
      <td>1.162164</td>
      <td>3.612553</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0000</td>
      <td>163.0</td>
    </tr>
    <tr>
      <th>V254</th>
      <td>130430.0</td>
      <td>1.075113</td>
      <td>1.357550</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0000</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>V255</th>
      <td>141416.0</td>
      <td>0.806656</td>
      <td>0.939124</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0000</td>
      <td>87.0</td>
    </tr>
    <tr>
      <th>V256</th>
      <td>141416.0</td>
      <td>0.814950</td>
      <td>0.969953</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0000</td>
      <td>87.0</td>
    </tr>
    <tr>
      <th>V257</th>
      <td>130430.0</td>
      <td>1.250993</td>
      <td>1.299956</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0000</td>
      <td>48.0</td>
    </tr>
    <tr>
      <th>V258</th>
      <td>130430.0</td>
      <td>1.343510</td>
      <td>2.015811</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0000</td>
      <td>66.0</td>
    </tr>
    <tr>
      <th>V259</th>
      <td>141416.0</td>
      <td>0.967832</td>
      <td>2.113447</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0000</td>
      <td>285.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Variables con valores extremos</p></li>
</ul>
<p>V202–V204: medias bajas, pero desviaciones extremadamente altas → outliers masivos
V211–V216: medias moderadas, pero máximos &gt;100k en varios casos
V205–V207: similares a variables de acumulación o conteo por usuario o tarjeta</p>
<p>Estas variables parecen presentar sesgos extremos y podrían dominar el modelo si no se escalan.</p>
<ul class="simple">
<li><p>Variables binarizadas o pseudobinarias</p></li>
</ul>
<p>V201, V240–V244, V250–V256: valores promedio entre 0.8 y 1.1, mediana = 1, desviación pequeña</p>
<p>Funcionan como banderas que usualmente están activadas (≈1) y ocasionalmente no lo están (0). Muy útiles en árboles de decisión (LightGBM, Random Forest). Algunas pueden no aportar si tienen varianza casi nula.</p>
<ul class="simple">
<li><p>Variables tipo contador o intensidad
V208–V230: algunos con valores bajos y dispersión moderada
V245–V259: valores promedio entre 0.8 y 1.3, pero con máximos elevados, e.g., V259 llega a 285</p></li>
</ul>
<p>Son variables que podrían codificar frecuencia o intensidad de ciertos patrones. Aunque sus medias son bajas, los valores máximos altos pueden indicar anomalías. Su inclusión es importante para capturar comportamientos fuera de lo normal, ideales para modelos no lineales</p>
<ul class="simple">
<li><p>Variables con alta dispersión específica (V217–V230)
Máximos entre 293 y 55125, muchas veces con Q1 = Q2 = Q3 = 0
Esto sugiere presencia de muchos ceros y unos pocos valores muy grandes</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mostrar columnas 301 a 360</span>
<span class="n">display</span><span class="p">(</span><span class="n">train_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">301</span><span class="p">:</span><span class="mi">360</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>V261</th>
      <td>130430.0</td>
      <td>1.107161</td>
      <td>1.323230</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>49.000000</td>
    </tr>
    <tr>
      <th>V262</th>
      <td>130430.0</td>
      <td>1.013279</td>
      <td>0.625455</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>20.000000</td>
    </tr>
    <tr>
      <th>V263</th>
      <td>130430.0</td>
      <td>117.390676</td>
      <td>1294.851543</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>153600.000000</td>
    </tr>
    <tr>
      <th>V264</th>
      <td>130430.0</td>
      <td>201.657617</td>
      <td>2284.827492</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>33.593498</td>
      <td>153600.000000</td>
    </tr>
    <tr>
      <th>V265</th>
      <td>130430.0</td>
      <td>153.520534</td>
      <td>1605.512276</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>20.897525</td>
      <td>153600.000000</td>
    </tr>
    <tr>
      <th>V266</th>
      <td>130430.0</td>
      <td>9.167839</td>
      <td>208.038863</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>55125.000000</td>
    </tr>
    <tr>
      <th>V267</th>
      <td>130430.0</td>
      <td>36.525103</td>
      <td>644.878586</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>55125.000000</td>
    </tr>
    <tr>
      <th>V268</th>
      <td>130430.0</td>
      <td>18.813407</td>
      <td>311.280181</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>55125.000000</td>
    </tr>
    <tr>
      <th>V269</th>
      <td>130430.0</td>
      <td>5.997508</td>
      <td>207.317539</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>55125.000000</td>
    </tr>
    <tr>
      <th>V270</th>
      <td>141416.0</td>
      <td>7.712764</td>
      <td>65.507232</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>4000.000000</td>
    </tr>
    <tr>
      <th>V271</th>
      <td>141416.0</td>
      <td>9.445133</td>
      <td>74.147726</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>4000.000000</td>
    </tr>
    <tr>
      <th>V272</th>
      <td>141416.0</td>
      <td>8.464571</td>
      <td>69.723735</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>4000.000000</td>
    </tr>
    <tr>
      <th>V273</th>
      <td>130430.0</td>
      <td>73.825549</td>
      <td>935.187927</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>51200.000000</td>
    </tr>
    <tr>
      <th>V274</th>
      <td>130430.0</td>
      <td>107.151636</td>
      <td>1258.734139</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>66000.000000</td>
    </tr>
    <tr>
      <th>V275</th>
      <td>130430.0</td>
      <td>88.899939</td>
      <td>1072.883139</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>51200.000000</td>
    </tr>
    <tr>
      <th>V276</th>
      <td>130430.0</td>
      <td>31.797277</td>
      <td>615.659714</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>104060.000000</td>
    </tr>
    <tr>
      <th>V277</th>
      <td>130430.0</td>
      <td>51.956645</td>
      <td>732.145368</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>104060.000000</td>
    </tr>
    <tr>
      <th>V278</th>
      <td>130430.0</td>
      <td>42.328228</td>
      <td>660.611820</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>104060.000000</td>
    </tr>
    <tr>
      <th>V279</th>
      <td>590528.0</td>
      <td>1.123061</td>
      <td>21.021950</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>880.000000</td>
    </tr>
    <tr>
      <th>V280</th>
      <td>590528.0</td>
      <td>1.967082</td>
      <td>27.851780</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>975.000000</td>
    </tr>
    <tr>
      <th>V281</th>
      <td>589271.0</td>
      <td>0.087783</td>
      <td>0.512748</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>22.000000</td>
    </tr>
    <tr>
      <th>V282</th>
      <td>589271.0</td>
      <td>0.817171</td>
      <td>0.921880</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>32.000000</td>
    </tr>
    <tr>
      <th>V283</th>
      <td>589271.0</td>
      <td>0.991114</td>
      <td>1.558731</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>68.000000</td>
    </tr>
    <tr>
      <th>V284</th>
      <td>590528.0</td>
      <td>0.088543</td>
      <td>0.338424</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>12.000000</td>
    </tr>
    <tr>
      <th>V285</th>
      <td>590528.0</td>
      <td>1.167660</td>
      <td>3.282454</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>95.000000</td>
    </tr>
    <tr>
      <th>V286</th>
      <td>590528.0</td>
      <td>0.031492</td>
      <td>0.190939</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>8.000000</td>
    </tr>
    <tr>
      <th>V287</th>
      <td>590528.0</td>
      <td>0.358579</td>
      <td>1.078995</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>31.000000</td>
    </tr>
    <tr>
      <th>V288</th>
      <td>589271.0</td>
      <td>0.184350</td>
      <td>0.430989</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>10.000000</td>
    </tr>
    <tr>
      <th>V289</th>
      <td>589271.0</td>
      <td>0.235975</td>
      <td>0.599231</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>12.000000</td>
    </tr>
    <tr>
      <th>V290</th>
      <td>590528.0</td>
      <td>1.103011</td>
      <td>0.768897</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>67.000000</td>
    </tr>
    <tr>
      <th>V291</th>
      <td>590528.0</td>
      <td>1.659811</td>
      <td>16.252538</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>1055.000000</td>
    </tr>
    <tr>
      <th>V292</th>
      <td>590528.0</td>
      <td>1.239916</td>
      <td>3.775050</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>323.000000</td>
    </tr>
    <tr>
      <th>V293</th>
      <td>590528.0</td>
      <td>0.942599</td>
      <td>20.588816</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>869.000000</td>
    </tr>
    <tr>
      <th>V294</th>
      <td>590528.0</td>
      <td>2.313863</td>
      <td>39.526468</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1286.000000</td>
    </tr>
    <tr>
      <th>V295</th>
      <td>590528.0</td>
      <td>1.433424</td>
      <td>25.962948</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>928.000000</td>
    </tr>
    <tr>
      <th>V296</th>
      <td>589271.0</td>
      <td>0.328917</td>
      <td>3.264745</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>93.000000</td>
    </tr>
    <tr>
      <th>V297</th>
      <td>590528.0</td>
      <td>0.089034</td>
      <td>0.628352</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>12.000000</td>
    </tr>
    <tr>
      <th>V298</th>
      <td>590528.0</td>
      <td>0.298829</td>
      <td>3.175062</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>93.000000</td>
    </tr>
    <tr>
      <th>V299</th>
      <td>590528.0</td>
      <td>0.171655</td>
      <td>1.724218</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>49.000000</td>
    </tr>
    <tr>
      <th>V300</th>
      <td>589271.0</td>
      <td>0.045507</td>
      <td>0.289573</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>11.000000</td>
    </tr>
    <tr>
      <th>V301</th>
      <td>589271.0</td>
      <td>0.052002</td>
      <td>0.318310</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>13.000000</td>
    </tr>
    <tr>
      <th>V302</th>
      <td>590528.0</td>
      <td>0.251761</td>
      <td>0.481889</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>16.000000</td>
    </tr>
    <tr>
      <th>V303</th>
      <td>590528.0</td>
      <td>0.283140</td>
      <td>0.623608</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>20.000000</td>
    </tr>
    <tr>
      <th>V304</th>
      <td>590528.0</td>
      <td>0.264208</td>
      <td>0.528238</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>16.000000</td>
    </tr>
    <tr>
      <th>V305</th>
      <td>590528.0</td>
      <td>1.000007</td>
      <td>0.002603</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>V306</th>
      <td>590528.0</td>
      <td>139.748713</td>
      <td>2348.849634</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>108800.000000</td>
    </tr>
    <tr>
      <th>V307</th>
      <td>590528.0</td>
      <td>408.682375</td>
      <td>4391.992977</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>151.380680</td>
      <td>145765.000000</td>
    </tr>
    <tr>
      <th>V308</th>
      <td>590528.0</td>
      <td>230.413180</td>
      <td>3021.924247</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>35.970001</td>
      <td>108800.000000</td>
    </tr>
    <tr>
      <th>V309</th>
      <td>590528.0</td>
      <td>10.995986</td>
      <td>116.254277</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>55125.000000</td>
    </tr>
    <tr>
      <th>V310</th>
      <td>590528.0</td>
      <td>118.195658</td>
      <td>352.983093</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>107.949997</td>
      <td>55125.000000</td>
    </tr>
    <tr>
      <th>V311</th>
      <td>590528.0</td>
      <td>4.202175</td>
      <td>102.374938</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>55125.000000</td>
    </tr>
    <tr>
      <th>V312</th>
      <td>590528.0</td>
      <td>39.173910</td>
      <td>172.128339</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>55125.000000</td>
    </tr>
    <tr>
      <th>V313</th>
      <td>589271.0</td>
      <td>21.351473</td>
      <td>95.902970</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>4817.470215</td>
    </tr>
    <tr>
      <th>V314</th>
      <td>589271.0</td>
      <td>43.319174</td>
      <td>173.619028</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>7519.870117</td>
    </tr>
    <tr>
      <th>V315</th>
      <td>589271.0</td>
      <td>26.806977</td>
      <td>116.853222</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>4817.470215</td>
    </tr>
    <tr>
      <th>V316</th>
      <td>590528.0</td>
      <td>109.818544</td>
      <td>2270.033202</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>93736.000000</td>
    </tr>
    <tr>
      <th>V317</th>
      <td>590528.0</td>
      <td>247.606741</td>
      <td>3980.042828</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>134021.000000</td>
    </tr>
    <tr>
      <th>V318</th>
      <td>590528.0</td>
      <td>162.153398</td>
      <td>2793.343636</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>98476.000000</td>
    </tr>
    <tr>
      <th>V319</th>
      <td>590528.0</td>
      <td>18.372476</td>
      <td>332.304848</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>104060.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Variables V261–V265</p></li>
</ul>
<p>V261–V262: muy concentradas en 1, con baja desviación → típicas flags o puntajes normalizados.
V263–V265: presentan desviaciones masivas y máximos de hasta 153,600, con cuartiles en 0.</p>
<ul class="simple">
<li><p>Variables V266–V278:</p></li>
</ul>
<p>Máximos entre 51,200 y 104,060
Media cercana a 0 en muchas, con cuartiles en 0</p>
<p>Casi todas son sparse: la mayoría de registros tiene 0, pero algunos tienen valores altísimos. Importantes para detección de anomalías, pero pueden ser redundantes entre sí, por lo que es clave analizar correlaciones internas.</p>
<ul class="simple">
<li><p>Variables V279–V304:</p></li>
</ul>
<p>Algunas como V281, V284, V286, V297–V304: tienen medias muy bajas (cercanas a 0), pero algunos valores máximos relevantes.
V285, V291, V292, V294 muestran valores mayores con máximos &gt;300.</p>
<p>Muchas de estas son banderas con ruido o pseudocontadores. Si bien algunas pueden tener baja varianza, su comportamiento en combinación puede capturar eventos críticos.</p>
<ul class="simple">
<li><p>Variables V305–V319: las más extremas</p></li>
</ul>
<p>V306–V308: máximos entre 108,800 y 145,765 con medias bajas → comportamiento claramente sesgado, requieren transformación (np.log1p).
V309–V319: mismas características; gran parte en 0, pero algunos picos muy altos (como V317 = 134,021).</p>
<p>Altamente indicativas de comportamiento atípico o automatizado (bots, abuso de tarjeta, ataques). Aunque presentan valores extremos, su información puede ser muy valiosa para modelos que detecten outliers (ej: XGBoost, RandomForest). También pueden ser ruidosas para modelos lineales sin escalar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mostrar columnas 361 a 403</span>
<span class="n">display</span><span class="p">(</span><span class="n">train_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">361</span><span class="p">:</span><span class="mi">403</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>V321</th>
      <td>590528.0</td>
      <td>28.326584</td>
      <td>382.053171</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>104060.0</td>
    </tr>
    <tr>
      <th>V322</th>
      <td>82351.0</td>
      <td>6.220289</td>
      <td>56.022561</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>880.0</td>
    </tr>
    <tr>
      <th>V323</th>
      <td>82351.0</td>
      <td>13.103775</td>
      <td>106.739813</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1411.0</td>
    </tr>
    <tr>
      <th>V324</th>
      <td>82351.0</td>
      <td>9.184612</td>
      <td>73.627893</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>976.0</td>
    </tr>
    <tr>
      <th>V325</th>
      <td>82351.0</td>
      <td>0.058494</td>
      <td>0.304415</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>V326</th>
      <td>82351.0</td>
      <td>0.851040</td>
      <td>3.950295</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>44.0</td>
    </tr>
    <tr>
      <th>V327</th>
      <td>82351.0</td>
      <td>0.296633</td>
      <td>1.364356</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>V328</th>
      <td>82351.0</td>
      <td>0.336790</td>
      <td>1.580144</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>V329</th>
      <td>82351.0</td>
      <td>1.312844</td>
      <td>8.769083</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>99.0</td>
    </tr>
    <tr>
      <th>V330</th>
      <td>82351.0</td>
      <td>0.775874</td>
      <td>4.727971</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>55.0</td>
    </tr>
    <tr>
      <th>V331</th>
      <td>82351.0</td>
      <td>721.741883</td>
      <td>6217.223583</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>160000.0</td>
    </tr>
    <tr>
      <th>V332</th>
      <td>82351.0</td>
      <td>1375.783644</td>
      <td>11169.275702</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>25.0</td>
      <td>160000.0</td>
    </tr>
    <tr>
      <th>V333</th>
      <td>82351.0</td>
      <td>1014.622782</td>
      <td>7955.735482</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>160000.0</td>
    </tr>
    <tr>
      <th>V334</th>
      <td>82351.0</td>
      <td>9.807015</td>
      <td>243.861391</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>55125.0</td>
    </tr>
    <tr>
      <th>V335</th>
      <td>82351.0</td>
      <td>59.164550</td>
      <td>387.629480</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>55125.0</td>
    </tr>
    <tr>
      <th>V336</th>
      <td>82351.0</td>
      <td>28.530903</td>
      <td>274.576920</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>55125.0</td>
    </tr>
    <tr>
      <th>V337</th>
      <td>82351.0</td>
      <td>55.352422</td>
      <td>668.486833</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>104060.0</td>
    </tr>
    <tr>
      <th>V338</th>
      <td>82351.0</td>
      <td>151.160542</td>
      <td>1095.034387</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>104060.0</td>
    </tr>
    <tr>
      <th>V339</th>
      <td>82351.0</td>
      <td>100.700882</td>
      <td>814.946722</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>104060.0</td>
    </tr>
    <tr>
      <th>id_01</th>
      <td>144233.0</td>
      <td>-10.170502</td>
      <td>14.347949</td>
      <td>-100.0</td>
      <td>-10.0</td>
      <td>-5.0</td>
      <td>-5.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>id_02</th>
      <td>140872.0</td>
      <td>174716.584708</td>
      <td>159651.816856</td>
      <td>1.0</td>
      <td>67992.0</td>
      <td>125800.5</td>
      <td>228749.0</td>
      <td>999595.0</td>
    </tr>
    <tr>
      <th>id_03</th>
      <td>66324.0</td>
      <td>0.060189</td>
      <td>0.598231</td>
      <td>-13.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>id_04</th>
      <td>66324.0</td>
      <td>-0.058938</td>
      <td>0.701015</td>
      <td>-28.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>id_05</th>
      <td>136865.0</td>
      <td>1.615585</td>
      <td>5.249856</td>
      <td>-72.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>52.0</td>
    </tr>
    <tr>
      <th>id_06</th>
      <td>136865.0</td>
      <td>-6.698710</td>
      <td>16.491104</td>
      <td>-100.0</td>
      <td>-6.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>id_07</th>
      <td>5155.0</td>
      <td>13.285354</td>
      <td>11.384207</td>
      <td>-46.0</td>
      <td>5.0</td>
      <td>14.0</td>
      <td>22.0</td>
      <td>61.0</td>
    </tr>
    <tr>
      <th>id_08</th>
      <td>5155.0</td>
      <td>-38.600388</td>
      <td>26.084899</td>
      <td>-100.0</td>
      <td>-48.0</td>
      <td>-34.0</td>
      <td>-23.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>id_09</th>
      <td>74926.0</td>
      <td>0.091023</td>
      <td>0.983842</td>
      <td>-36.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>id_10</th>
      <td>74926.0</td>
      <td>-0.301124</td>
      <td>2.789446</td>
      <td>-100.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>id_11</th>
      <td>140978.0</td>
      <td>99.745325</td>
      <td>1.127602</td>
      <td>90.0</td>
      <td>100.0</td>
      <td>100.0</td>
      <td>100.0</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>id_13</th>
      <td>127320.0</td>
      <td>48.053071</td>
      <td>11.774858</td>
      <td>10.0</td>
      <td>49.0</td>
      <td>52.0</td>
      <td>52.0</td>
      <td>64.0</td>
    </tr>
    <tr>
      <th>id_14</th>
      <td>80044.0</td>
      <td>-344.507146</td>
      <td>93.695502</td>
      <td>-660.0</td>
      <td>-360.0</td>
      <td>-300.0</td>
      <td>-300.0</td>
      <td>720.0</td>
    </tr>
    <tr>
      <th>id_17</th>
      <td>139369.0</td>
      <td>189.451377</td>
      <td>30.375360</td>
      <td>100.0</td>
      <td>166.0</td>
      <td>166.0</td>
      <td>225.0</td>
      <td>229.0</td>
    </tr>
    <tr>
      <th>id_18</th>
      <td>45113.0</td>
      <td>14.237337</td>
      <td>1.561302</td>
      <td>10.0</td>
      <td>13.0</td>
      <td>15.0</td>
      <td>15.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>id_19</th>
      <td>139318.0</td>
      <td>353.128174</td>
      <td>141.095343</td>
      <td>100.0</td>
      <td>266.0</td>
      <td>341.0</td>
      <td>427.0</td>
      <td>671.0</td>
    </tr>
    <tr>
      <th>id_20</th>
      <td>139261.0</td>
      <td>403.882666</td>
      <td>152.160327</td>
      <td>100.0</td>
      <td>256.0</td>
      <td>472.0</td>
      <td>533.0</td>
      <td>661.0</td>
    </tr>
    <tr>
      <th>id_21</th>
      <td>5159.0</td>
      <td>368.269820</td>
      <td>198.847038</td>
      <td>100.0</td>
      <td>252.0</td>
      <td>252.0</td>
      <td>486.5</td>
      <td>854.0</td>
    </tr>
    <tr>
      <th>id_22</th>
      <td>5169.0</td>
      <td>16.002708</td>
      <td>6.897665</td>
      <td>10.0</td>
      <td>14.0</td>
      <td>14.0</td>
      <td>14.0</td>
      <td>44.0</td>
    </tr>
    <tr>
      <th>id_24</th>
      <td>4747.0</td>
      <td>12.800927</td>
      <td>2.372447</td>
      <td>11.0</td>
      <td>11.0</td>
      <td>11.0</td>
      <td>15.0</td>
      <td>26.0</td>
    </tr>
    <tr>
      <th>id_25</th>
      <td>5132.0</td>
      <td>329.608924</td>
      <td>97.461089</td>
      <td>100.0</td>
      <td>321.0</td>
      <td>321.0</td>
      <td>371.0</td>
      <td>548.0</td>
    </tr>
    <tr>
      <th>id_26</th>
      <td>5163.0</td>
      <td>149.070308</td>
      <td>32.101995</td>
      <td>100.0</td>
      <td>119.0</td>
      <td>149.0</td>
      <td>169.0</td>
      <td>216.0</td>
    </tr>
    <tr>
      <th>id_32</th>
      <td>77586.0</td>
      <td>26.508597</td>
      <td>3.737502</td>
      <td>0.0</td>
      <td>24.0</td>
      <td>24.0</td>
      <td>32.0</td>
      <td>32.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Variables V321–V339</p></li>
</ul>
<p>Muchas con cuartiles en 0, pero máximos muy altos (hasta 160,000 en V331–V333). Algunas con dispersión leve (V325–V330) y otras con valores extremos y gran varianza (V331–V339).</p>
<ul class="simple">
<li><p>Variables id_01 a id_32 (identidad y dispositivo)</p></li>
</ul>
<p>Presenta variables con valores negativos y dispersión amplia: id_01, id_03–id_10, id_14, id_06: contienen valores negativos, probablemente escalas internas, tiempos o puntuaciones. Estas podrían reflejar desplazamientos temporales, normalización de tiempos, puntuaciones u otros efectos relativos. Requieren estandarización para usar en modelos sensibles a escala (como regresión logística o SVM).</p>
<ul class="simple">
<li><p>Variables con comportamiento de recuentos o tiempos:</p></li>
</ul>
<p>id_11: extremadamente estable, con valor fijo en 100 → puede ser poco informativa.
id_13, id_17–id_20: representan valores mayores y dispersos, pueden estar relacionadas con duración de sesiones, días desde último acceso, etc.
id_13, id_17, id_19–id_20 parecen buenas candidatas para modelar comportamiento transaccional.</p>
<ul class="simple">
<li><p>Variables posiblemente categóricas codificadas:</p></li>
</ul>
<p>id_25, id_26, id_32: su bajo número de valores únicos sugiere que pueden ser categóricas numéricas, ideales para encoding o one-hot.
id_24 y id_22: media baja, rango acotado, probablemente flags internos.
Pueden convertirse a tipo categoría, especialmente si se usa un modelo que no requiere estandarización previa.</p>
</section>
<section id="conteo-de-valores-nulos-y-porcentaje-de-datos-faltantes">
<h2>Conteo de valores nulos y porcentaje de datos faltantes<a class="headerlink" href="#conteo-de-valores-nulos-y-porcentaje-de-datos-faltantes" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Conteo y porcentaje de valores nulos</span>
<span class="n">faltantes</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">faltantes_pct</span> <span class="o">=</span> <span class="p">(</span><span class="n">faltantes</span> <span class="o">/</span> <span class="n">train_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Crear un DataFrame ordenado para análisis</span>
<span class="n">missing_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Total_Faltantes&#39;</span><span class="p">:</span> <span class="n">faltantes</span><span class="p">,</span>
    <span class="s1">&#39;Porcentaje&#39;</span><span class="p">:</span> <span class="n">faltantes_pct</span>
<span class="p">})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Porcentaje&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variables con más valores faltantes:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">missing_df</span><span class="p">[</span><span class="n">missing_df</span><span class="p">[</span><span class="s1">&#39;Total_Faltantes&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">60</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variables con más valores faltantes:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Total_Faltantes</th>
      <th>Porcentaje</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id_24</th>
      <td>585793</td>
      <td>99.196159</td>
    </tr>
    <tr>
      <th>id_25</th>
      <td>585408</td>
      <td>99.130965</td>
    </tr>
    <tr>
      <th>id_07</th>
      <td>585385</td>
      <td>99.127070</td>
    </tr>
    <tr>
      <th>id_08</th>
      <td>585385</td>
      <td>99.127070</td>
    </tr>
    <tr>
      <th>id_21</th>
      <td>585381</td>
      <td>99.126393</td>
    </tr>
    <tr>
      <th>id_26</th>
      <td>585377</td>
      <td>99.125715</td>
    </tr>
    <tr>
      <th>id_27</th>
      <td>585371</td>
      <td>99.124699</td>
    </tr>
    <tr>
      <th>id_23</th>
      <td>585371</td>
      <td>99.124699</td>
    </tr>
    <tr>
      <th>id_22</th>
      <td>585371</td>
      <td>99.124699</td>
    </tr>
    <tr>
      <th>dist2</th>
      <td>552913</td>
      <td>93.628374</td>
    </tr>
    <tr>
      <th>D7</th>
      <td>551623</td>
      <td>93.409930</td>
    </tr>
    <tr>
      <th>id_18</th>
      <td>545427</td>
      <td>92.360721</td>
    </tr>
    <tr>
      <th>D13</th>
      <td>528588</td>
      <td>89.509263</td>
    </tr>
    <tr>
      <th>D14</th>
      <td>528353</td>
      <td>89.469469</td>
    </tr>
    <tr>
      <th>D12</th>
      <td>525823</td>
      <td>89.041047</td>
    </tr>
    <tr>
      <th>id_03</th>
      <td>524216</td>
      <td>88.768923</td>
    </tr>
    <tr>
      <th>id_04</th>
      <td>524216</td>
      <td>88.768923</td>
    </tr>
    <tr>
      <th>D6</th>
      <td>517353</td>
      <td>87.606767</td>
    </tr>
    <tr>
      <th>id_33</th>
      <td>517251</td>
      <td>87.589494</td>
    </tr>
    <tr>
      <th>id_10</th>
      <td>515614</td>
      <td>87.312290</td>
    </tr>
    <tr>
      <th>id_09</th>
      <td>515614</td>
      <td>87.312290</td>
    </tr>
    <tr>
      <th>D9</th>
      <td>515614</td>
      <td>87.312290</td>
    </tr>
    <tr>
      <th>D8</th>
      <td>515614</td>
      <td>87.312290</td>
    </tr>
    <tr>
      <th>id_30</th>
      <td>512975</td>
      <td>86.865411</td>
    </tr>
    <tr>
      <th>id_32</th>
      <td>512954</td>
      <td>86.861855</td>
    </tr>
    <tr>
      <th>id_34</th>
      <td>512735</td>
      <td>86.824771</td>
    </tr>
    <tr>
      <th>id_14</th>
      <td>510496</td>
      <td>86.445626</td>
    </tr>
    <tr>
      <th>V142</th>
      <td>508595</td>
      <td>86.123717</td>
    </tr>
    <tr>
      <th>V158</th>
      <td>508595</td>
      <td>86.123717</td>
    </tr>
    <tr>
      <th>V140</th>
      <td>508595</td>
      <td>86.123717</td>
    </tr>
    <tr>
      <th>V162</th>
      <td>508595</td>
      <td>86.123717</td>
    </tr>
    <tr>
      <th>V141</th>
      <td>508595</td>
      <td>86.123717</td>
    </tr>
    <tr>
      <th>V161</th>
      <td>508595</td>
      <td>86.123717</td>
    </tr>
    <tr>
      <th>V157</th>
      <td>508595</td>
      <td>86.123717</td>
    </tr>
    <tr>
      <th>V146</th>
      <td>508595</td>
      <td>86.123717</td>
    </tr>
    <tr>
      <th>V156</th>
      <td>508595</td>
      <td>86.123717</td>
    </tr>
    <tr>
      <th>V155</th>
      <td>508595</td>
      <td>86.123717</td>
    </tr>
    <tr>
      <th>V154</th>
      <td>508595</td>
      <td>86.123717</td>
    </tr>
    <tr>
      <th>V153</th>
      <td>508595</td>
      <td>86.123717</td>
    </tr>
    <tr>
      <th>V149</th>
      <td>508595</td>
      <td>86.123717</td>
    </tr>
    <tr>
      <th>V147</th>
      <td>508595</td>
      <td>86.123717</td>
    </tr>
    <tr>
      <th>V148</th>
      <td>508595</td>
      <td>86.123717</td>
    </tr>
    <tr>
      <th>V163</th>
      <td>508595</td>
      <td>86.123717</td>
    </tr>
    <tr>
      <th>V139</th>
      <td>508595</td>
      <td>86.123717</td>
    </tr>
    <tr>
      <th>V138</th>
      <td>508595</td>
      <td>86.123717</td>
    </tr>
    <tr>
      <th>V160</th>
      <td>508589</td>
      <td>86.122701</td>
    </tr>
    <tr>
      <th>V151</th>
      <td>508589</td>
      <td>86.122701</td>
    </tr>
    <tr>
      <th>V152</th>
      <td>508589</td>
      <td>86.122701</td>
    </tr>
    <tr>
      <th>V145</th>
      <td>508589</td>
      <td>86.122701</td>
    </tr>
    <tr>
      <th>V144</th>
      <td>508589</td>
      <td>86.122701</td>
    </tr>
    <tr>
      <th>V143</th>
      <td>508589</td>
      <td>86.122701</td>
    </tr>
    <tr>
      <th>V159</th>
      <td>508589</td>
      <td>86.122701</td>
    </tr>
    <tr>
      <th>V164</th>
      <td>508589</td>
      <td>86.122701</td>
    </tr>
    <tr>
      <th>V165</th>
      <td>508589</td>
      <td>86.122701</td>
    </tr>
    <tr>
      <th>V166</th>
      <td>508589</td>
      <td>86.122701</td>
    </tr>
    <tr>
      <th>V150</th>
      <td>508589</td>
      <td>86.122701</td>
    </tr>
    <tr>
      <th>V337</th>
      <td>508189</td>
      <td>86.054967</td>
    </tr>
    <tr>
      <th>V333</th>
      <td>508189</td>
      <td>86.054967</td>
    </tr>
    <tr>
      <th>V336</th>
      <td>508189</td>
      <td>86.054967</td>
    </tr>
    <tr>
      <th>V335</th>
      <td>508189</td>
      <td>86.054967</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variables con más valores faltantes:&quot;</span><span class="p">)</span>
<span class="c1"># display(train_df.describe().T.iloc[361:403])</span>
<span class="n">display</span><span class="p">(</span><span class="n">missing_df</span><span class="p">[</span><span class="n">missing_df</span><span class="p">[</span><span class="s1">&#39;Total_Faltantes&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">61</span><span class="p">:</span><span class="mi">120</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variables con más valores faltantes:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Total_Faltantes</th>
      <th>Porcentaje</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>V338</th>
      <td>508189</td>
      <td>86.054967</td>
    </tr>
    <tr>
      <th>V339</th>
      <td>508189</td>
      <td>86.054967</td>
    </tr>
    <tr>
      <th>V324</th>
      <td>508189</td>
      <td>86.054967</td>
    </tr>
    <tr>
      <th>V332</th>
      <td>508189</td>
      <td>86.054967</td>
    </tr>
    <tr>
      <th>V325</th>
      <td>508189</td>
      <td>86.054967</td>
    </tr>
    <tr>
      <th>V330</th>
      <td>508189</td>
      <td>86.054967</td>
    </tr>
    <tr>
      <th>V329</th>
      <td>508189</td>
      <td>86.054967</td>
    </tr>
    <tr>
      <th>V328</th>
      <td>508189</td>
      <td>86.054967</td>
    </tr>
    <tr>
      <th>V327</th>
      <td>508189</td>
      <td>86.054967</td>
    </tr>
    <tr>
      <th>V326</th>
      <td>508189</td>
      <td>86.054967</td>
    </tr>
    <tr>
      <th>V322</th>
      <td>508189</td>
      <td>86.054967</td>
    </tr>
    <tr>
      <th>V323</th>
      <td>508189</td>
      <td>86.054967</td>
    </tr>
    <tr>
      <th>V331</th>
      <td>508189</td>
      <td>86.054967</td>
    </tr>
    <tr>
      <th>DeviceInfo</th>
      <td>471874</td>
      <td>79.905510</td>
    </tr>
    <tr>
      <th>id_13</th>
      <td>463220</td>
      <td>78.440072</td>
    </tr>
    <tr>
      <th>id_16</th>
      <td>461200</td>
      <td>78.098012</td>
    </tr>
    <tr>
      <th>V278</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V277</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V252</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V253</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V254</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V257</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V258</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V242</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V261</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V262</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V263</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V264</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V249</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V266</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V267</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V268</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V269</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V273</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V274</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V275</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V276</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V265</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V260</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V247</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V246</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V240</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V237</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V236</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V235</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V233</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V232</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V231</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V230</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V229</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V228</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V226</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V225</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V224</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V223</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V219</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V218</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V217</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V243</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variables con más valores faltantes:&quot;</span><span class="p">)</span>
<span class="c1"># display(train_df.describe().T.iloc[361:403])</span>
<span class="n">display</span><span class="p">(</span><span class="n">missing_df</span><span class="p">[</span><span class="n">missing_df</span><span class="p">[</span><span class="s1">&#39;Total_Faltantes&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">121</span><span class="p">:</span><span class="mi">180</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variables con más valores faltantes:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Total_Faltantes</th>
      <th>Porcentaje</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>V248</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>V241</th>
      <td>460110</td>
      <td>77.913435</td>
    </tr>
    <tr>
      <th>id_05</th>
      <td>453675</td>
      <td>76.823755</td>
    </tr>
    <tr>
      <th>id_06</th>
      <td>453675</td>
      <td>76.823755</td>
    </tr>
    <tr>
      <th>R_emaildomain</th>
      <td>453249</td>
      <td>76.751617</td>
    </tr>
    <tr>
      <th>id_20</th>
      <td>451279</td>
      <td>76.418024</td>
    </tr>
    <tr>
      <th>id_19</th>
      <td>451222</td>
      <td>76.408372</td>
    </tr>
    <tr>
      <th>id_17</th>
      <td>451171</td>
      <td>76.399736</td>
    </tr>
    <tr>
      <th>V212</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V211</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V214</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V213</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V196</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V205</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V183</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V216</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V206</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V186</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V187</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V192</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V207</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V215</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V181</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V182</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V191</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V167</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V168</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V199</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V193</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V172</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V173</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V202</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V203</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V176</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V177</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V178</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V179</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V204</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V190</th>
      <td>450909</td>
      <td>76.355370</td>
    </tr>
    <tr>
      <th>V194</th>
      <td>450721</td>
      <td>76.323534</td>
    </tr>
    <tr>
      <th>V200</th>
      <td>450721</td>
      <td>76.323534</td>
    </tr>
    <tr>
      <th>V189</th>
      <td>450721</td>
      <td>76.323534</td>
    </tr>
    <tr>
      <th>V188</th>
      <td>450721</td>
      <td>76.323534</td>
    </tr>
    <tr>
      <th>V185</th>
      <td>450721</td>
      <td>76.323534</td>
    </tr>
    <tr>
      <th>V184</th>
      <td>450721</td>
      <td>76.323534</td>
    </tr>
    <tr>
      <th>V180</th>
      <td>450721</td>
      <td>76.323534</td>
    </tr>
    <tr>
      <th>V175</th>
      <td>450721</td>
      <td>76.323534</td>
    </tr>
    <tr>
      <th>V174</th>
      <td>450721</td>
      <td>76.323534</td>
    </tr>
    <tr>
      <th>V171</th>
      <td>450721</td>
      <td>76.323534</td>
    </tr>
    <tr>
      <th>V170</th>
      <td>450721</td>
      <td>76.323534</td>
    </tr>
    <tr>
      <th>V169</th>
      <td>450721</td>
      <td>76.323534</td>
    </tr>
    <tr>
      <th>V195</th>
      <td>450721</td>
      <td>76.323534</td>
    </tr>
    <tr>
      <th>V201</th>
      <td>450721</td>
      <td>76.323534</td>
    </tr>
    <tr>
      <th>V197</th>
      <td>450721</td>
      <td>76.323534</td>
    </tr>
    <tr>
      <th>V198</th>
      <td>450721</td>
      <td>76.323534</td>
    </tr>
    <tr>
      <th>V209</th>
      <td>450721</td>
      <td>76.323534</td>
    </tr>
    <tr>
      <th>V208</th>
      <td>450721</td>
      <td>76.323534</td>
    </tr>
    <tr>
      <th>V210</th>
      <td>450721</td>
      <td>76.323534</td>
    </tr>
    <tr>
      <th>id_31</th>
      <td>450258</td>
      <td>76.245132</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variables con más valores faltantes:&quot;</span><span class="p">)</span>
<span class="c1"># display(train_df.describe().T.iloc[361:403])</span>
<span class="n">display</span><span class="p">(</span><span class="n">missing_df</span><span class="p">[</span><span class="n">missing_df</span><span class="p">[</span><span class="s1">&#39;Total_Faltantes&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">181</span><span class="p">:</span><span class="mi">240</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variables con más valores faltantes:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Total_Faltantes</th>
      <th>Porcentaje</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id_02</th>
      <td>449668</td>
      <td>76.145223</td>
    </tr>
    <tr>
      <th>id_29</th>
      <td>449562</td>
      <td>76.127273</td>
    </tr>
    <tr>
      <th>id_11</th>
      <td>449562</td>
      <td>76.127273</td>
    </tr>
    <tr>
      <th>id_28</th>
      <td>449562</td>
      <td>76.127273</td>
    </tr>
    <tr>
      <th>id_37</th>
      <td>449555</td>
      <td>76.126088</td>
    </tr>
    <tr>
      <th>id_36</th>
      <td>449555</td>
      <td>76.126088</td>
    </tr>
    <tr>
      <th>id_15</th>
      <td>449555</td>
      <td>76.126088</td>
    </tr>
    <tr>
      <th>id_35</th>
      <td>449555</td>
      <td>76.126088</td>
    </tr>
    <tr>
      <th>id_38</th>
      <td>449555</td>
      <td>76.126088</td>
    </tr>
    <tr>
      <th>V245</th>
      <td>449124</td>
      <td>76.053104</td>
    </tr>
    <tr>
      <th>V271</th>
      <td>449124</td>
      <td>76.053104</td>
    </tr>
    <tr>
      <th>V234</th>
      <td>449124</td>
      <td>76.053104</td>
    </tr>
    <tr>
      <th>V222</th>
      <td>449124</td>
      <td>76.053104</td>
    </tr>
    <tr>
      <th>V238</th>
      <td>449124</td>
      <td>76.053104</td>
    </tr>
    <tr>
      <th>V239</th>
      <td>449124</td>
      <td>76.053104</td>
    </tr>
    <tr>
      <th>V227</th>
      <td>449124</td>
      <td>76.053104</td>
    </tr>
    <tr>
      <th>V250</th>
      <td>449124</td>
      <td>76.053104</td>
    </tr>
    <tr>
      <th>V272</th>
      <td>449124</td>
      <td>76.053104</td>
    </tr>
    <tr>
      <th>V270</th>
      <td>449124</td>
      <td>76.053104</td>
    </tr>
    <tr>
      <th>V251</th>
      <td>449124</td>
      <td>76.053104</td>
    </tr>
    <tr>
      <th>V220</th>
      <td>449124</td>
      <td>76.053104</td>
    </tr>
    <tr>
      <th>V255</th>
      <td>449124</td>
      <td>76.053104</td>
    </tr>
    <tr>
      <th>V256</th>
      <td>449124</td>
      <td>76.053104</td>
    </tr>
    <tr>
      <th>V259</th>
      <td>449124</td>
      <td>76.053104</td>
    </tr>
    <tr>
      <th>V221</th>
      <td>449124</td>
      <td>76.053104</td>
    </tr>
    <tr>
      <th>id_01</th>
      <td>446307</td>
      <td>75.576083</td>
    </tr>
    <tr>
      <th>id_12</th>
      <td>446307</td>
      <td>75.576083</td>
    </tr>
    <tr>
      <th>dist1</th>
      <td>352271</td>
      <td>59.652352</td>
    </tr>
    <tr>
      <th>M5</th>
      <td>350482</td>
      <td>59.349409</td>
    </tr>
    <tr>
      <th>M7</th>
      <td>346265</td>
      <td>58.635317</td>
    </tr>
    <tr>
      <th>M9</th>
      <td>346252</td>
      <td>58.633115</td>
    </tr>
    <tr>
      <th>M8</th>
      <td>346252</td>
      <td>58.633115</td>
    </tr>
    <tr>
      <th>D5</th>
      <td>309841</td>
      <td>52.467403</td>
    </tr>
    <tr>
      <th>M4</th>
      <td>281444</td>
      <td>47.658753</td>
    </tr>
    <tr>
      <th>D2</th>
      <td>280797</td>
      <td>47.549192</td>
    </tr>
    <tr>
      <th>V3</th>
      <td>279287</td>
      <td>47.293494</td>
    </tr>
    <tr>
      <th>V9</th>
      <td>279287</td>
      <td>47.293494</td>
    </tr>
    <tr>
      <th>V5</th>
      <td>279287</td>
      <td>47.293494</td>
    </tr>
    <tr>
      <th>V11</th>
      <td>279287</td>
      <td>47.293494</td>
    </tr>
    <tr>
      <th>V10</th>
      <td>279287</td>
      <td>47.293494</td>
    </tr>
    <tr>
      <th>V8</th>
      <td>279287</td>
      <td>47.293494</td>
    </tr>
    <tr>
      <th>V7</th>
      <td>279287</td>
      <td>47.293494</td>
    </tr>
    <tr>
      <th>D11</th>
      <td>279287</td>
      <td>47.293494</td>
    </tr>
    <tr>
      <th>V6</th>
      <td>279287</td>
      <td>47.293494</td>
    </tr>
    <tr>
      <th>V4</th>
      <td>279287</td>
      <td>47.293494</td>
    </tr>
    <tr>
      <th>V2</th>
      <td>279287</td>
      <td>47.293494</td>
    </tr>
    <tr>
      <th>V1</th>
      <td>279287</td>
      <td>47.293494</td>
    </tr>
    <tr>
      <th>M2</th>
      <td>271100</td>
      <td>45.907136</td>
    </tr>
    <tr>
      <th>M3</th>
      <td>271100</td>
      <td>45.907136</td>
    </tr>
    <tr>
      <th>M1</th>
      <td>271100</td>
      <td>45.907136</td>
    </tr>
    <tr>
      <th>D3</th>
      <td>262878</td>
      <td>44.514851</td>
    </tr>
    <tr>
      <th>M6</th>
      <td>169360</td>
      <td>28.678836</td>
    </tr>
    <tr>
      <th>V35</th>
      <td>168969</td>
      <td>28.612626</td>
    </tr>
    <tr>
      <th>V40</th>
      <td>168969</td>
      <td>28.612626</td>
    </tr>
    <tr>
      <th>V41</th>
      <td>168969</td>
      <td>28.612626</td>
    </tr>
    <tr>
      <th>V39</th>
      <td>168969</td>
      <td>28.612626</td>
    </tr>
    <tr>
      <th>V38</th>
      <td>168969</td>
      <td>28.612626</td>
    </tr>
    <tr>
      <th>V51</th>
      <td>168969</td>
      <td>28.612626</td>
    </tr>
    <tr>
      <th>V37</th>
      <td>168969</td>
      <td>28.612626</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variables con más valores faltantes:&quot;</span><span class="p">)</span>
<span class="c1"># display(train_df.describe().T.iloc[361:403])</span>
<span class="n">display</span><span class="p">(</span><span class="n">missing_df</span><span class="p">[</span><span class="n">missing_df</span><span class="p">[</span><span class="s1">&#39;Total_Faltantes&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">241</span><span class="p">:</span><span class="mi">300</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variables con más valores faltantes:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Total_Faltantes</th>
      <th>Porcentaje</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>V36</th>
      <td>168969</td>
      <td>28.612626</td>
    </tr>
    <tr>
      <th>V50</th>
      <td>168969</td>
      <td>28.612626</td>
    </tr>
    <tr>
      <th>V48</th>
      <td>168969</td>
      <td>28.612626</td>
    </tr>
    <tr>
      <th>V42</th>
      <td>168969</td>
      <td>28.612626</td>
    </tr>
    <tr>
      <th>V43</th>
      <td>168969</td>
      <td>28.612626</td>
    </tr>
    <tr>
      <th>V44</th>
      <td>168969</td>
      <td>28.612626</td>
    </tr>
    <tr>
      <th>V46</th>
      <td>168969</td>
      <td>28.612626</td>
    </tr>
    <tr>
      <th>V47</th>
      <td>168969</td>
      <td>28.612626</td>
    </tr>
    <tr>
      <th>V45</th>
      <td>168969</td>
      <td>28.612626</td>
    </tr>
    <tr>
      <th>V49</th>
      <td>168969</td>
      <td>28.612626</td>
    </tr>
    <tr>
      <th>D4</th>
      <td>168922</td>
      <td>28.604667</td>
    </tr>
    <tr>
      <th>P_emaildomain</th>
      <td>94456</td>
      <td>15.994852</td>
    </tr>
    <tr>
      <th>V80</th>
      <td>89164</td>
      <td>15.098723</td>
    </tr>
    <tr>
      <th>V87</th>
      <td>89164</td>
      <td>15.098723</td>
    </tr>
    <tr>
      <th>V88</th>
      <td>89164</td>
      <td>15.098723</td>
    </tr>
    <tr>
      <th>V89</th>
      <td>89164</td>
      <td>15.098723</td>
    </tr>
    <tr>
      <th>V90</th>
      <td>89164</td>
      <td>15.098723</td>
    </tr>
    <tr>
      <th>V91</th>
      <td>89164</td>
      <td>15.098723</td>
    </tr>
    <tr>
      <th>V92</th>
      <td>89164</td>
      <td>15.098723</td>
    </tr>
    <tr>
      <th>V93</th>
      <td>89164</td>
      <td>15.098723</td>
    </tr>
    <tr>
      <th>V94</th>
      <td>89164</td>
      <td>15.098723</td>
    </tr>
    <tr>
      <th>V86</th>
      <td>89164</td>
      <td>15.098723</td>
    </tr>
    <tr>
      <th>V79</th>
      <td>89164</td>
      <td>15.098723</td>
    </tr>
    <tr>
      <th>V85</th>
      <td>89164</td>
      <td>15.098723</td>
    </tr>
    <tr>
      <th>V75</th>
      <td>89164</td>
      <td>15.098723</td>
    </tr>
    <tr>
      <th>V84</th>
      <td>89164</td>
      <td>15.098723</td>
    </tr>
    <tr>
      <th>V77</th>
      <td>89164</td>
      <td>15.098723</td>
    </tr>
    <tr>
      <th>V83</th>
      <td>89164</td>
      <td>15.098723</td>
    </tr>
    <tr>
      <th>V78</th>
      <td>89164</td>
      <td>15.098723</td>
    </tr>
    <tr>
      <th>V82</th>
      <td>89164</td>
      <td>15.098723</td>
    </tr>
    <tr>
      <th>V81</th>
      <td>89164</td>
      <td>15.098723</td>
    </tr>
    <tr>
      <th>V76</th>
      <td>89164</td>
      <td>15.098723</td>
    </tr>
    <tr>
      <th>D15</th>
      <td>89113</td>
      <td>15.090087</td>
    </tr>
    <tr>
      <th>V72</th>
      <td>77096</td>
      <td>13.055170</td>
    </tr>
    <tr>
      <th>V74</th>
      <td>77096</td>
      <td>13.055170</td>
    </tr>
    <tr>
      <th>V73</th>
      <td>77096</td>
      <td>13.055170</td>
    </tr>
    <tr>
      <th>V71</th>
      <td>77096</td>
      <td>13.055170</td>
    </tr>
    <tr>
      <th>V65</th>
      <td>77096</td>
      <td>13.055170</td>
    </tr>
    <tr>
      <th>V68</th>
      <td>77096</td>
      <td>13.055170</td>
    </tr>
    <tr>
      <th>V58</th>
      <td>77096</td>
      <td>13.055170</td>
    </tr>
    <tr>
      <th>V70</th>
      <td>77096</td>
      <td>13.055170</td>
    </tr>
    <tr>
      <th>V53</th>
      <td>77096</td>
      <td>13.055170</td>
    </tr>
    <tr>
      <th>V54</th>
      <td>77096</td>
      <td>13.055170</td>
    </tr>
    <tr>
      <th>V55</th>
      <td>77096</td>
      <td>13.055170</td>
    </tr>
    <tr>
      <th>V56</th>
      <td>77096</td>
      <td>13.055170</td>
    </tr>
    <tr>
      <th>V57</th>
      <td>77096</td>
      <td>13.055170</td>
    </tr>
    <tr>
      <th>V59</th>
      <td>77096</td>
      <td>13.055170</td>
    </tr>
    <tr>
      <th>V67</th>
      <td>77096</td>
      <td>13.055170</td>
    </tr>
    <tr>
      <th>V60</th>
      <td>77096</td>
      <td>13.055170</td>
    </tr>
    <tr>
      <th>V61</th>
      <td>77096</td>
      <td>13.055170</td>
    </tr>
    <tr>
      <th>V62</th>
      <td>77096</td>
      <td>13.055170</td>
    </tr>
    <tr>
      <th>V63</th>
      <td>77096</td>
      <td>13.055170</td>
    </tr>
    <tr>
      <th>V64</th>
      <td>77096</td>
      <td>13.055170</td>
    </tr>
    <tr>
      <th>V66</th>
      <td>77096</td>
      <td>13.055170</td>
    </tr>
    <tr>
      <th>V69</th>
      <td>77096</td>
      <td>13.055170</td>
    </tr>
    <tr>
      <th>V21</th>
      <td>76073</td>
      <td>12.881939</td>
    </tr>
    <tr>
      <th>V22</th>
      <td>76073</td>
      <td>12.881939</td>
    </tr>
    <tr>
      <th>V23</th>
      <td>76073</td>
      <td>12.881939</td>
    </tr>
    <tr>
      <th>V34</th>
      <td>76073</td>
      <td>12.881939</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variables con más valores faltantes:&quot;</span><span class="p">)</span>
<span class="c1"># display(train_df.describe().T.iloc[361:403])</span>
<span class="n">display</span><span class="p">(</span><span class="n">missing_df</span><span class="p">[</span><span class="n">missing_df</span><span class="p">[</span><span class="s1">&#39;Total_Faltantes&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">301</span><span class="p">:</span><span class="mi">360</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variables con más valores faltantes:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Total_Faltantes</th>
      <th>Porcentaje</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>V32</th>
      <td>76073</td>
      <td>12.881939</td>
    </tr>
    <tr>
      <th>V31</th>
      <td>76073</td>
      <td>12.881939</td>
    </tr>
    <tr>
      <th>V30</th>
      <td>76073</td>
      <td>12.881939</td>
    </tr>
    <tr>
      <th>V29</th>
      <td>76073</td>
      <td>12.881939</td>
    </tr>
    <tr>
      <th>V28</th>
      <td>76073</td>
      <td>12.881939</td>
    </tr>
    <tr>
      <th>V27</th>
      <td>76073</td>
      <td>12.881939</td>
    </tr>
    <tr>
      <th>V25</th>
      <td>76073</td>
      <td>12.881939</td>
    </tr>
    <tr>
      <th>V24</th>
      <td>76073</td>
      <td>12.881939</td>
    </tr>
    <tr>
      <th>V26</th>
      <td>76073</td>
      <td>12.881939</td>
    </tr>
    <tr>
      <th>V16</th>
      <td>76073</td>
      <td>12.881939</td>
    </tr>
    <tr>
      <th>V15</th>
      <td>76073</td>
      <td>12.881939</td>
    </tr>
    <tr>
      <th>V20</th>
      <td>76073</td>
      <td>12.881939</td>
    </tr>
    <tr>
      <th>V14</th>
      <td>76073</td>
      <td>12.881939</td>
    </tr>
    <tr>
      <th>V19</th>
      <td>76073</td>
      <td>12.881939</td>
    </tr>
    <tr>
      <th>V18</th>
      <td>76073</td>
      <td>12.881939</td>
    </tr>
    <tr>
      <th>V17</th>
      <td>76073</td>
      <td>12.881939</td>
    </tr>
    <tr>
      <th>V12</th>
      <td>76073</td>
      <td>12.881939</td>
    </tr>
    <tr>
      <th>V13</th>
      <td>76073</td>
      <td>12.881939</td>
    </tr>
    <tr>
      <th>D10</th>
      <td>76022</td>
      <td>12.873302</td>
    </tr>
    <tr>
      <th>addr1</th>
      <td>65706</td>
      <td>11.126427</td>
    </tr>
    <tr>
      <th>addr2</th>
      <td>65706</td>
      <td>11.126427</td>
    </tr>
    <tr>
      <th>card2</th>
      <td>8933</td>
      <td>1.512683</td>
    </tr>
    <tr>
      <th>card5</th>
      <td>4259</td>
      <td>0.721204</td>
    </tr>
    <tr>
      <th>card4</th>
      <td>1577</td>
      <td>0.267044</td>
    </tr>
    <tr>
      <th>card6</th>
      <td>1571</td>
      <td>0.266028</td>
    </tr>
    <tr>
      <th>card3</th>
      <td>1565</td>
      <td>0.265012</td>
    </tr>
    <tr>
      <th>V296</th>
      <td>1269</td>
      <td>0.214888</td>
    </tr>
    <tr>
      <th>V289</th>
      <td>1269</td>
      <td>0.214888</td>
    </tr>
    <tr>
      <th>V288</th>
      <td>1269</td>
      <td>0.214888</td>
    </tr>
    <tr>
      <th>V283</th>
      <td>1269</td>
      <td>0.214888</td>
    </tr>
    <tr>
      <th>V282</th>
      <td>1269</td>
      <td>0.214888</td>
    </tr>
    <tr>
      <th>V281</th>
      <td>1269</td>
      <td>0.214888</td>
    </tr>
    <tr>
      <th>V300</th>
      <td>1269</td>
      <td>0.214888</td>
    </tr>
    <tr>
      <th>V301</th>
      <td>1269</td>
      <td>0.214888</td>
    </tr>
    <tr>
      <th>V313</th>
      <td>1269</td>
      <td>0.214888</td>
    </tr>
    <tr>
      <th>V314</th>
      <td>1269</td>
      <td>0.214888</td>
    </tr>
    <tr>
      <th>V315</th>
      <td>1269</td>
      <td>0.214888</td>
    </tr>
    <tr>
      <th>D1</th>
      <td>1269</td>
      <td>0.214888</td>
    </tr>
    <tr>
      <th>V104</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V109</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V110</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V111</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V112</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V106</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V105</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V102</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V103</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V96</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V101</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V100</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V99</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V98</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V97</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V95</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V135</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V134</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V107</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V133</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V132</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variables con más valores faltantes:&quot;</span><span class="p">)</span>
<span class="c1"># display(train_df.describe().T.iloc[361:403])</span>
<span class="n">display</span><span class="p">(</span><span class="n">missing_df</span><span class="p">[</span><span class="n">missing_df</span><span class="p">[</span><span class="s1">&#39;Total_Faltantes&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">361</span><span class="p">:</span><span class="mi">403</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variables con más valores faltantes:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Total_Faltantes</th>
      <th>Porcentaje</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>V130</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V129</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V128</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V127</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V126</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V125</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V124</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V123</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V122</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V121</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V120</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V119</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V118</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V117</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V116</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V115</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V114</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V113</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V136</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V137</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V108</th>
      <td>314</td>
      <td>0.053172</td>
    </tr>
    <tr>
      <th>V311</th>
      <td>12</td>
      <td>0.002032</td>
    </tr>
    <tr>
      <th>V321</th>
      <td>12</td>
      <td>0.002032</td>
    </tr>
    <tr>
      <th>V294</th>
      <td>12</td>
      <td>0.002032</td>
    </tr>
    <tr>
      <th>V306</th>
      <td>12</td>
      <td>0.002032</td>
    </tr>
    <tr>
      <th>V305</th>
      <td>12</td>
      <td>0.002032</td>
    </tr>
    <tr>
      <th>V304</th>
      <td>12</td>
      <td>0.002032</td>
    </tr>
    <tr>
      <th>V303</th>
      <td>12</td>
      <td>0.002032</td>
    </tr>
    <tr>
      <th>V302</th>
      <td>12</td>
      <td>0.002032</td>
    </tr>
    <tr>
      <th>V299</th>
      <td>12</td>
      <td>0.002032</td>
    </tr>
    <tr>
      <th>V298</th>
      <td>12</td>
      <td>0.002032</td>
    </tr>
    <tr>
      <th>V297</th>
      <td>12</td>
      <td>0.002032</td>
    </tr>
    <tr>
      <th>V295</th>
      <td>12</td>
      <td>0.002032</td>
    </tr>
    <tr>
      <th>V293</th>
      <td>12</td>
      <td>0.002032</td>
    </tr>
    <tr>
      <th>V308</th>
      <td>12</td>
      <td>0.002032</td>
    </tr>
    <tr>
      <th>V292</th>
      <td>12</td>
      <td>0.002032</td>
    </tr>
    <tr>
      <th>V291</th>
      <td>12</td>
      <td>0.002032</td>
    </tr>
    <tr>
      <th>V290</th>
      <td>12</td>
      <td>0.002032</td>
    </tr>
    <tr>
      <th>V287</th>
      <td>12</td>
      <td>0.002032</td>
    </tr>
    <tr>
      <th>V286</th>
      <td>12</td>
      <td>0.002032</td>
    </tr>
    <tr>
      <th>V285</th>
      <td>12</td>
      <td>0.002032</td>
    </tr>
    <tr>
      <th>V284</th>
      <td>12</td>
      <td>0.002032</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Crear el gráfico a partir del DataFrame `missing_df` ya calculado</span>
<span class="n">top_missing</span> <span class="o">=</span> <span class="n">missing_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>  <span class="c1"># Top 60 variables con más valores faltantes</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">top_missing</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">top_missing</span><span class="p">[</span><span class="s1">&#39;Porcentaje&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Porcentaje de Valores Faltantes (%)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Top 60 Variables con Mayor Porcentaje de Valores Faltantes&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7c2460f9ff707f2c33c6674388ea31908b569923830a9e7c2f10b62a43f2c1f8.png" src="../_images/7c2460f9ff707f2c33c6674388ea31908b569923830a9e7c2f10b62a43f2c1f8.png" />
</div>
</div>
<ol class="arabic simple">
<li><p>Variables con &gt;99% de valores faltantes</p></li>
</ol>
<p>id_24, id_25	~99.2%	Casi completamente vacías. Eliminación recomendada.</p>
<p>id_07 a id_27	~99.1%	Información casi ausente de identidad/dispositivo. Salvo que sean críticas, deben eliminarse.</p>
<ul class="simple">
<li><p>Interpretación: Estas variables están prácticamente vacías. Aunque podrían ser importantes en contextos particulares (ej: para ciertos emisores), el costo de imputarlas sería muy alto y su calidad baja → candidatas para eliminación.</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p>Variables con entre 85% y 99% de valores faltantes</p></li>
</ol>
<p>Variables de identidad y temporales:</p>
<p>id_03–id_04, id_09–id_14, id_30–id_34</p>
<p>D6, D7, D8, D9, D12–D14</p>
<ul class="simple">
<li><p>Interpretación: Muchas de estas variables miden intervalos de tiempo entre eventos (D#) o características específicas de usuarios (id_#). Si bien están incompletas, pueden ser valiosas: los pocos valores que tienen podrían detectar patrones únicos de fraude (como recurrencia temporal).
Se consevarán temporalmente y se evaluará su importancia con feature importance o modelos de prueba. Si no aportan, se eliminaran más adelante.</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p>Variables V (V138–V166), altamente faltantes:</p></li>
</ol>
<p>Variables destacadas	% Faltantes	Observaciones</p>
<p>V140–V166	~86.1%	Sparse, con valores extremos → posibles outliers.</p>
<p>V153–V160, V138–V149	~86.1%	Muchas tienen distribución tipo flag o score.</p>
<p>V333–V337, V335	~86.05%	Valores extremadamente altos → riesgo de ruido.</p>
<ul class="simple">
<li><p>Interpretación: Aunque faltantes, estas variables de Vesta fueron diseñadas para capturar picos de comportamiento y señales de riesgo. Dado que son variables técnicas y posiblemente muy predictivas, se revisará si se pueden imputar.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variables sin  valores faltantes:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">missing_df</span><span class="p">[</span><span class="n">missing_df</span><span class="p">[</span><span class="s1">&#39;Total_Faltantes&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">60</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variables sin  valores faltantes:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Total_Faltantes</th>
      <th>Porcentaje</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>C9</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C14</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C13</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C12</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C11</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C10</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>TransactionDT</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>TransactionAmt</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>ProductCD</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C6</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>card1</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C8</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C7</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C5</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C4</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C3</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C2</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C1</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>isFraud</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>TransactionID</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Estas variables están completamente disponibles, es decir, no requieren imputación ni tratamiento de valores nulos. Esto las convierte en candidatas para ser incluidas directamente en el modelado inicial.</p>
<ul class="simple">
<li><p>Variables de transacción: Estas variables son claves para detectar patrones como hora del fraude, montos sospechosos o productos vulnerables. TransactionAmt y TransactionDT deberían usarse tanto en bruto como transformadas (log, horas, bins, etc.)</p></li>
<li><p>Variable objetivo - isFraud: es la variable binaria que se debe utilizar como target en todos los modelos supervisados.</p></li>
<li><p>Variables C1-C14 (características codificadas de recuento): Estas variables representan recuentos agregados de usuarios, tarjetas o direcciones. Dado que no tienen faltantes, pueden incluirse directamente y evaluarse mediante análisis de importancia o correlación.</p></li>
<li><p>Variable card1: candidata directa al modelo, aunque si el cardinal es alto podría requerir encoding.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Seleccionar columnas numéricas</span>
<span class="n">numeric_cols</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;number&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>

<span class="c1"># Conservar solo columnas SIN nulos</span>
<span class="n">complete_numeric_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">numeric_cols</span> <span class="k">if</span> <span class="n">train_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>

<span class="c1"># Crear DataFrame solo con esas columnas completas</span>
<span class="n">numeric_df</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="n">complete_numeric_cols</span><span class="p">]</span>
<span class="n">numeric_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TransactionID</th>
      <th>isFraud</th>
      <th>TransactionDT</th>
      <th>TransactionAmt</th>
      <th>card1</th>
      <th>C1</th>
      <th>C2</th>
      <th>C3</th>
      <th>C4</th>
      <th>C5</th>
      <th>C6</th>
      <th>C7</th>
      <th>C8</th>
      <th>C9</th>
      <th>C10</th>
      <th>C11</th>
      <th>C12</th>
      <th>C13</th>
      <th>C14</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2987000</td>
      <td>0</td>
      <td>86400</td>
      <td>68.50</td>
      <td>13926</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2987001</td>
      <td>0</td>
      <td>86401</td>
      <td>29.00</td>
      <td>2755</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2987002</td>
      <td>0</td>
      <td>86469</td>
      <td>59.00</td>
      <td>4663</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2987003</td>
      <td>0</td>
      <td>86499</td>
      <td>50.00</td>
      <td>18132</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>25.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2987004</td>
      <td>0</td>
      <td>86506</td>
      <td>50.00</td>
      <td>4497</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>590535</th>
      <td>3577535</td>
      <td>0</td>
      <td>15811047</td>
      <td>49.00</td>
      <td>6550</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>590536</th>
      <td>3577536</td>
      <td>0</td>
      <td>15811049</td>
      <td>39.50</td>
      <td>10444</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>590537</th>
      <td>3577537</td>
      <td>0</td>
      <td>15811079</td>
      <td>30.95</td>
      <td>12037</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>590538</th>
      <td>3577538</td>
      <td>0</td>
      <td>15811088</td>
      <td>117.00</td>
      <td>7826</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>590539</th>
      <td>3577539</td>
      <td>0</td>
      <td>15811131</td>
      <td>279.95</td>
      <td>15066</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>590540 rows × 19 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estandarizar los datos para el cálculo de VIF</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">numeric_df</span><span class="p">)</span>
<span class="n">X_scaled_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">complete_numeric_cols</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Función de reducción iterativa basada en VIF</span>
<span class="k">def</span><span class="w"> </span><span class="nf">reduce_vif</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">10.0</span><span class="p">):</span>
    <span class="n">variables</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">vif</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
            <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="n">variables</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">variables</span><span class="p">))],</span>
            <span class="n">index</span><span class="o">=</span><span class="n">variables</span>
        <span class="p">)</span>
        <span class="n">max_vif</span> <span class="o">=</span> <span class="n">vif</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">max_vif</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">drop_var</span> <span class="o">=</span> <span class="n">vif</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
        <span class="n">variables</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">drop_var</span><span class="p">)</span>
    <span class="n">final_vif</span> <span class="o">=</span> <span class="n">vif</span><span class="p">[</span><span class="n">variables</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">dataframe</span><span class="p">[</span><span class="n">variables</span><span class="p">],</span> <span class="n">final_vif</span>

<span class="c1"># Reducir multicolinealidad</span>
<span class="n">reduced_df</span><span class="p">,</span> <span class="n">final_vif_series</span> <span class="o">=</span> <span class="n">reduce_vif</span><span class="p">(</span><span class="n">X_scaled_df</span><span class="p">)</span>

<span class="c1"># Mostrar resultado</span>
<span class="n">final_vif_df</span> <span class="o">=</span> <span class="n">final_vif_series</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">final_vif_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Variable&#39;</span><span class="p">,</span> <span class="s1">&#39;VIF&#39;</span><span class="p">]</span>
<span class="n">final_vif_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable</th>
      <th>VIF</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C3</td>
      <td>1.000264</td>
    </tr>
    <tr>
      <th>1</th>
      <td>card1</td>
      <td>1.000439</td>
    </tr>
    <tr>
      <th>2</th>
      <td>TransactionAmt</td>
      <td>1.001639</td>
    </tr>
    <tr>
      <th>3</th>
      <td>isFraud</td>
      <td>1.002402</td>
    </tr>
    <tr>
      <th>4</th>
      <td>TransactionDT</td>
      <td>1.005310</td>
    </tr>
    <tr>
      <th>5</th>
      <td>C7</td>
      <td>4.170043</td>
    </tr>
    <tr>
      <th>6</th>
      <td>C14</td>
      <td>4.955245</td>
    </tr>
    <tr>
      <th>7</th>
      <td>C5</td>
      <td>7.022934</td>
    </tr>
    <tr>
      <th>8</th>
      <td>C9</td>
      <td>7.591036</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="imputacion-de-datos-faltantes-variables-numericas">
<h2>Imputación  de datos faltantes variables numericas<a class="headerlink" href="#imputacion-de-datos-faltantes-variables-numericas" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Seleccionar variables numéricas con ≤ 95% de valores faltantes</span>
<span class="n">numeric_cols</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;number&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
<span class="n">missing_pct</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="n">numeric_cols</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">filtered_cols</span> <span class="o">=</span> <span class="n">missing_pct</span><span class="p">[</span><span class="n">missing_pct</span> <span class="o">&lt;=</span> <span class="mf">0.95</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Subset del DataFrame original con esas columnas</span>
<span class="n">subset_df</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="n">filtered_cols</span><span class="p">]</span>

<span class="c1"># Aplicar imputación con la mediana</span>
<span class="n">imputer</span> <span class="o">=</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;median&#39;</span><span class="p">)</span>
<span class="n">subset_imputed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">imputer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">subset_df</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">filtered_cols</span><span class="p">)</span>
<span class="n">subset_imputed</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TransactionID</th>
      <th>isFraud</th>
      <th>TransactionDT</th>
      <th>TransactionAmt</th>
      <th>card1</th>
      <th>card2</th>
      <th>card3</th>
      <th>card5</th>
      <th>addr1</th>
      <th>addr2</th>
      <th>...</th>
      <th>id_09</th>
      <th>id_10</th>
      <th>id_11</th>
      <th>id_13</th>
      <th>id_14</th>
      <th>id_17</th>
      <th>id_18</th>
      <th>id_19</th>
      <th>id_20</th>
      <th>id_32</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2987000.0</td>
      <td>0.0</td>
      <td>86400.0</td>
      <td>68.50</td>
      <td>13926.0</td>
      <td>361.0</td>
      <td>150.0</td>
      <td>142.0</td>
      <td>315.0</td>
      <td>87.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>52.0</td>
      <td>-300.0</td>
      <td>166.0</td>
      <td>15.0</td>
      <td>341.0</td>
      <td>472.0</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2987001.0</td>
      <td>0.0</td>
      <td>86401.0</td>
      <td>29.00</td>
      <td>2755.0</td>
      <td>404.0</td>
      <td>150.0</td>
      <td>102.0</td>
      <td>325.0</td>
      <td>87.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>52.0</td>
      <td>-300.0</td>
      <td>166.0</td>
      <td>15.0</td>
      <td>341.0</td>
      <td>472.0</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2987002.0</td>
      <td>0.0</td>
      <td>86469.0</td>
      <td>59.00</td>
      <td>4663.0</td>
      <td>490.0</td>
      <td>150.0</td>
      <td>166.0</td>
      <td>330.0</td>
      <td>87.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>52.0</td>
      <td>-300.0</td>
      <td>166.0</td>
      <td>15.0</td>
      <td>341.0</td>
      <td>472.0</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2987003.0</td>
      <td>0.0</td>
      <td>86499.0</td>
      <td>50.00</td>
      <td>18132.0</td>
      <td>567.0</td>
      <td>150.0</td>
      <td>117.0</td>
      <td>476.0</td>
      <td>87.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>52.0</td>
      <td>-300.0</td>
      <td>166.0</td>
      <td>15.0</td>
      <td>341.0</td>
      <td>472.0</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2987004.0</td>
      <td>0.0</td>
      <td>86506.0</td>
      <td>50.00</td>
      <td>4497.0</td>
      <td>514.0</td>
      <td>150.0</td>
      <td>102.0</td>
      <td>420.0</td>
      <td>87.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>52.0</td>
      <td>-480.0</td>
      <td>166.0</td>
      <td>15.0</td>
      <td>542.0</td>
      <td>144.0</td>
      <td>32.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>590535</th>
      <td>3577535.0</td>
      <td>0.0</td>
      <td>15811047.0</td>
      <td>49.00</td>
      <td>6550.0</td>
      <td>361.0</td>
      <td>150.0</td>
      <td>226.0</td>
      <td>272.0</td>
      <td>87.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>52.0</td>
      <td>-300.0</td>
      <td>166.0</td>
      <td>15.0</td>
      <td>341.0</td>
      <td>472.0</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>590536</th>
      <td>3577536.0</td>
      <td>0.0</td>
      <td>15811049.0</td>
      <td>39.50</td>
      <td>10444.0</td>
      <td>225.0</td>
      <td>150.0</td>
      <td>224.0</td>
      <td>204.0</td>
      <td>87.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>52.0</td>
      <td>-300.0</td>
      <td>166.0</td>
      <td>15.0</td>
      <td>341.0</td>
      <td>472.0</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>590537</th>
      <td>3577537.0</td>
      <td>0.0</td>
      <td>15811079.0</td>
      <td>30.95</td>
      <td>12037.0</td>
      <td>595.0</td>
      <td>150.0</td>
      <td>224.0</td>
      <td>231.0</td>
      <td>87.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>52.0</td>
      <td>-300.0</td>
      <td>166.0</td>
      <td>15.0</td>
      <td>341.0</td>
      <td>472.0</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>590538</th>
      <td>3577538.0</td>
      <td>0.0</td>
      <td>15811088.0</td>
      <td>117.00</td>
      <td>7826.0</td>
      <td>481.0</td>
      <td>150.0</td>
      <td>224.0</td>
      <td>387.0</td>
      <td>87.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>52.0</td>
      <td>-300.0</td>
      <td>166.0</td>
      <td>15.0</td>
      <td>341.0</td>
      <td>472.0</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>590539</th>
      <td>3577539.0</td>
      <td>0.0</td>
      <td>15811131.0</td>
      <td>279.95</td>
      <td>15066.0</td>
      <td>170.0</td>
      <td>150.0</td>
      <td>102.0</td>
      <td>299.0</td>
      <td>87.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>52.0</td>
      <td>-300.0</td>
      <td>166.0</td>
      <td>15.0</td>
      <td>341.0</td>
      <td>472.0</td>
      <td>24.0</td>
    </tr>
  </tbody>
</table>
<p>590540 rows × 396 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">faltantes_subset_imputed</span> <span class="o">=</span> <span class="n">subset_imputed</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">faltantes_subset_imputed</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TransactionID     0
isFraud           0
TransactionDT     0
TransactionAmt    0
card1             0
card2             0
card3             0
card5             0
addr1             0
addr2             0
dist1             0
dist2             0
C1                0
C2                0
C3                0
C4                0
C5                0
C6                0
C7                0
C8                0
C9                0
C10               0
C11               0
C12               0
C13               0
C14               0
D1                0
D2                0
D3                0
D4                0
dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="implementacion-de-variance-inflation-factor-vif">
<h2>Implementación de Variance Inflation Factor (VIF)<a class="headerlink" href="#implementacion-de-variance-inflation-factor-vif" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vif_selected_cols</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tomar un bloque</span>
<span class="n">block_cols</span> <span class="o">=</span> <span class="n">subset_imputed</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">66</span><span class="p">]</span>  <span class="c1"># Cambiar el rango en cada celda</span>

<span class="n">X_block</span> <span class="o">=</span> <span class="n">subset_imputed</span><span class="p">[</span><span class="n">block_cols</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_block</span><span class="p">)</span>
<span class="n">X_scaled_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">block_cols</span><span class="p">)</span>

<span class="c1"># Eliminar variables con VIF &gt;= 10</span>
<span class="n">variables</span> <span class="o">=</span> <span class="n">X_scaled_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">vif</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X_scaled_df</span><span class="p">[</span><span class="n">variables</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">variables</span><span class="p">))],</span> <span class="n">index</span><span class="o">=</span><span class="n">variables</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">vif</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="n">drop_var</span> <span class="o">=</span> <span class="n">vif</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
    <span class="n">variables</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">drop_var</span><span class="p">)</span>

<span class="c1"># Guardar las variables válidas</span>
<span class="n">vif_selected_cols</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>
<span class="n">vif_selected_cols</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;isFraud&#39;,
 &#39;TransactionDT&#39;,
 &#39;TransactionAmt&#39;,
 &#39;card1&#39;,
 &#39;card2&#39;,
 &#39;card3&#39;,
 &#39;card5&#39;,
 &#39;addr1&#39;,
 &#39;addr2&#39;,
 &#39;dist1&#39;,
 &#39;dist2&#39;,
 &#39;C3&#39;,
 &#39;C5&#39;,
 &#39;C7&#39;,
 &#39;C9&#39;,
 &#39;C14&#39;,
 &#39;D1&#39;,
 &#39;D2&#39;,
 &#39;D3&#39;,
 &#39;D4&#39;,
 &#39;D5&#39;,
 &#39;D6&#39;,
 &#39;D7&#39;,
 &#39;D8&#39;,
 &#39;D9&#39;,
 &#39;D10&#39;,
 &#39;D11&#39;,
 &#39;D12&#39;,
 &#39;D13&#39;,
 &#39;D14&#39;,
 &#39;D15&#39;,
 &#39;V1&#39;,
 &#39;V2&#39;,
 &#39;V3&#39;,
 &#39;V4&#39;,
 &#39;V5&#39;,
 &#39;V6&#39;,
 &#39;V7&#39;,
 &#39;V8&#39;,
 &#39;V9&#39;,
 &#39;V11&#39;,
 &#39;V12&#39;,
 &#39;V13&#39;,
 &#39;V14&#39;,
 &#39;V16&#39;,
 &#39;V18&#39;,
 &#39;V19&#39;,
 &#39;V20&#39;,
 &#39;V22&#39;,
 &#39;V23&#39;,
 &#39;V24&#39;,
 &#39;V25&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">3</span><span class="p">:</span><span class="mi">25</span> <span class="o">-</span> <span class="mi">4</span><span class="p">:</span><span class="mi">25</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tomar un bloque</span>
<span class="n">block_cols</span> <span class="o">=</span> <span class="n">subset_imputed</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">67</span><span class="p">:</span><span class="mi">132</span><span class="p">]</span>  <span class="c1"># Cambiar el rango en cada celda</span>

<span class="n">X_block</span> <span class="o">=</span> <span class="n">subset_imputed</span><span class="p">[</span><span class="n">block_cols</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_block</span><span class="p">)</span>
<span class="n">X_scaled_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">block_cols</span><span class="p">)</span>

<span class="c1"># Eliminar variables con VIF &gt;= 10</span>
<span class="n">variables</span> <span class="o">=</span> <span class="n">X_scaled_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">vif</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X_scaled_df</span><span class="p">[</span><span class="n">variables</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">variables</span><span class="p">))],</span> <span class="n">index</span><span class="o">=</span><span class="n">variables</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">vif</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="n">drop_var</span> <span class="o">=</span> <span class="n">vif</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
    <span class="n">variables</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">drop_var</span><span class="p">)</span>

<span class="c1"># Guardar las variables válidas</span>
<span class="n">vif_selected_cols</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>
<span class="n">vif_selected_cols</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;isFraud&#39;,
 &#39;TransactionDT&#39;,
 &#39;TransactionAmt&#39;,
 &#39;card1&#39;,
 &#39;card2&#39;,
 &#39;card3&#39;,
 &#39;card5&#39;,
 &#39;addr1&#39;,
 &#39;addr2&#39;,
 &#39;dist1&#39;,
 &#39;dist2&#39;,
 &#39;C3&#39;,
 &#39;C5&#39;,
 &#39;C7&#39;,
 &#39;C9&#39;,
 &#39;C14&#39;,
 &#39;D1&#39;,
 &#39;D2&#39;,
 &#39;D3&#39;,
 &#39;D4&#39;,
 &#39;D5&#39;,
 &#39;D6&#39;,
 &#39;D7&#39;,
 &#39;D8&#39;,
 &#39;D9&#39;,
 &#39;D10&#39;,
 &#39;D11&#39;,
 &#39;D12&#39;,
 &#39;D13&#39;,
 &#39;D14&#39;,
 &#39;D15&#39;,
 &#39;V1&#39;,
 &#39;V2&#39;,
 &#39;V3&#39;,
 &#39;V4&#39;,
 &#39;V5&#39;,
 &#39;V6&#39;,
 &#39;V7&#39;,
 &#39;V8&#39;,
 &#39;V9&#39;,
 &#39;V11&#39;,
 &#39;V12&#39;,
 &#39;V13&#39;,
 &#39;V14&#39;,
 &#39;V16&#39;,
 &#39;V18&#39;,
 &#39;V19&#39;,
 &#39;V20&#39;,
 &#39;V22&#39;,
 &#39;V23&#39;,
 &#39;V24&#39;,
 &#39;V25&#39;,
 &#39;V27&#39;,
 &#39;V29&#39;,
 &#39;V32&#39;,
 &#39;V34&#39;,
 &#39;V35&#39;,
 &#39;V37&#39;,
 &#39;V38&#39;,
 &#39;V40&#39;,
 &#39;V41&#39;,
 &#39;V43&#39;,
 &#39;V44&#39;,
 &#39;V46&#39;,
 &#39;V47&#39;,
 &#39;V49&#39;,
 &#39;V52&#39;,
 &#39;V53&#39;,
 &#39;V55&#39;,
 &#39;V56&#39;,
 &#39;V60&#39;,
 &#39;V61&#39;,
 &#39;V62&#39;,
 &#39;V64&#39;,
 &#39;V65&#39;,
 &#39;V66&#39;,
 &#39;V67&#39;,
 &#39;V68&#39;,
 &#39;V70&#39;,
 &#39;V74&#39;,
 &#39;V75&#39;,
 &#39;V76&#39;,
 &#39;V77&#39;,
 &#39;V78&#39;,
 &#39;V79&#39;,
 &#39;V80&#39;,
 &#39;V82&#39;,
 &#39;V83&#39;,
 &#39;V85&#39;,
 &#39;V86&#39;,
 &#39;V87&#39;,
 &#39;V88&#39;,
 &#39;V89&#39;,
 &#39;V91&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tomar un bloque</span>
<span class="n">block_cols</span> <span class="o">=</span> <span class="n">subset_imputed</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">133</span><span class="p">:</span><span class="mi">199</span><span class="p">]</span>  <span class="c1"># Cambiar el rango en cada celda</span>

<span class="n">X_block</span> <span class="o">=</span> <span class="n">subset_imputed</span><span class="p">[</span><span class="n">block_cols</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_block</span><span class="p">)</span>
<span class="n">X_scaled_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">block_cols</span><span class="p">)</span>

<span class="c1"># Eliminar variables con VIF &gt;= 10</span>
<span class="n">variables</span> <span class="o">=</span> <span class="n">X_scaled_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">vif</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X_scaled_df</span><span class="p">[</span><span class="n">variables</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">variables</span><span class="p">))],</span> <span class="n">index</span><span class="o">=</span><span class="n">variables</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">vif</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="n">drop_var</span> <span class="o">=</span> <span class="n">vif</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
    <span class="n">variables</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">drop_var</span><span class="p">)</span>

<span class="c1"># Guardar las variables válidas</span>
<span class="n">vif_selected_cols</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>

<span class="c1"># Ver VIF de las columnas que quedaron</span>
<span class="n">final_vif</span> <span class="o">=</span> <span class="n">vif</span><span class="p">[</span><span class="n">variables</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
<span class="n">final_vif</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>V138    1.659009
V98     1.864587
V107    2.035538
V121    2.703271
V104    2.869434
V143    2.983377
V139    3.197059
V112    3.236291
V118    3.399283
V93     3.502572
V94     3.504379
V129    3.686698
V109    3.760020
V144    4.015608
V115    4.115738
V130    4.272185
V114    4.353837
V111    4.391363
V124    4.556678
V135    4.581669
V142    4.583553
V152    4.719987
V120    4.851132
V123    5.218288
V141    5.348912
V122    5.491571
V110    5.498297
V99     5.715833
V108    6.012980
V154    6.278436
V100    7.161151
V157    7.288001
V131    7.452064
V125    7.510261
V117    7.933902
V119    8.268728
V147    8.296961
V136    8.618572
V146    9.497666
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tomar un bloque</span>
<span class="n">block_cols</span> <span class="o">=</span> <span class="n">subset_imputed</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">266</span><span class="p">]</span>  <span class="c1"># Cambiar el rango en cada celda</span>

<span class="n">X_block</span> <span class="o">=</span> <span class="n">subset_imputed</span><span class="p">[</span><span class="n">block_cols</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_block</span><span class="p">)</span>
<span class="n">X_scaled_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">block_cols</span><span class="p">)</span>

<span class="c1"># Eliminar variables con VIF &gt;= 10</span>
<span class="n">variables</span> <span class="o">=</span> <span class="n">X_scaled_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">vif</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X_scaled_df</span><span class="p">[</span><span class="n">variables</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">variables</span><span class="p">))],</span> <span class="n">index</span><span class="o">=</span><span class="n">variables</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">vif</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="n">drop_var</span> <span class="o">=</span> <span class="n">vif</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
    <span class="n">variables</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">drop_var</span><span class="p">)</span>

<span class="c1"># Guardar las variables válidas</span>
<span class="n">vif_selected_cols</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>

<span class="c1"># Ver VIF de las columnas que quedaron</span>
<span class="n">final_vif</span> <span class="o">=</span> <span class="n">vif</span><span class="p">[</span><span class="n">variables</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
<span class="n">final_vif</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>V206    1.062627
V221    1.326878
V217    1.540337
V220    2.090142
V224    2.187630
V208    2.190602
V184    2.308657
V173    2.449704
V214    2.469560
V187    2.674020
V164    2.792220
V169    2.864874
V160    2.892784
V188    3.298046
V209    3.302804
V223    3.579242
V198    3.743097
V166    4.250178
V162    4.985811
V174    5.313068
V161    5.456369
V170    5.542130
V181    5.610370
V172    6.243704
V176    6.456050
V194    6.823013
V201    6.992075
V175    7.924796
V197    8.978615
V199    9.876015
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tomar un bloque</span>
<span class="n">block_cols</span> <span class="o">=</span> <span class="n">subset_imputed</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">267</span><span class="p">:</span><span class="mi">330</span><span class="p">]</span>  <span class="c1"># Cambiar el rango en cada celda</span>

<span class="n">X_block</span> <span class="o">=</span> <span class="n">subset_imputed</span><span class="p">[</span><span class="n">block_cols</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_block</span><span class="p">)</span>
<span class="n">X_scaled_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">block_cols</span><span class="p">)</span>

<span class="c1"># Eliminar variables con VIF &gt;= 10</span>
<span class="n">variables</span> <span class="o">=</span> <span class="n">X_scaled_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">vif</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X_scaled_df</span><span class="p">[</span><span class="n">variables</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">variables</span><span class="p">))],</span> <span class="n">index</span><span class="o">=</span><span class="n">variables</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">vif</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="n">drop_var</span> <span class="o">=</span> <span class="n">vif</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
    <span class="n">variables</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">drop_var</span><span class="p">)</span>

<span class="c1"># Guardar las variables válidas</span>
<span class="n">vif_selected_cols</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>

<span class="c1"># Ver VIF de las columnas que quedaron</span>
<span class="n">final_vif</span> <span class="o">=</span> <span class="n">vif</span><span class="p">[</span><span class="n">variables</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
<span class="n">final_vif</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>V234    1.536304
V286    1.592661
V281    2.129453
V250    2.162217
V241    2.247434
V269    2.289494
V240    2.294727
V284    2.372280
V228    2.643642
V238    2.796147
V283    2.881142
V260    3.061387
V282    3.141750
V244    3.393767
V285    3.547246
V247    4.243113
V252    4.245778
V235    4.396083
V287    4.534993
V257    4.555646
V277    5.103895
V267    5.455447
V288    6.019064
V289    6.422247
V231    6.994886
V227    7.083313
V270    7.154355
V271    7.308091
V279    7.755032
V262    8.411379
V261    8.568753
V280    8.709746
V263    9.700368
V259    9.773392
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tomar un bloque</span>
<span class="n">block_cols</span> <span class="o">=</span> <span class="n">subset_imputed</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">331</span><span class="p">:</span><span class="mi">396</span><span class="p">]</span>  <span class="c1"># Cambiar el rango en cada celda</span>

<span class="n">X_block</span> <span class="o">=</span> <span class="n">subset_imputed</span><span class="p">[</span><span class="n">block_cols</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_block</span><span class="p">)</span>
<span class="n">X_scaled_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">block_cols</span><span class="p">)</span>

<span class="c1"># Eliminar variables con VIF &gt;= 10</span>
<span class="n">variables</span> <span class="o">=</span> <span class="n">X_scaled_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">vif</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X_scaled_df</span><span class="p">[</span><span class="n">variables</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">variables</span><span class="p">))],</span> <span class="n">index</span><span class="o">=</span><span class="n">variables</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">vif</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="n">drop_var</span> <span class="o">=</span> <span class="n">vif</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
    <span class="n">variables</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">drop_var</span><span class="p">)</span>

<span class="c1"># Guardar las variables válidas</span>
<span class="n">vif_selected_cols</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>

<span class="c1"># Ver VIF de las columnas que quedaron</span>
<span class="n">final_vif</span> <span class="o">=</span> <span class="n">vif</span><span class="p">[</span><span class="n">variables</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
<span class="n">final_vif</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>V305     1.000021
id_13    1.071821
id_11    1.079126
id_19    1.086270
id_18    1.174808
id_01    1.211830
id_04    1.213003
id_10    1.251667
id_14    1.272417
V291     1.276744
id_05    1.281570
id_32    1.317660
id_02    1.329812
id_20    1.340535
id_06    1.361256
V325     1.603788
V337     1.626625
id_03    1.642178
V319     1.651538
id_09    1.655450
id_17    2.120777
V310     2.552036
V313     2.647994
V314     2.756713
V293     3.248799
V326     3.357633
V334     3.595379
V312     4.287829
V328     5.232284
V297     5.457074
V296     5.550280
V311     6.094067
V309     6.678295
V303     6.883308
V302     7.100513
V301     7.374564
V300     7.552507
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vif_selected_cols</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;isFraud&#39;,
 &#39;TransactionDT&#39;,
 &#39;TransactionAmt&#39;,
 &#39;card1&#39;,
 &#39;card2&#39;,
 &#39;card3&#39;,
 &#39;card5&#39;,
 &#39;addr1&#39;,
 &#39;addr2&#39;,
 &#39;dist1&#39;,
 &#39;dist2&#39;,
 &#39;C3&#39;,
 &#39;C5&#39;,
 &#39;C7&#39;,
 &#39;C9&#39;,
 &#39;C14&#39;,
 &#39;D1&#39;,
 &#39;D2&#39;,
 &#39;D3&#39;,
 &#39;D4&#39;,
 &#39;D5&#39;,
 &#39;D6&#39;,
 &#39;D7&#39;,
 &#39;D8&#39;,
 &#39;D9&#39;,
 &#39;D10&#39;,
 &#39;D11&#39;,
 &#39;D12&#39;,
 &#39;D13&#39;,
 &#39;D14&#39;,
 &#39;D15&#39;,
 &#39;V1&#39;,
 &#39;V2&#39;,
 &#39;V3&#39;,
 &#39;V4&#39;,
 &#39;V5&#39;,
 &#39;V6&#39;,
 &#39;V7&#39;,
 &#39;V8&#39;,
 &#39;V9&#39;,
 &#39;V11&#39;,
 &#39;V12&#39;,
 &#39;V13&#39;,
 &#39;V14&#39;,
 &#39;V16&#39;,
 &#39;V18&#39;,
 &#39;V19&#39;,
 &#39;V20&#39;,
 &#39;V22&#39;,
 &#39;V23&#39;,
 &#39;V24&#39;,
 &#39;V25&#39;,
 &#39;V27&#39;,
 &#39;V29&#39;,
 &#39;V32&#39;,
 &#39;V34&#39;,
 &#39;V35&#39;,
 &#39;V37&#39;,
 &#39;V38&#39;,
 &#39;V40&#39;,
 &#39;V41&#39;,
 &#39;V43&#39;,
 &#39;V44&#39;,
 &#39;V46&#39;,
 &#39;V47&#39;,
 &#39;V49&#39;,
 &#39;V52&#39;,
 &#39;V53&#39;,
 &#39;V55&#39;,
 &#39;V56&#39;,
 &#39;V60&#39;,
 &#39;V61&#39;,
 &#39;V62&#39;,
 &#39;V64&#39;,
 &#39;V65&#39;,
 &#39;V66&#39;,
 &#39;V67&#39;,
 &#39;V68&#39;,
 &#39;V70&#39;,
 &#39;V74&#39;,
 &#39;V75&#39;,
 &#39;V76&#39;,
 &#39;V77&#39;,
 &#39;V78&#39;,
 &#39;V79&#39;,
 &#39;V80&#39;,
 &#39;V82&#39;,
 &#39;V83&#39;,
 &#39;V85&#39;,
 &#39;V86&#39;,
 &#39;V87&#39;,
 &#39;V88&#39;,
 &#39;V89&#39;,
 &#39;V91&#39;,
 &#39;V93&#39;,
 &#39;V94&#39;,
 &#39;V98&#39;,
 &#39;V99&#39;,
 &#39;V100&#39;,
 &#39;V104&#39;,
 &#39;V107&#39;,
 &#39;V108&#39;,
 &#39;V109&#39;,
 &#39;V110&#39;,
 &#39;V111&#39;,
 &#39;V112&#39;,
 &#39;V114&#39;,
 &#39;V115&#39;,
 &#39;V117&#39;,
 &#39;V118&#39;,
 &#39;V119&#39;,
 &#39;V120&#39;,
 &#39;V121&#39;,
 &#39;V122&#39;,
 &#39;V123&#39;,
 &#39;V124&#39;,
 &#39;V125&#39;,
 &#39;V129&#39;,
 &#39;V130&#39;,
 &#39;V131&#39;,
 &#39;V135&#39;,
 &#39;V136&#39;,
 &#39;V138&#39;,
 &#39;V139&#39;,
 &#39;V141&#39;,
 &#39;V142&#39;,
 &#39;V143&#39;,
 &#39;V144&#39;,
 &#39;V146&#39;,
 &#39;V147&#39;,
 &#39;V152&#39;,
 &#39;V154&#39;,
 &#39;V157&#39;,
 &#39;V160&#39;,
 &#39;V161&#39;,
 &#39;V162&#39;,
 &#39;V164&#39;,
 &#39;V166&#39;,
 &#39;V169&#39;,
 &#39;V170&#39;,
 &#39;V172&#39;,
 &#39;V173&#39;,
 &#39;V174&#39;,
 &#39;V175&#39;,
 &#39;V176&#39;,
 &#39;V181&#39;,
 &#39;V184&#39;,
 &#39;V187&#39;,
 &#39;V188&#39;,
 &#39;V194&#39;,
 &#39;V197&#39;,
 &#39;V198&#39;,
 &#39;V199&#39;,
 &#39;V201&#39;,
 &#39;V206&#39;,
 &#39;V208&#39;,
 &#39;V209&#39;,
 &#39;V214&#39;,
 &#39;V217&#39;,
 &#39;V220&#39;,
 &#39;V221&#39;,
 &#39;V223&#39;,
 &#39;V224&#39;,
 &#39;V227&#39;,
 &#39;V228&#39;,
 &#39;V231&#39;,
 &#39;V234&#39;,
 &#39;V235&#39;,
 &#39;V238&#39;,
 &#39;V240&#39;,
 &#39;V241&#39;,
 &#39;V244&#39;,
 &#39;V247&#39;,
 &#39;V250&#39;,
 &#39;V252&#39;,
 &#39;V257&#39;,
 &#39;V259&#39;,
 &#39;V260&#39;,
 &#39;V261&#39;,
 &#39;V262&#39;,
 &#39;V263&#39;,
 &#39;V267&#39;,
 &#39;V269&#39;,
 &#39;V270&#39;,
 &#39;V271&#39;,
 &#39;V277&#39;,
 &#39;V279&#39;,
 &#39;V280&#39;,
 &#39;V281&#39;,
 &#39;V282&#39;,
 &#39;V283&#39;,
 &#39;V284&#39;,
 &#39;V285&#39;,
 &#39;V286&#39;,
 &#39;V287&#39;,
 &#39;V288&#39;,
 &#39;V289&#39;,
 &#39;V291&#39;,
 &#39;V293&#39;,
 &#39;V296&#39;,
 &#39;V297&#39;,
 &#39;V300&#39;,
 &#39;V301&#39;,
 &#39;V302&#39;,
 &#39;V303&#39;,
 &#39;V305&#39;,
 &#39;V309&#39;,
 &#39;V310&#39;,
 &#39;V311&#39;,
 &#39;V312&#39;,
 &#39;V313&#39;,
 &#39;V314&#39;,
 &#39;V319&#39;,
 &#39;V325&#39;,
 &#39;V326&#39;,
 &#39;V328&#39;,
 &#39;V334&#39;,
 &#39;V337&#39;,
 &#39;id_01&#39;,
 &#39;id_02&#39;,
 &#39;id_03&#39;,
 &#39;id_04&#39;,
 &#39;id_05&#39;,
 &#39;id_06&#39;,
 &#39;id_09&#39;,
 &#39;id_10&#39;,
 &#39;id_11&#39;,
 &#39;id_13&#39;,
 &#39;id_14&#39;,
 &#39;id_17&#39;,
 &#39;id_18&#39;,
 &#39;id_19&#39;,
 &#39;id_20&#39;,
 &#39;id_32&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#  &#39;vif_selected_cols&#39; contiene las columnas que pasaron VIF &lt; 10</span>
<span class="n">vif_df_parcial</span> <span class="o">=</span> <span class="n">subset_imputed</span><span class="p">[</span><span class="n">vif_selected_cols</span><span class="p">]</span>

<span class="c1"># Guardar el avance como archivo CSV</span>
<span class="n">vif_df_parcial</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;vif_reduccion_parcial.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">vif_df_parcial</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>isFraud</th>
      <th>TransactionDT</th>
      <th>TransactionAmt</th>
      <th>card1</th>
      <th>card2</th>
      <th>card3</th>
      <th>card5</th>
      <th>addr1</th>
      <th>addr2</th>
      <th>dist1</th>
      <th>...</th>
      <th>id_09</th>
      <th>id_10</th>
      <th>id_11</th>
      <th>id_13</th>
      <th>id_14</th>
      <th>id_17</th>
      <th>id_18</th>
      <th>id_19</th>
      <th>id_20</th>
      <th>id_32</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>86400.0</td>
      <td>68.50</td>
      <td>13926.0</td>
      <td>361.0</td>
      <td>150.0</td>
      <td>142.0</td>
      <td>315.0</td>
      <td>87.0</td>
      <td>19.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>52.0</td>
      <td>-300.0</td>
      <td>166.0</td>
      <td>15.0</td>
      <td>341.0</td>
      <td>472.0</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>86401.0</td>
      <td>29.00</td>
      <td>2755.0</td>
      <td>404.0</td>
      <td>150.0</td>
      <td>102.0</td>
      <td>325.0</td>
      <td>87.0</td>
      <td>8.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>52.0</td>
      <td>-300.0</td>
      <td>166.0</td>
      <td>15.0</td>
      <td>341.0</td>
      <td>472.0</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>86469.0</td>
      <td>59.00</td>
      <td>4663.0</td>
      <td>490.0</td>
      <td>150.0</td>
      <td>166.0</td>
      <td>330.0</td>
      <td>87.0</td>
      <td>287.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>52.0</td>
      <td>-300.0</td>
      <td>166.0</td>
      <td>15.0</td>
      <td>341.0</td>
      <td>472.0</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>86499.0</td>
      <td>50.00</td>
      <td>18132.0</td>
      <td>567.0</td>
      <td>150.0</td>
      <td>117.0</td>
      <td>476.0</td>
      <td>87.0</td>
      <td>8.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>52.0</td>
      <td>-300.0</td>
      <td>166.0</td>
      <td>15.0</td>
      <td>341.0</td>
      <td>472.0</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>86506.0</td>
      <td>50.00</td>
      <td>4497.0</td>
      <td>514.0</td>
      <td>150.0</td>
      <td>102.0</td>
      <td>420.0</td>
      <td>87.0</td>
      <td>8.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>52.0</td>
      <td>-480.0</td>
      <td>166.0</td>
      <td>15.0</td>
      <td>542.0</td>
      <td>144.0</td>
      <td>32.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>590535</th>
      <td>0.0</td>
      <td>15811047.0</td>
      <td>49.00</td>
      <td>6550.0</td>
      <td>361.0</td>
      <td>150.0</td>
      <td>226.0</td>
      <td>272.0</td>
      <td>87.0</td>
      <td>48.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>52.0</td>
      <td>-300.0</td>
      <td>166.0</td>
      <td>15.0</td>
      <td>341.0</td>
      <td>472.0</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>590536</th>
      <td>0.0</td>
      <td>15811049.0</td>
      <td>39.50</td>
      <td>10444.0</td>
      <td>225.0</td>
      <td>150.0</td>
      <td>224.0</td>
      <td>204.0</td>
      <td>87.0</td>
      <td>8.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>52.0</td>
      <td>-300.0</td>
      <td>166.0</td>
      <td>15.0</td>
      <td>341.0</td>
      <td>472.0</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>590537</th>
      <td>0.0</td>
      <td>15811079.0</td>
      <td>30.95</td>
      <td>12037.0</td>
      <td>595.0</td>
      <td>150.0</td>
      <td>224.0</td>
      <td>231.0</td>
      <td>87.0</td>
      <td>8.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>52.0</td>
      <td>-300.0</td>
      <td>166.0</td>
      <td>15.0</td>
      <td>341.0</td>
      <td>472.0</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>590538</th>
      <td>0.0</td>
      <td>15811088.0</td>
      <td>117.00</td>
      <td>7826.0</td>
      <td>481.0</td>
      <td>150.0</td>
      <td>224.0</td>
      <td>387.0</td>
      <td>87.0</td>
      <td>3.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>52.0</td>
      <td>-300.0</td>
      <td>166.0</td>
      <td>15.0</td>
      <td>341.0</td>
      <td>472.0</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>590539</th>
      <td>0.0</td>
      <td>15811131.0</td>
      <td>279.95</td>
      <td>15066.0</td>
      <td>170.0</td>
      <td>150.0</td>
      <td>102.0</td>
      <td>299.0</td>
      <td>87.0</td>
      <td>8.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>52.0</td>
      <td>-300.0</td>
      <td>166.0</td>
      <td>15.0</td>
      <td>341.0</td>
      <td>472.0</td>
      <td>24.0</td>
    </tr>
  </tbody>
</table>
<p>590540 rows × 234 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vif_df_parcial</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>float64    234
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;vif_columnas_guardadas.pkl&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">vif_selected_cols</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subset_imputed</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>float64    396
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="imputacion-de-datos-faltantes-variables-categoricas">
<h2>Imputación de datos faltantes variables categóricas<a class="headerlink" href="#imputacion-de-datos-faltantes-variables-categoricas" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filtrar solo columnas categóricas</span>
<span class="n">cat_vars</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>

<span class="c1"># Contar nulos por columna</span>
<span class="n">nulos_cat</span> <span class="o">=</span> <span class="n">cat_vars</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># Proporción de nulos (%)</span>
<span class="n">proporcion_nulos</span> <span class="o">=</span> <span class="p">(</span><span class="n">nulos_cat</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_df</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Juntar en un DataFrame</span>
<span class="n">nulos_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Nulos&quot;</span><span class="p">:</span> <span class="n">nulos_cat</span><span class="p">,</span>
    <span class="s2">&quot;Proporción (%)&quot;</span><span class="p">:</span> <span class="n">proporcion_nulos</span>
<span class="p">})</span>

<span class="c1"># Ordenar de mayor a menor por proporción</span>
<span class="n">nulos_df</span> <span class="o">=</span> <span class="n">nulos_df</span><span class="p">[</span><span class="n">nulos_df</span><span class="p">[</span><span class="s2">&quot;Nulos&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;Proporción (%)&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">nulos_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Nulos</th>
      <th>Proporción (%)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id_23</th>
      <td>585371</td>
      <td>99.124699</td>
    </tr>
    <tr>
      <th>id_27</th>
      <td>585371</td>
      <td>99.124699</td>
    </tr>
    <tr>
      <th>id_33</th>
      <td>517251</td>
      <td>87.589494</td>
    </tr>
    <tr>
      <th>id_30</th>
      <td>512975</td>
      <td>86.865411</td>
    </tr>
    <tr>
      <th>id_34</th>
      <td>512735</td>
      <td>86.824771</td>
    </tr>
    <tr>
      <th>DeviceInfo</th>
      <td>471874</td>
      <td>79.905510</td>
    </tr>
    <tr>
      <th>id_16</th>
      <td>461200</td>
      <td>78.098012</td>
    </tr>
    <tr>
      <th>R_emaildomain</th>
      <td>453249</td>
      <td>76.751617</td>
    </tr>
    <tr>
      <th>id_31</th>
      <td>450258</td>
      <td>76.245132</td>
    </tr>
    <tr>
      <th>DeviceType</th>
      <td>449730</td>
      <td>76.155722</td>
    </tr>
    <tr>
      <th>id_28</th>
      <td>449562</td>
      <td>76.127273</td>
    </tr>
    <tr>
      <th>id_29</th>
      <td>449562</td>
      <td>76.127273</td>
    </tr>
    <tr>
      <th>id_15</th>
      <td>449555</td>
      <td>76.126088</td>
    </tr>
    <tr>
      <th>id_38</th>
      <td>449555</td>
      <td>76.126088</td>
    </tr>
    <tr>
      <th>id_37</th>
      <td>449555</td>
      <td>76.126088</td>
    </tr>
    <tr>
      <th>id_36</th>
      <td>449555</td>
      <td>76.126088</td>
    </tr>
    <tr>
      <th>id_35</th>
      <td>449555</td>
      <td>76.126088</td>
    </tr>
    <tr>
      <th>id_12</th>
      <td>446307</td>
      <td>75.576083</td>
    </tr>
    <tr>
      <th>M5</th>
      <td>350482</td>
      <td>59.349409</td>
    </tr>
    <tr>
      <th>M7</th>
      <td>346265</td>
      <td>58.635317</td>
    </tr>
    <tr>
      <th>M8</th>
      <td>346252</td>
      <td>58.633115</td>
    </tr>
    <tr>
      <th>M9</th>
      <td>346252</td>
      <td>58.633115</td>
    </tr>
    <tr>
      <th>M4</th>
      <td>281444</td>
      <td>47.658753</td>
    </tr>
    <tr>
      <th>M1</th>
      <td>271100</td>
      <td>45.907136</td>
    </tr>
    <tr>
      <th>M2</th>
      <td>271100</td>
      <td>45.907136</td>
    </tr>
    <tr>
      <th>M3</th>
      <td>271100</td>
      <td>45.907136</td>
    </tr>
    <tr>
      <th>M6</th>
      <td>169360</td>
      <td>28.678836</td>
    </tr>
    <tr>
      <th>P_emaildomain</th>
      <td>94456</td>
      <td>15.994852</td>
    </tr>
    <tr>
      <th>card4</th>
      <td>1577</td>
      <td>0.267044</td>
    </tr>
    <tr>
      <th>card6</th>
      <td>1571</td>
      <td>0.266028</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Identificar columnas a eliminar (más del 95% de nulos)</span>
<span class="n">columnas_a_eliminar</span> <span class="o">=</span> <span class="n">proporcion_nulos</span><span class="p">[</span><span class="n">proporcion_nulos</span> <span class="o">&gt;</span> <span class="mi">95</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Crear copia del subset categórico</span>
<span class="n">subset_imputed_cat</span> <span class="o">=</span> <span class="n">cat_vars</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columnas_a_eliminar</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># 5. Imputar con la moda en las columnas restantes con nulos</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">subset_imputed_cat</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">subset_imputed_cat</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">moda</span> <span class="o">=</span> <span class="n">subset_imputed_cat</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">subset_imputed_cat</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">moda</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">subset_imputed_cat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_34548\2969474835.py:11: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  subset_imputed_cat[col].fillna(moda, inplace=True)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ProductCD</th>
      <th>card4</th>
      <th>card6</th>
      <th>P_emaildomain</th>
      <th>R_emaildomain</th>
      <th>M1</th>
      <th>M2</th>
      <th>M3</th>
      <th>M4</th>
      <th>M5</th>
      <th>...</th>
      <th>id_30</th>
      <th>id_31</th>
      <th>id_33</th>
      <th>id_34</th>
      <th>id_35</th>
      <th>id_36</th>
      <th>id_37</th>
      <th>id_38</th>
      <th>DeviceType</th>
      <th>DeviceInfo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>W</td>
      <td>discover</td>
      <td>credit</td>
      <td>gmail.com</td>
      <td>gmail.com</td>
      <td>T</td>
      <td>T</td>
      <td>T</td>
      <td>M2</td>
      <td>F</td>
      <td>...</td>
      <td>Windows 10</td>
      <td>chrome 63.0</td>
      <td>1920x1080</td>
      <td>match_status:2</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>F</td>
      <td>desktop</td>
      <td>Windows</td>
    </tr>
    <tr>
      <th>1</th>
      <td>W</td>
      <td>mastercard</td>
      <td>credit</td>
      <td>gmail.com</td>
      <td>gmail.com</td>
      <td>T</td>
      <td>T</td>
      <td>T</td>
      <td>M0</td>
      <td>T</td>
      <td>...</td>
      <td>Windows 10</td>
      <td>chrome 63.0</td>
      <td>1920x1080</td>
      <td>match_status:2</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>F</td>
      <td>desktop</td>
      <td>Windows</td>
    </tr>
    <tr>
      <th>2</th>
      <td>W</td>
      <td>visa</td>
      <td>debit</td>
      <td>outlook.com</td>
      <td>gmail.com</td>
      <td>T</td>
      <td>T</td>
      <td>T</td>
      <td>M0</td>
      <td>F</td>
      <td>...</td>
      <td>Windows 10</td>
      <td>chrome 63.0</td>
      <td>1920x1080</td>
      <td>match_status:2</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>F</td>
      <td>desktop</td>
      <td>Windows</td>
    </tr>
    <tr>
      <th>3</th>
      <td>W</td>
      <td>mastercard</td>
      <td>debit</td>
      <td>yahoo.com</td>
      <td>gmail.com</td>
      <td>T</td>
      <td>T</td>
      <td>T</td>
      <td>M0</td>
      <td>T</td>
      <td>...</td>
      <td>Windows 10</td>
      <td>chrome 63.0</td>
      <td>1920x1080</td>
      <td>match_status:2</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>F</td>
      <td>desktop</td>
      <td>Windows</td>
    </tr>
    <tr>
      <th>4</th>
      <td>H</td>
      <td>mastercard</td>
      <td>credit</td>
      <td>gmail.com</td>
      <td>gmail.com</td>
      <td>T</td>
      <td>T</td>
      <td>T</td>
      <td>M0</td>
      <td>F</td>
      <td>...</td>
      <td>Android 7.0</td>
      <td>samsung browser 6.2</td>
      <td>2220x1080</td>
      <td>match_status:2</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>T</td>
      <td>mobile</td>
      <td>SAMSUNG SM-G892A Build/NRD90M</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>590535</th>
      <td>W</td>
      <td>visa</td>
      <td>debit</td>
      <td>gmail.com</td>
      <td>gmail.com</td>
      <td>T</td>
      <td>T</td>
      <td>T</td>
      <td>M0</td>
      <td>T</td>
      <td>...</td>
      <td>Windows 10</td>
      <td>chrome 63.0</td>
      <td>1920x1080</td>
      <td>match_status:2</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>F</td>
      <td>desktop</td>
      <td>Windows</td>
    </tr>
    <tr>
      <th>590536</th>
      <td>W</td>
      <td>mastercard</td>
      <td>debit</td>
      <td>gmail.com</td>
      <td>gmail.com</td>
      <td>T</td>
      <td>F</td>
      <td>F</td>
      <td>M0</td>
      <td>F</td>
      <td>...</td>
      <td>Windows 10</td>
      <td>chrome 63.0</td>
      <td>1920x1080</td>
      <td>match_status:2</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>F</td>
      <td>desktop</td>
      <td>Windows</td>
    </tr>
    <tr>
      <th>590537</th>
      <td>W</td>
      <td>mastercard</td>
      <td>debit</td>
      <td>gmail.com</td>
      <td>gmail.com</td>
      <td>T</td>
      <td>F</td>
      <td>F</td>
      <td>M0</td>
      <td>F</td>
      <td>...</td>
      <td>Windows 10</td>
      <td>chrome 63.0</td>
      <td>1920x1080</td>
      <td>match_status:2</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>F</td>
      <td>desktop</td>
      <td>Windows</td>
    </tr>
    <tr>
      <th>590538</th>
      <td>W</td>
      <td>mastercard</td>
      <td>debit</td>
      <td>aol.com</td>
      <td>gmail.com</td>
      <td>T</td>
      <td>T</td>
      <td>T</td>
      <td>M0</td>
      <td>F</td>
      <td>...</td>
      <td>Windows 10</td>
      <td>chrome 63.0</td>
      <td>1920x1080</td>
      <td>match_status:2</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>F</td>
      <td>desktop</td>
      <td>Windows</td>
    </tr>
    <tr>
      <th>590539</th>
      <td>W</td>
      <td>mastercard</td>
      <td>credit</td>
      <td>gmail.com</td>
      <td>gmail.com</td>
      <td>T</td>
      <td>F</td>
      <td>F</td>
      <td>M0</td>
      <td>F</td>
      <td>...</td>
      <td>Windows 10</td>
      <td>chrome 63.0</td>
      <td>1920x1080</td>
      <td>match_status:2</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>F</td>
      <td>desktop</td>
      <td>Windows</td>
    </tr>
  </tbody>
</table>
<p>590540 rows × 29 columns</p>
</div></div></div>
</div>
</section>
<section id="variables-categoricas-multicolinealidad-usando-la-prueba-chi2-contingency">
<h2>Variables Categoricas: Multicolinealidad usando la prueba chi2_contingency()<a class="headerlink" href="#variables-categoricas-multicolinealidad-usando-la-prueba-chi2-contingency" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lista de variables categóricas</span>
<span class="n">cat_columns</span> <span class="o">=</span> <span class="n">subset_imputed_cat</span><span class="o">.</span><span class="n">columns</span>
<span class="n">chi2_results</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Iterar por todas las combinaciones de pares</span>
<span class="k">for</span> <span class="n">var1</span><span class="p">,</span> <span class="n">var2</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">cat_columns</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
    <span class="n">contingency_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">subset_imputed_cat</span><span class="p">[</span><span class="n">var1</span><span class="p">],</span> <span class="n">subset_imputed_cat</span><span class="p">[</span><span class="n">var2</span><span class="p">])</span>

    <span class="c1"># Evitar tablas vacías o triviales</span>
    <span class="k">if</span> <span class="n">contingency_table</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">contingency_table</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">continue</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">chi2</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">chi2_contingency</span><span class="p">(</span><span class="n">contingency_table</span><span class="p">)</span>
        <span class="n">chi2_results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">var1</span><span class="p">,</span> <span class="n">var2</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">continue</span>  <span class="c1"># Ignora si hay algún error con datos problemáticos</span>

<span class="c1"># Crear DataFrame de resultados</span>
<span class="n">chi2_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">chi2_results</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Variable 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Variable 2&#39;</span><span class="p">,</span> <span class="s1">&#39;p-value&#39;</span><span class="p">])</span>

<span class="c1"># Ordenar por p-value (menor p = mayor asociación)</span>
<span class="n">chi2_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;p-value&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">chi2_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chi2_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable 1</th>
      <th>Variable 2</th>
      <th>p-value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ProductCD</td>
      <td>card4</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>M8</td>
      <td>id_15</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>M8</td>
      <td>id_12</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>M8</td>
      <td>M9</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>M7</td>
      <td>DeviceType</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>401</th>
      <td>M1</td>
      <td>id_36</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>402</th>
      <td>M1</td>
      <td>id_33</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>403</th>
      <td>M1</td>
      <td>id_31</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>404</th>
      <td>M1</td>
      <td>id_30</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>405</th>
      <td>R_emaildomain</td>
      <td>M1</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>406 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pares_altamente_asociados</span> <span class="o">=</span> <span class="n">chi2_df</span><span class="p">[</span><span class="n">chi2_df</span><span class="p">[</span><span class="s1">&#39;p-value&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">]</span>
<span class="n">pares_altamente_asociados</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable 1</th>
      <th>Variable 2</th>
      <th>p-value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ProductCD</td>
      <td>card4</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>M8</td>
      <td>id_15</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>M8</td>
      <td>id_12</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>M8</td>
      <td>M9</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>M7</td>
      <td>DeviceType</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>375</th>
      <td>M5</td>
      <td>M9</td>
      <td>7.613105e-29</td>
    </tr>
    <tr>
      <th>376</th>
      <td>id_34</td>
      <td>id_36</td>
      <td>3.187202e-20</td>
    </tr>
    <tr>
      <th>377</th>
      <td>M6</td>
      <td>M9</td>
      <td>8.720692e-15</td>
    </tr>
    <tr>
      <th>378</th>
      <td>id_12</td>
      <td>id_29</td>
      <td>2.175574e-07</td>
    </tr>
    <tr>
      <th>379</th>
      <td>id_12</td>
      <td>id_28</td>
      <td>5.692832e-06</td>
    </tr>
  </tbody>
</table>
<p>380 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>

<span class="c1"># Contar cuántas veces aparece cada variable en los pares con asociación fuerte</span>
<span class="n">variables_contadas</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">pares_altamente_asociados</span><span class="p">[</span><span class="s1">&#39;Variable 1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span>
                             <span class="n">pares_altamente_asociados</span><span class="p">[</span><span class="s1">&#39;Variable 2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

<span class="c1"># Ver las más frecuentes (más asociadas con otras)</span>
<span class="n">top_repetidas</span><span class="o">=</span><span class="n">variables_contadas</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">top_repetidas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;M3&#39;, 28),
 (&#39;M2&#39;, 28),
 (&#39;ProductCD&#39;, 27),
 (&#39;M8&#39;, 27),
 (&#39;M7&#39;, 27),
 (&#39;M6&#39;, 27),
 (&#39;M9&#39;, 27),
 (&#39;M4&#39;, 27),
 (&#39;M5&#39;, 27),
 (&#39;id_38&#39;, 27)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">subset_imputed_cat</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>         <span class="c1"># Verifica dimensiones</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subset_imputed_cat</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>       <span class="c1"># Asegúrate de que se eliminaron</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(590540, 29)
Index([&#39;ProductCD&#39;, &#39;card4&#39;, &#39;card6&#39;, &#39;P_emaildomain&#39;, &#39;R_emaildomain&#39;, &#39;M1&#39;,
       &#39;M2&#39;, &#39;M3&#39;, &#39;M4&#39;, &#39;M5&#39;, &#39;M6&#39;, &#39;M7&#39;, &#39;M8&#39;, &#39;M9&#39;, &#39;id_12&#39;, &#39;id_15&#39;,
       &#39;id_16&#39;, &#39;id_28&#39;, &#39;id_29&#39;, &#39;id_30&#39;, &#39;id_31&#39;, &#39;id_33&#39;, &#39;id_34&#39;, &#39;id_35&#39;,
       &#39;id_36&#39;, &#39;id_37&#39;, &#39;id_38&#39;, &#39;DeviceType&#39;, &#39;DeviceInfo&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variables_a_eliminar</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;M3&#39;</span><span class="p">,</span> <span class="s1">&#39;M2&#39;</span><span class="p">,</span> <span class="s1">&#39;ProductCD&#39;</span><span class="p">,</span> <span class="s1">&#39;M8&#39;</span><span class="p">,</span> <span class="s1">&#39;M7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;M6&#39;</span><span class="p">,</span> <span class="s1">&#39;M9&#39;</span><span class="p">,</span> <span class="s1">&#39;M4&#39;</span><span class="p">,</span> <span class="s1">&#39;M5&#39;</span><span class="p">,</span> <span class="s1">&#39;id_38&#39;</span>
<span class="p">]</span>

<span class="n">subset_imputed_cat</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">variables_a_eliminar</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">subset_imputed_cat</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>         <span class="c1"># Verifica dimensiones</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subset_imputed_cat</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>       <span class="c1"># Asegúrate de que se eliminaron</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(590540, 19)
Index([&#39;card4&#39;, &#39;card6&#39;, &#39;P_emaildomain&#39;, &#39;R_emaildomain&#39;, &#39;M1&#39;, &#39;id_12&#39;,
       &#39;id_15&#39;, &#39;id_16&#39;, &#39;id_28&#39;, &#39;id_29&#39;, &#39;id_30&#39;, &#39;id_31&#39;, &#39;id_33&#39;, &#39;id_34&#39;,
       &#39;id_35&#39;, &#39;id_36&#39;, &#39;id_37&#39;, &#39;DeviceType&#39;, &#39;DeviceInfo&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Concatenación horizontal por índice</span>
<span class="n">df_train_new</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">vif_df_parcial</span><span class="p">,</span> <span class="n">subset_imputed_cat</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_train_new</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df_train_new</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(590540, 253)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>isFraud</th>
      <th>TransactionDT</th>
      <th>TransactionAmt</th>
      <th>card1</th>
      <th>card2</th>
      <th>card3</th>
      <th>card5</th>
      <th>addr1</th>
      <th>addr2</th>
      <th>dist1</th>
      <th>...</th>
      <th>id_29</th>
      <th>id_30</th>
      <th>id_31</th>
      <th>id_33</th>
      <th>id_34</th>
      <th>id_35</th>
      <th>id_36</th>
      <th>id_37</th>
      <th>DeviceType</th>
      <th>DeviceInfo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>86400.0</td>
      <td>68.5</td>
      <td>13926.0</td>
      <td>361.0</td>
      <td>150.0</td>
      <td>142.0</td>
      <td>315.0</td>
      <td>87.0</td>
      <td>19.0</td>
      <td>...</td>
      <td>Found</td>
      <td>Windows 10</td>
      <td>chrome 63.0</td>
      <td>1920x1080</td>
      <td>match_status:2</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>desktop</td>
      <td>Windows</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>86401.0</td>
      <td>29.0</td>
      <td>2755.0</td>
      <td>404.0</td>
      <td>150.0</td>
      <td>102.0</td>
      <td>325.0</td>
      <td>87.0</td>
      <td>8.0</td>
      <td>...</td>
      <td>Found</td>
      <td>Windows 10</td>
      <td>chrome 63.0</td>
      <td>1920x1080</td>
      <td>match_status:2</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>desktop</td>
      <td>Windows</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>86469.0</td>
      <td>59.0</td>
      <td>4663.0</td>
      <td>490.0</td>
      <td>150.0</td>
      <td>166.0</td>
      <td>330.0</td>
      <td>87.0</td>
      <td>287.0</td>
      <td>...</td>
      <td>Found</td>
      <td>Windows 10</td>
      <td>chrome 63.0</td>
      <td>1920x1080</td>
      <td>match_status:2</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>desktop</td>
      <td>Windows</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>86499.0</td>
      <td>50.0</td>
      <td>18132.0</td>
      <td>567.0</td>
      <td>150.0</td>
      <td>117.0</td>
      <td>476.0</td>
      <td>87.0</td>
      <td>8.0</td>
      <td>...</td>
      <td>Found</td>
      <td>Windows 10</td>
      <td>chrome 63.0</td>
      <td>1920x1080</td>
      <td>match_status:2</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>desktop</td>
      <td>Windows</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>86506.0</td>
      <td>50.0</td>
      <td>4497.0</td>
      <td>514.0</td>
      <td>150.0</td>
      <td>102.0</td>
      <td>420.0</td>
      <td>87.0</td>
      <td>8.0</td>
      <td>...</td>
      <td>NotFound</td>
      <td>Android 7.0</td>
      <td>samsung browser 6.2</td>
      <td>2220x1080</td>
      <td>match_status:2</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>mobile</td>
      <td>SAMSUNG SM-G892A Build/NRD90M</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 253 columns</p>
</div></div></div>
</div>
</section>
<section id="visualizacion-de-las-variables">
<h2>Visualización de las variables<a class="headerlink" href="#visualizacion-de-las-variables" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Contar valores</span>
<span class="n">fraud_counts</span> <span class="o">=</span> <span class="n">df_train_new</span><span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fraud_counts</span><span class="p">)</span>

<span class="c1"># Gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;skyblue&#39;</span><span class="p">,</span> <span class="s1">&#39;salmon&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;No Fraude (0)&#39;</span><span class="p">,</span> <span class="s1">&#39;Fraude (1)&#39;</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Cantidad de Transacciones&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribución de la Variable Objetivo: isFraud&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>isFraud
0.0    569877
1.0     20663
Name: count, dtype: int64
</pre></div>
</div>
<img alt="../_images/b464e380a69eb915b95c4e666c51f77d7524a16f6dcb13b20701eac74cce2eae.png" src="../_images/b464e380a69eb915b95c4e666c51f77d7524a16f6dcb13b20701eac74cce2eae.png" />
</div>
</div>
<ul class="simple">
<li><p><strong>Desbalance de clases:</strong></p></li>
</ul>
<p>Solo el 3.5% de las transacciones corresponde a fraudes. El 96.5% restante son transacciones legítimas. Esto confirma que es un problema altamente desbalanceado, típico en detección de fraudes reales.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Separar variables independientes y target</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df_train_new</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df_train_new</span><span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">]</span>

<span class="c1"># Detectar tipo de variable</span>
<span class="n">cat_cols</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">num_cols</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Codificar variables categóricas temporalmente para mutual_info</span>
<span class="n">X_encoded</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">le</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cat_cols</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">X_encoded</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">le</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">X_encoded</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>  <span class="c1"># por si hay errores con NaNs o tipos mixtos</span>

<span class="c1"># Calcular importancia</span>
<span class="n">importancias</span> <span class="o">=</span> <span class="n">mutual_info_classif</span><span class="p">(</span><span class="n">X_encoded</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">discrete_features</span><span class="o">=</span><span class="p">[</span><span class="n">col</span> <span class="ow">in</span> <span class="n">cat_cols</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>

<span class="c1"># Crear DataFrame con resultados</span>
<span class="n">importancia_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Variable&#39;</span><span class="p">:</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
    <span class="s1">&#39;Importancia&#39;</span><span class="p">:</span> <span class="n">importancias</span><span class="p">,</span>
    <span class="s1">&#39;Tipo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Categórica&#39;</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cat_cols</span> <span class="k">else</span> <span class="s1">&#39;Numérica&#39;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
<span class="p">})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Importancia&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">importancia_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable</th>
      <th>Importancia</th>
      <th>Tipo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>150</th>
      <td>V198</td>
      <td>1.716813e-01</td>
      <td>Numérica</td>
    </tr>
    <tr>
      <th>7</th>
      <td>addr2</td>
      <td>1.641189e-01</td>
      <td>Numérica</td>
    </tr>
    <tr>
      <th>122</th>
      <td>V139</td>
      <td>1.582890e-01</td>
      <td>Numérica</td>
    </tr>
    <tr>
      <th>48</th>
      <td>V23</td>
      <td>1.578967e-01</td>
      <td>Numérica</td>
    </tr>
    <tr>
      <th>81</th>
      <td>V77</td>
      <td>1.569376e-01</td>
      <td>Numérica</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>248</th>
      <td>id_36</td>
      <td>1.326265e-08</td>
      <td>Categórica</td>
    </tr>
    <tr>
      <th>213</th>
      <td>V326</td>
      <td>0.000000e+00</td>
      <td>Numérica</td>
    </tr>
    <tr>
      <th>91</th>
      <td>V89</td>
      <td>0.000000e+00</td>
      <td>Numérica</td>
    </tr>
    <tr>
      <th>76</th>
      <td>V68</td>
      <td>0.000000e+00</td>
      <td>Numérica</td>
    </tr>
    <tr>
      <th>140</th>
      <td>V173</td>
      <td>0.000000e+00</td>
      <td>Numérica</td>
    </tr>
  </tbody>
</table>
<p>252 rows × 3 columns</p>
</div></div></div>
</div>
<p>En el marco del análisis de importancia de las variables predictoras con respecto a la variable objetivo isFraud, se empleó la métrica de información mutua (mutual_info_classif). Esta técnica permite identificar cuánto conocimiento aporta cada variable individualmente al momento de predecir si una transacción es fraudulenta o no, proporcionando así un criterio sólido para la selección de características.</p>
<p>Los resultados muestran que las variables V198, addr2, V139, V23 y V77 se destacan como las más relevantes del conjunto de datos, con valores de importancia superiores a 0.15. Estas variables numéricas presentan patrones significativamente diferenciadores entre las clases de fraude (isFraud = 1) y no fraude (isFraud = 0). Por ejemplo, addr2, relacionada posiblemente con información geográfica, podría reflejar comportamientos atípicos de ubicación en transacciones fraudulentas. Por su parte, variables como V198 y V139 podrían estar capturando características transaccionales internas del sistema que son altamente sensibles a cambios en el comportamiento de los usuarios, y por ende, útiles para la detección de fraudes.</p>
<p>En contraste, un grupo considerable de variables, entre ellas id_36, V326, V89, V68 y V173, presentan una importancia nula (valor de 0.0), lo cual sugiere que no aportan información estadísticamente significativa para predecir la variable objetivo. En términos prácticos, estas variables podrían considerarse candidatas a ser eliminadas del conjunto de datos, ya que su inclusión podría introducir ruido, aumentar la dimensionalidad del problema y ralentizar innecesariamente el proceso de entrenamiento de los modelos.</p>
<p>En resumen, la información mutua ha permitido no solo identificar las variables con mayor potencial predictivo, sino también orientar un proceso de depuración del dataset que contribuirá a mejorar la eficiencia y precisión de los modelos de detección de fraude en etapas posteriores del análisis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Seleccionar top 5 de cada tipo</span>
<span class="n">top_num</span> <span class="o">=</span> <span class="n">importancia_df</span><span class="p">[</span><span class="n">importancia_df</span><span class="p">[</span><span class="s1">&#39;Tipo&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Numérica&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)[</span><span class="s1">&#39;Variable&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">top_cat</span> <span class="o">=</span> <span class="n">importancia_df</span><span class="p">[</span><span class="n">importancia_df</span><span class="p">[</span><span class="s1">&#39;Tipo&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Categórica&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)[</span><span class="s1">&#39;Variable&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Histogramas para variables numéricas</span>
<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">top_num</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_train_new</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;isFraud&#39;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">element</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Histograma de </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1"> según isFraud&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8bd5f1db6c21d12d20aca8312b27e584f06c9356128a24e9919addc47902a65e.png" src="../_images/8bd5f1db6c21d12d20aca8312b27e584f06c9356128a24e9919addc47902a65e.png" />
<img alt="../_images/1bb54970a664f836186e77344aae8fec1d673c9f59c8c7e7c507d21cd0a615d4.png" src="../_images/1bb54970a664f836186e77344aae8fec1d673c9f59c8c7e7c507d21cd0a615d4.png" />
<img alt="../_images/b1522456fdc537bf260838c4f9a28bf08e4c90ff2ed68bc4f0f0b5b83e7d1039.png" src="../_images/b1522456fdc537bf260838c4f9a28bf08e4c90ff2ed68bc4f0f0b5b83e7d1039.png" />
<img alt="../_images/2015245b529ce05a531dd6b6580d85b8cd943a2fb96ab8d8576ce000656d271c.png" src="../_images/2015245b529ce05a531dd6b6580d85b8cd943a2fb96ab8d8576ce000656d271c.png" />
<img alt="../_images/9e941b23072a53bd80be60853520033a5428765fd76198b4f6b4b39b9023a8f3.png" src="../_images/9e941b23072a53bd80be60853520033a5428765fd76198b4f6b4b39b9023a8f3.png" />
</div>
</div>
<ol class="arabic simple">
<li><p><strong>La variable V198</strong> muestra una distribución altamente sesgada a la izquierda, con la mayoría de las observaciones concentradas en un rango muy estrecho cerca de cero. Sin embargo, se evidencia una ligera diferencia en el comportamiento de las transacciones fraudulentas (isFraud = 1), cuya distribución presenta una mayor dispersión en comparación con las no fraudulentas. Esto sugiere que valores extremos o desviaciones en V198 podrían ser indicativos de actividad inusual asociada al fraude.</p></li>
<li><p><strong>La variable addr2</strong> posiblemente representa una codificación geográfica secundaria, presenta una distribución fuertemente dominada por un único valor (alrededor de 87), lo cual indica que una gran parte de las transacciones proviene de una misma localización o región. No obstante, hay una pequeña proporción de valores diferentes (outliers), donde también se presentan algunas transacciones fraudulentas. Esto puede reflejar que ciertas ubicaciones menos frecuentes están correlacionadas con un mayor riesgo de fraude.</p></li>
<li><p><strong>La variable V139</strong>
V139 es otra variable con una distribución muy sesgada y con una gran densidad de valores cercanos a cero. Las observaciones fraudulentas tienden a diferenciarse ligeramente de las no fraudulentas en rangos específicos, lo que indica que esta variable captura alguna característica interna del proceso transaccional que puede ser aprovechada para la detección del fraude. A pesar de su concentración, los valores atípicos parecen ser más frecuentes en la clase fraudulenta.</p></li>
<li><p><strong>La variable V23</strong>
En V23, al igual que en las anteriores, se observa un fuerte sesgo a la izquierda y una gran acumulación de datos en valores bajos. La diferencia entre las clases isFraud=0 e isFraud=1 es poco notoria a simple vista, pero podrían existir patrones más sutiles que podrían ser detectados mediante algoritmos de modelado supervisado. La presencia de valores atípicos también está más marcada en las transacciones fraudulentas.</p></li>
<li><p><strong>La variable V77</strong>
La variable V77 presenta una distribución similar a V139 y V23, con un comportamiento claramente sesgado a la izquierda y valores acumulados en torno a cero. En este caso, también se observa una mayor dispersión en la distribución de las observaciones correspondientes a fraudes, lo que indica que los valores de esta variable podrían estar influidos por comportamientos atípicos de los usuarios o por características transaccionales específicas.</p></li>
</ol>
<p><strong>Conclusión</strong>
Las cinco variables analizadas presentan distribuciones altamente asimétricas, con gran concentración de valores bajos y presencia de outliers, lo cual es típico en problemas financieros o transaccionales. Aunque visualmente la diferencia entre clases no siempre es marcada, la importancia estadística calculada previamente justifica su inclusión en modelos de predicción de fraude. No obstante, podría ser útil aplicar transformaciones logarítmicas o técnicas de normalización para reducir el sesgo y mejorar la capacidad predictiva de los algoritmos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">top_n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">var</span><span class="o">=</span><span class="n">top_cat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">top_values</span> <span class="o">=</span> <span class="n">df_train_new</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="n">top_n</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>
<span class="n">df_train_new</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1">_simplified&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_train_new</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">top_values</span> <span class="k">else</span> <span class="s1">&#39;Otros&#39;</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_train_new</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1">_simplified&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;isFraud&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
 [Text(0, 0, &#39;Windows&#39;),
  Text(1, 0, &#39;Otros&#39;),
  Text(2, 0, &#39;iOS Device&#39;),
  Text(3, 0, &#39;MacOS&#39;),
  Text(4, 0, &#39;SM-J700M Build/MMB29K&#39;),
  Text(5, 0, &#39;Trident/7.0&#39;),
  Text(6, 0, &#39;rv:57.0&#39;),
  Text(7, 0, &#39;SM-G610M Build/MMB29K&#39;),
  Text(8, 0, &#39;rv:11.0&#39;),
  Text(9, 0, &#39;SM-G531H Build/LMY48B&#39;),
  Text(10, 0, &#39;rv:59.0&#39;)])
</pre></div>
</div>
<img alt="../_images/699021b1d2921d8c9efaf0aa19b7a06ecf36415502d5af80aab624e3a07742b3.png" src="../_images/699021b1d2921d8c9efaf0aa19b7a06ecf36415502d5af80aab624e3a07742b3.png" />
</div>
</div>
<p><strong>1. DeviceInfo_simplified:</strong> que representa el tipo o marca del dispositivo desde el cual se realiza la transacción, muestra una alta concentración de transacciones legítimas (isFraud = 0) provenientes de equipos con sistema operativo Windows. Sin embargo, se observa que el fraude (isFraud = 1) está relativamente más distribuido entre otros dispositivos, incluidos iOS Device, Otros, y algunos modelos específicos de Samsung. Esto sugiere que los dispositivos menos comunes o móviles podrían estar asociados con un mayor riesgo de fraude, posiblemente por el uso de entornos menos controlados o más propensos a accesos no autorizados.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">top_n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">var</span><span class="o">=</span><span class="n">top_cat</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">top_values</span> <span class="o">=</span> <span class="n">df_train_new</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="n">top_n</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>
<span class="n">df_train_new</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1">_simplified&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_train_new</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">top_values</span> <span class="k">else</span> <span class="s1">&#39;Otros&#39;</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_train_new</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1">_simplified&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;isFraud&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
 [Text(0, 0, &#39;chrome 63.0&#39;),
  Text(1, 0, &#39;Otros&#39;),
  Text(2, 0, &#39;mobile safari 11.0&#39;),
  Text(3, 0, &#39;chrome 62.0&#39;),
  Text(4, 0, &#39;mobile safari generic&#39;),
  Text(5, 0, &#39;safari generic&#39;),
  Text(6, 0, &#39;ie 11.0 for desktop&#39;),
  Text(7, 0, &#39;chrome generic&#39;),
  Text(8, 0, &#39;chrome 63.0 for android&#39;),
  Text(9, 0, &#39;chrome 64.0&#39;),
  Text(10, 0, &#39;chrome 65.0&#39;)])
</pre></div>
</div>
<img alt="../_images/b0b14453137fd37b450b8db1341f542e9eda6fdfbac90852c806879bf01faa07.png" src="../_images/b0b14453137fd37b450b8db1341f542e9eda6fdfbac90852c806879bf01faa07.png" />
</div>
</div>
<p><strong>2. id_31_simplified:</strong> Esta variable parece asociada al navegador o agente de usuario (user agent) que accede a la plataforma. El navegador chrome 63.0 es el más utilizado tanto por transacciones legítimas como por fraudulentas, pero en las demás categorías se evidencia una mayor proporción relativa de fraude. Navegadores como mobile safari, safari generic o chrome generic presentan una distribución más equilibrada entre ambas clases, lo que sugiere que algunos navegadores menos convencionales o móviles podrían ser más vulnerables o empleados en actividades sospechosas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">top_n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">var</span><span class="o">=</span><span class="n">top_cat</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">top_values</span> <span class="o">=</span> <span class="n">df_train_new</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="n">top_n</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>
<span class="n">df_train_new</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1">_simplified&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_train_new</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">top_values</span> <span class="k">else</span> <span class="s1">&#39;Otros&#39;</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_train_new</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1">_simplified&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;isFraud&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>([0, 1], [Text(0, 0, &#39;T&#39;), Text(1, 0, &#39;F&#39;)])
</pre></div>
</div>
<img alt="../_images/723d1b1d38a5ff3548e1a18b56f0cf1dc672662c53cac2861ad7cabce66f3d6a.png" src="../_images/723d1b1d38a5ff3548e1a18b56f0cf1dc672662c53cac2861ad7cabce66f3d6a.png" />
</div>
</div>
<p><strong>3. id_35_simplified:</strong> parece ser binaria y relacionada con un atributo booleano del entorno del usuario (como cookies habilitadas, validación de firma, etc.). Aunque la mayoría de las transacciones (fraudulentas y no fraudulentas) se concentran en una única categoría, se observa que la otra categoría presenta una proporción de fraude ligeramente más elevada. Esto podría indicar que ciertas configuraciones del navegador o del sistema, cuando están deshabilitadas o modificadas, incrementan el riesgo de que la transacción sea fraudulenta.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">top_n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">var</span><span class="o">=</span><span class="n">top_cat</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="n">top_values</span> <span class="o">=</span> <span class="n">df_train_new</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="n">top_n</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>
<span class="n">df_train_new</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1">_simplified&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_train_new</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">top_values</span> <span class="k">else</span> <span class="s1">&#39;Otros&#39;</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_train_new</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1">_simplified&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;isFraud&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>([0, 1], [Text(0, 0, &#39;desktop&#39;), Text(1, 0, &#39;mobile&#39;)])
</pre></div>
</div>
<img alt="../_images/28160df0af72b52a463decd4098e002792c134eb201d6c4e76b5faf52bcbb792.png" src="../_images/28160df0af72b52a463decd4098e002792c134eb201d6c4e76b5faf52bcbb792.png" />
</div>
</div>
<p><strong>4. DeviceType_simplified:</strong> Esta variable distingue entre usuarios que realizan transacciones desde desktop o mobile. Los dispositivos de escritorio (desktop) concentran la mayor parte de las transacciones, tanto legítimas como fraudulentas. Sin embargo, se puede notar que los dispositivos móviles presentan una mayor proporción relativa de fraude, lo que podría reflejar un patrón de comportamiento de fraude móvil o una menor seguridad en dispositivos móviles.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">top_n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">var</span><span class="o">=</span><span class="n">top_cat</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
<span class="n">top_values</span> <span class="o">=</span> <span class="n">df_train_new</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="n">top_n</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>
<span class="n">df_train_new</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1">_simplified&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_train_new</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">top_values</span> <span class="k">else</span> <span class="s1">&#39;Otros&#39;</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_train_new</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1">_simplified&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;isFraud&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>([0, 1, 2, 3],
 [Text(0, 0, &#39;credit&#39;),
  Text(1, 0, &#39;debit&#39;),
  Text(2, 0, &#39;debit or credit&#39;),
  Text(3, 0, &#39;charge card&#39;)])
</pre></div>
</div>
<img alt="../_images/d001bdc63d172dd074abf2c89143a6d64394fec54efb9ec7d3448e5ec9e184e4.png" src="../_images/d001bdc63d172dd074abf2c89143a6d64394fec54efb9ec7d3448e5ec9e184e4.png" />
</div>
</div>
<p><strong>5. card6_simplified:</strong> indica el tipo de tarjeta utilizada: credit, debit, charge card, entre otras. Las tarjetas de débito dominan en términos de volumen de transacciones, pero también muestran una mayor proporción de fraude que las de crédito. Esto puede deberse a que las tarjetas de débito, al estar conectadas directamente a cuentas bancarias, suelen ser más atractivas para los atacantes, o bien pueden estar más expuestas en ciertos contextos de pago en línea.</p>
<p>En Conclusión: Estas cinco variables categóricas revelan patrones importantes para la detección de fraude, especialmente en aspectos relacionados con el dispositivo, el navegador, y el tipo de tarjeta. Si bien muchas transacciones fraudulentas ocurren en los grupos más frecuentes (como Windows o chrome 63.0), las diferencias relativas en las categorías menos comunes pueden ser especialmente útiles para los modelos predictivos. Por lo tanto, es recomendable mantener estas variables en etapas posteriores del modelado, realizando codificaciones adecuadas (como One-Hot o Target Encoding) para aprovechar su capacidad discriminativa.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Obtener nombres de variables con importancia ≈ 0</span>
<span class="n">variables_importancia_cero</span> <span class="o">=</span> <span class="n">importancia_df</span><span class="p">[</span><span class="n">importancia_df</span><span class="p">[</span><span class="s1">&#39;Importancia&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">][</span><span class="s1">&#39;Variable&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Eliminar esas columnas del DataFrame original</span>
<span class="n">df_train_new</span> <span class="o">=</span> <span class="n">df_train_new</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">variables_importancia_cero</span><span class="p">)</span>

<span class="c1"># Confirmar resultado</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Se eliminaron </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">variables_importancia_cero</span><span class="p">)</span><span class="si">}</span><span class="s2"> variables con importancia 0.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Nuevo tamaño del dataset: </span><span class="si">{</span><span class="n">df_train_new</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Se eliminaron 4 variables con importancia 0.
Nuevo tamaño del dataset: (590540, 251)
</pre></div>
</div>
</div>
</div>
<p>Estas variables se eliminaron del dataset antes del entrenamiento del modelo para: reducir ruido, acelerar procesamiento y evitar sobreajuste.</p>
</section>
<section id="analisis-de-simetria">
<h2>Analisis de Simetría<a class="headerlink" href="#analisis-de-simetria" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simetría</span>
<span class="n">skewness</span> <span class="o">=</span> <span class="n">df_train_new</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;number&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;isFraud&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">skew</span><span class="p">()</span>
<span class="n">skewness</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>V334     450.479323
V206     427.150989
V305     384.230074
V269     378.180731
V311     323.834650
            ...    
V14      -47.904416
V107     -48.767019
id_10    -54.654434
V65      -58.399860
V1      -186.372808
Length: 229, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">top_skewed</span> <span class="o">=</span> <span class="n">skewness</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">top_skewed</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;V334&#39;, &#39;V206&#39;, &#39;V305&#39;, &#39;V269&#39;, &#39;V311&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#grafico</span>
<span class="n">variables_a_graficar</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">top_skewed</span><span class="p">))</span>
<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">variables_a_graficar</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_train_new</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;isFraud&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">var</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Boxplot de </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1"> según isFraud&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;isFraud&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2905da456b1bdbaef03cbb4cca9cb3923a4ae93939ec927df1dc2444f9a8dfff.png" src="../_images/2905da456b1bdbaef03cbb4cca9cb3923a4ae93939ec927df1dc2444f9a8dfff.png" />
<img alt="../_images/be4531ce247b1be3669cdb14fa2af372cd9b643d095069d7ef57de3633999c2b.png" src="../_images/be4531ce247b1be3669cdb14fa2af372cd9b643d095069d7ef57de3633999c2b.png" />
<img alt="../_images/215c5c7657c4c6f24c1eac4286ae5cafd4fc22bb6a88d8b1682ff3700f455b87.png" src="../_images/215c5c7657c4c6f24c1eac4286ae5cafd4fc22bb6a88d8b1682ff3700f455b87.png" />
<img alt="../_images/f12692da1477a906c76ad8de9d58802af768e3107afd508c5357bbe1afd43a65.png" src="../_images/f12692da1477a906c76ad8de9d58802af768e3107afd508c5357bbe1afd43a65.png" />
<img alt="../_images/9d3bf2c05d051e2feae53fbfdcfee4526d78264c441909893ec5c48e6a5de59b.png" src="../_images/9d3bf2c05d051e2feae53fbfdcfee4526d78264c441909893ec5c48e6a5de59b.png" />
</div>
</div>
<p><strong>Análisis de Simetría (Skewness)</strong></p>
<p>Se evaluó el grado de asimetría de las variables numéricas mediante el coeficiente de skewness, el cual permite identificar si una variable presenta una distribución simétrica (skewness ≈ 0), sesgada a la derecha (skewness &gt; 0) o sesgada a la izquierda (skewness &lt; 0). En este caso, se identificaron las siguientes 5 variables como las más asimétricas:</p>
<p><strong>1. V334 (Skewness ≈ 450.48):</strong> Esta variable presenta una asimetría extremadamente pronunciada hacia la derecha. En el boxplot se observa una gran concentración de valores en la parte baja del eje y una larga cola de valores atípicos en el extremo superior. Esto indica la presencia de muchos valores pequeños o iguales, con pocos valores muy grandes que distorsionan la distribución.</p>
<p><strong>2. V206 (Skewness ≈ 427.15):</strong> Similar a V334, esta variable muestra una gran cantidad de valores bajos con outliers muy elevados. El patrón sugiere que la mayoría de las observaciones están agrupadas cerca del mínimo, lo que podría estar afectando negativamente el rendimiento de algoritmos sensibles a la escala o distribución de los datos.</p>
<p><strong>3. V305 (Skewness ≈ 384.23):</strong> Aunque la magnitud de la skewness es elevada, el boxplot indica que la mayoría de los valores se mantienen constantes (valor 1), con apenas uno o dos valores atípicos. Esto podría indicar una variable casi constante, que debería ser analizada también por su varianza, ya que podría no aportar valor al modelo.</p>
<p><strong>4. V269 (Skewness ≈ 378.18):</strong> La distribución de esta variable está fuertemente sesgada hacia valores bajos, con algunos outliers extremadamente altos que incrementan el coeficiente de asimetría. Esta característica puede tener un impacto significativo sobre modelos de regresión o distancia (KNN, SVM), donde se asume cierta distribución normal.</p>
<p><strong>5. V311 (Skewness ≈ 323.83):</strong> Presenta un comportamiento similar a las anteriores, con una gran cantidad de valores cercanos a cero y unos pocos valores excepcionalmente altos que distorsionan la forma de la distribución.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train_new</span><span class="p">[</span><span class="s1">&#39;V305&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.773427167608211e-06
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train_new</span><span class="p">[</span><span class="s1">&#39;V305&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>V305
1.0    0.999993
2.0    0.000007
Name: proportion, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="analisis-de-datos-atipicos">
<h2>Analisis de datos atipicos<a class="headerlink" href="#analisis-de-datos-atipicos" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">outliers_summary</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_train_new</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;number&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;isFraud&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">Q1</span> <span class="o">=</span> <span class="n">df_train_new</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
    <span class="n">Q3</span> <span class="o">=</span> <span class="n">df_train_new</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>
    <span class="n">IQR</span> <span class="o">=</span> <span class="n">Q3</span> <span class="o">-</span> <span class="n">Q1</span>
    <span class="n">lower</span> <span class="o">=</span> <span class="n">Q1</span> <span class="o">-</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span>
    <span class="n">upper</span> <span class="o">=</span> <span class="n">Q3</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span>
    <span class="n">outliers</span> <span class="o">=</span> <span class="n">df_train_new</span><span class="p">[(</span><span class="n">df_train_new</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">lower</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df_train_new</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">upper</span><span class="p">)]</span>
    <span class="n">outliers_summary</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">col</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">outliers</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">outliers</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_train_new</span><span class="p">),</span> <span class="mi">2</span><span class="p">)))</span>

<span class="n">outliers_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">outliers_summary</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Variable&#39;</span><span class="p">,</span> <span class="s1">&#39;N° Outliers&#39;</span><span class="p">,</span> <span class="s1">&#39;% Outliers&#39;</span><span class="p">])</span>
<span class="n">outliers_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;% Outliers&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Outliers</span>
<span class="n">top_outliers</span> <span class="o">=</span> <span class="n">outliers_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;% Outliers&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)[</span><span class="s1">&#39;Variable&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">top_outliers</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;D5&#39;, &#39;D2&#39;, &#39;dist1&#39;, &#39;D3&#39;, &#39;V11&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">outliers_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;% Outliers&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable</th>
      <th>N° Outliers</th>
      <th>% Outliers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>19</th>
      <td>D5</td>
      <td>276569</td>
      <td>46.83</td>
    </tr>
    <tr>
      <th>16</th>
      <td>D2</td>
      <td>248677</td>
      <td>42.11</td>
    </tr>
    <tr>
      <th>8</th>
      <td>dist1</td>
      <td>230538</td>
      <td>39.04</td>
    </tr>
    <tr>
      <th>17</th>
      <td>D3</td>
      <td>182515</td>
      <td>30.91</td>
    </tr>
    <tr>
      <th>39</th>
      <td>V11</td>
      <td>141620</td>
      <td>23.98</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>201</th>
      <td>V305</td>
      <td>4</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>5</th>
      <td>card5</td>
      <td>0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>card2</td>
      <td>0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>card1</td>
      <td>0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>0</th>
      <td>TransactionDT</td>
      <td>0</td>
      <td>0.00</td>
    </tr>
  </tbody>
</table>
<p>229 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#grafico</span>
<span class="n">variables_a_graficar</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">top_outliers</span><span class="p">))</span>
<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">variables_a_graficar</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_train_new</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;isFraud&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">var</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Boxplot de </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1"> según isFraud&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;isFraud&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c0c8447b49d8e385416b4eb90a055dd84664bbb74002e5844453091089701e4d.png" src="../_images/c0c8447b49d8e385416b4eb90a055dd84664bbb74002e5844453091089701e4d.png" />
<img alt="../_images/1f0fab05af5b7328549bf8d43ef256caf90db086f9075c0ce5a89ca9081d9bb1.png" src="../_images/1f0fab05af5b7328549bf8d43ef256caf90db086f9075c0ce5a89ca9081d9bb1.png" />
<img alt="../_images/8cf1e6c0f7eb395459614b392acb2e9be96db2b191acef2344d5b30634f389f8.png" src="../_images/8cf1e6c0f7eb395459614b392acb2e9be96db2b191acef2344d5b30634f389f8.png" />
<img alt="../_images/9fea9ea5e4c125557179b5db22edf0a696f8db858a3fc674ee6d5d9235e44e16.png" src="../_images/9fea9ea5e4c125557179b5db22edf0a696f8db858a3fc674ee6d5d9235e44e16.png" />
<img alt="../_images/c98a0239b244d48a56dd5fab8bb640a3959e274e7b38a5235b802dbd00056081.png" src="../_images/c98a0239b244d48a56dd5fab8bb640a3959e274e7b38a5235b802dbd00056081.png" />
</div>
</div>
<p>Interpretación variable por variable</p>
<ol class="arabic simple">
<li><p>D5
Esta variable presenta un altísimo porcentaje de outliers (casi el 47%). El boxplot revela que una gran cantidad de transacciones legítimas tienen valores muy elevados, mientras que las fraudulentas tienden a estar en un rango más bajo. Esto podría significar que los valores extremos en D5 están más asociados a comportamiento legítimo, por lo que eliminar directamente estos outliers podría ser riesgoso, ya que representan una parte natural del comportamiento normal.</p></li>
</ol>
<p>Recomendación: Transformación (logarítmica o winsorización), no eliminación directa.</p>
<ol class="arabic simple" start="2">
<li><p>D2
Con más del 42% de valores fuera del rango intercuartílico, D2 también muestra una alta presencia de outliers. Sin embargo, el boxplot sugiere que los valores extremos pueden tener una distribución diferenciada entre clases (isFraud), lo que podría ser información útil para el modelo.</p></li>
</ol>
<p>Recomendación: Aplicar una transformación de escala (como log1p) o analizar si los outliers corresponden a una subpoblación relevante.</p>
<ol class="arabic simple" start="3">
<li><p>dist1
Casi el 40% de los valores son outliers. Esta variable parece relacionada con la distancia entre ubicaciones (por ejemplo, dirección de facturación y dirección de envío). En este caso, los valores extremos podrían reflejar riesgo real (por ejemplo, envíos desde regiones remotas o cambios inusuales de dirección).</p></li>
</ol>
<p>Recomendación: No eliminar los outliers, sino mantenerlos y transformarlos si es necesario. También se puede usar como variable binaria: “¿hay distancia? sí/no”.</p>
<ol class="arabic simple" start="4">
<li><p>D3
Al igual que las anteriores, D3 tiene un 30% de valores atípicos. El boxplot muestra un rango estrecho de valores normales y una gran dispersión de valores elevados. Es posible que esta variable refleje tiempos de inactividad o latencias que, en valores extremos, se asocian con fraude.</p></li>
</ol>
<p>Recomendación: Aplicar transformación logarítmica, y si fuera necesario, crear una variable indicadora para marcar valores extremos.</p>
<ol class="arabic simple" start="5">
<li><p>V11
Aunque el porcentaje de outliers es menor (24%), los boxplots muestran una concentración clara de valores bajos (posiblemente todos iguales) con algunos valores aislados que se comportan como outliers. Dado que esta variable parece tener poca variabilidad salvo por algunos valores, podría evaluarse también por su importancia predictiva o varianza.</p></li>
</ol>
<p>Recomendación: Si los outliers se asocian con fraude, mantenerlos. Si no aportan valor, considerar eliminar la variable.</p>
</section>
<section id="analisis-de-dispersion">
<h2>Analisis de Dispersión<a class="headerlink" href="#analisis-de-dispersion" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dispersion_df</span> <span class="o">=</span> <span class="n">df_train_new</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;number&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;isFraud&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="s1">&#39;var&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="n">dispersion_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Desviación estándar&#39;</span><span class="p">,</span> <span class="s1">&#39;Varianza&#39;</span><span class="p">]</span>
<span class="n">dispersion_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Desviación estándar&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">top_dispersion</span> <span class="o">=</span> <span class="n">dispersion_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Desviación estándar&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">top_dispersion</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;TransactionDT&#39;, &#39;id_02&#39;, &#39;V160&#39;, &#39;card1&#39;, &#39;V164&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dispersion_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Desviación estándar&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Desviación estándar</th>
      <th>Varianza</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>TransactionDT</th>
      <td>4.617224e+06</td>
      <td>2.131875e+13</td>
    </tr>
    <tr>
      <th>id_02</th>
      <td>8.071476e+04</td>
      <td>6.514873e+09</td>
    </tr>
    <tr>
      <th>V160</th>
      <td>5.541040e+04</td>
      <td>3.070313e+09</td>
    </tr>
    <tr>
      <th>card1</th>
      <td>4.901170e+03</td>
      <td>2.402147e+07</td>
    </tr>
    <tr>
      <th>V164</th>
      <td>2.273784e+03</td>
      <td>5.170095e+06</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>V41</th>
      <td>2.283168e-02</td>
      <td>5.212854e-04</td>
    </tr>
    <tr>
      <th>V14</th>
      <td>2.085680e-02</td>
      <td>4.350062e-04</td>
    </tr>
    <tr>
      <th>V107</th>
      <td>2.048851e-02</td>
      <td>4.197790e-04</td>
    </tr>
    <tr>
      <th>V65</th>
      <td>1.711335e-02</td>
      <td>2.928669e-04</td>
    </tr>
    <tr>
      <th>V241</th>
      <td>1.065143e-02</td>
      <td>1.134529e-04</td>
    </tr>
  </tbody>
</table>
<p>227 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#grafico</span>
<span class="n">variables_a_graficar</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">top_dispersion</span><span class="p">))</span>
<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">variables_a_graficar</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_train_new</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;isFraud&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">var</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Boxplot de </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1"> según isFraud&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;isFraud&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f5b6c1b64e6b54b7ec8c2de154727a3762e0c84773188837fade28bf18850ec7.png" src="../_images/f5b6c1b64e6b54b7ec8c2de154727a3762e0c84773188837fade28bf18850ec7.png" />
<img alt="../_images/8abdff8c0361e57ab14f66fcbd5a3f28b126d3d875185eb7925127e7beab4b66.png" src="../_images/8abdff8c0361e57ab14f66fcbd5a3f28b126d3d875185eb7925127e7beab4b66.png" />
<img alt="../_images/270513794f8b2d9867a8a0ae8e472858654e8a233b18173a0a02b2a21ac6a96d.png" src="../_images/270513794f8b2d9867a8a0ae8e472858654e8a233b18173a0a02b2a21ac6a96d.png" />
<img alt="../_images/13810e7b401bcb0b087a91d09e5929b73ca420ef9ddf38c842aa42b3734d3527.png" src="../_images/13810e7b401bcb0b087a91d09e5929b73ca420ef9ddf38c842aa42b3734d3527.png" />
<img alt="../_images/b07eaf440bf27ae7d955ffb00b95790ad724569fc9869f49defff15add312dce.png" src="../_images/b07eaf440bf27ae7d955ffb00b95790ad724569fc9869f49defff15add312dce.png" />
</div>
</div>
<ol class="arabic simple">
<li><p>TransactionDT
Desviación estándar: 4,617,224</p></li>
</ol>
<p>Varianza: 2.13 × 10¹³</p>
<p>Interpretación: Esta variable representa el timestamp de la transacción. Su alta dispersión es completamente esperada y lógica, ya que representa una variable acumulativa en el tiempo. El boxplot muestra una distribución uniforme entre las clases (isFraud = 0 y 1), lo cual es típico en variables temporales.</p>
<p>Recomendación:
✔️ Mantener.
🛠️ Puedes considerar transformarla en variables derivadas más útiles: día, hora, semana, etc. (TransactionDT → TransactionHour, TransactionDay).</p>
<ol class="arabic simple" start="2">
<li><p>id_02
Desviación estándar: 80,714</p></li>
</ol>
<p>Varianza: 6.5 × 10⁹</p>
<p>Interpretación: Esta variable presenta una dispersión alta y una gran cantidad de valores extremos (confirmado por el boxplot). Sin embargo, se observa un patrón interesante: las transacciones fraudulentas tienden a concentrarse en un rango más reducido, lo que puede ser útil para discriminación.</p>
<p>Recomendación:
✔️ Mantener.
🔄 Aplicar una transformación logarítmica o StandardScaler para normalizar.</p>
<ol class="arabic simple" start="3">
<li><p>V160
Desviación estándar: 55,410</p></li>
</ol>
<p>Varianza: 3.07 × 10⁹</p>
<p>Interpretación: Muestra una dispersión significativa y outliers muy marcados, especialmente en la clase isFraud = 1, lo cual podría ser un patrón útil. Esta variable tiene potencial discriminativo y su comportamiento no debe ignorarse.</p>
<p>Recomendación:
✔️ Mantener.
🔄 Aplicar log1p o estandarización.
📌 Opción interesante para modelos de árboles, pero escalar si se usa regresión o KNN.</p>
<ol class="arabic simple" start="4">
<li><p>card1
Desviación estándar: 4,901</p></li>
</ol>
<p>Varianza: 2.4 × 10⁷</p>
<p>Interpretación: Aunque su varianza es alta, el boxplot indica una distribución bastante balanceada y simétrica entre las clases. Esto sugiere que es una variable numérica estable (como un ID de cliente anonimizador), con una utilidad potencial en la identificación de patrones individuales.</p>
<p>Recomendación:
✔️ Mantener.
📌 No escalarla como variable continua si representa un identificador. En su lugar, puede considerarse frecuencia encoding o binarización (Top N cards).</p>
<ol class="arabic simple" start="5">
<li><p>V164
Desviación estándar: 2,274</p></li>
</ol>
<p>Varianza: 5.17 × 10⁶</p>
<p>Interpretación: Aunque su dispersión es la menor del grupo, sigue siendo significativa. Los boxplots indican mayor densidad de valores bajos y algunos outliers en la clase isFraud, lo que podría aportar cierta utilidad.</p>
<p>Recomendación:
✔️ Mantener.
🔄 Aplicar una transformación moderada (raíz cuadrada, log1p) para reducir el impacto de valores extremos.</p>
</section>
<section id="variables-casi-constantes">
<h2>Variables casi constantes<a class="headerlink" href="#variables-casi-constantes" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parámetros de corte</span>
<span class="n">umbral_varianza</span> <span class="o">=</span> <span class="mf">0.0001</span>
<span class="n">umbral_frecuencia</span> <span class="o">=</span> <span class="mf">0.99</span>

<span class="c1"># Variables numéricas del dataset</span>
<span class="n">num_cols</span> <span class="o">=</span> <span class="n">df_train_new</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;number&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Detectar variables casi constantes</span>
<span class="n">variables_casi_constantes</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">num_cols</span><span class="p">:</span>
    <span class="n">varianza</span> <span class="o">=</span> <span class="n">df_train_new</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
    <span class="n">frec_max</span> <span class="o">=</span> <span class="n">df_train_new</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># proporción del valor más común</span>
    <span class="k">if</span> <span class="n">varianza</span> <span class="o">&lt;</span> <span class="n">umbral_varianza</span> <span class="ow">and</span> <span class="n">frec_max</span> <span class="o">&gt;</span> <span class="n">umbral_frecuencia</span><span class="p">:</span>
        <span class="n">variables_casi_constantes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>

<span class="c1"># Mostrar variables detectadas</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variables detectadas como casi constantes:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">variables_casi_constantes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variables detectadas como casi constantes:
[&#39;V1&#39;, &#39;V305&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Eliminar del dataset</span>
<span class="n">df_train_new</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">variables_casi_constantes</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Se eliminaron </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">variables_casi_constantes</span><span class="p">)</span><span class="si">}</span><span class="s2"> variables. Nuevo shape: </span><span class="si">{</span><span class="n">df_train_new</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Se eliminaron 2 variables. Nuevo shape: (590540, 252)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.feature_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">mutual_info_classif</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">LabelEncoder</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># train_transaction = pd.read_csv(&#39;train_transaction.csv&#39;)</span>
<span class="n">df_train_new</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;df_train_new.csv&#39;</span><span class="p">)</span>
<span class="n">df_train_new</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>isFraud</th>
      <th>TransactionDT</th>
      <th>TransactionAmt</th>
      <th>card1</th>
      <th>card2</th>
      <th>card3</th>
      <th>card5</th>
      <th>addr1</th>
      <th>addr2</th>
      <th>dist1</th>
      <th>...</th>
      <th>id_35</th>
      <th>id_36</th>
      <th>id_37</th>
      <th>DeviceType</th>
      <th>DeviceInfo</th>
      <th>id_31_simplified</th>
      <th>DeviceInfo_simplified</th>
      <th>id_35_simplified</th>
      <th>DeviceType_simplified</th>
      <th>card6_simplified</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>86400.0</td>
      <td>68.5</td>
      <td>13926.0</td>
      <td>361.0</td>
      <td>150.0</td>
      <td>142.0</td>
      <td>315.0</td>
      <td>87.0</td>
      <td>19.0</td>
      <td>...</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>desktop</td>
      <td>Windows</td>
      <td>chrome 63.0</td>
      <td>Windows</td>
      <td>T</td>
      <td>desktop</td>
      <td>credit</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>86401.0</td>
      <td>29.0</td>
      <td>2755.0</td>
      <td>404.0</td>
      <td>150.0</td>
      <td>102.0</td>
      <td>325.0</td>
      <td>87.0</td>
      <td>8.0</td>
      <td>...</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>desktop</td>
      <td>Windows</td>
      <td>chrome 63.0</td>
      <td>Windows</td>
      <td>T</td>
      <td>desktop</td>
      <td>credit</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>86469.0</td>
      <td>59.0</td>
      <td>4663.0</td>
      <td>490.0</td>
      <td>150.0</td>
      <td>166.0</td>
      <td>330.0</td>
      <td>87.0</td>
      <td>287.0</td>
      <td>...</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>desktop</td>
      <td>Windows</td>
      <td>chrome 63.0</td>
      <td>Windows</td>
      <td>T</td>
      <td>desktop</td>
      <td>debit</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>86499.0</td>
      <td>50.0</td>
      <td>18132.0</td>
      <td>567.0</td>
      <td>150.0</td>
      <td>117.0</td>
      <td>476.0</td>
      <td>87.0</td>
      <td>8.0</td>
      <td>...</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>desktop</td>
      <td>Windows</td>
      <td>chrome 63.0</td>
      <td>Windows</td>
      <td>T</td>
      <td>desktop</td>
      <td>debit</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>86506.0</td>
      <td>50.0</td>
      <td>4497.0</td>
      <td>514.0</td>
      <td>150.0</td>
      <td>102.0</td>
      <td>420.0</td>
      <td>87.0</td>
      <td>8.0</td>
      <td>...</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>mobile</td>
      <td>SAMSUNG SM-G892A Build/NRD90M</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>T</td>
      <td>mobile</td>
      <td>credit</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 252 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train_new</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 590540 entries, 0 to 590539
Columns: 252 entries, isFraud to card6_simplified
dtypes: float64(228), object(24)
memory usage: 1.1+ GB
</pre></div>
</div>
</div>
</div>
</section>
<section id="analisis-bivariado">
<h2>Analisis bivariado<a class="headerlink" href="#analisis-bivariado" title="Link to this heading">#</a></h2>
<p>4 pares de variables explicativas:</p>
<p>Tomando en cuenta lo analizado (dispersión, importancia, y outliers), se deciden seleccionar los siguientes pares de variables explicativas para realizar el analisis bivariado:</p>
<ul class="simple">
<li><p>V160 vs id_02 → ambas con alta varianza y potencial relevancia para fraude.</p></li>
<li><p>V164 vs D2 → ambas variables dispersas, con valores extremos interesantes.</p></li>
<li><p>card1 vs D5 → puede mostrar agrupamientos por cliente y diferencias en comportamiento temporal.</p></li>
<li><p>dist1 vs D3 → relación entre distancias de dirección y tiempo desde la última transacción.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pares</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;V160&#39;</span><span class="p">,</span> <span class="s1">&#39;id_02&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;V164&#39;</span><span class="p">,</span> <span class="s1">&#39;D2&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;card1&#39;</span><span class="p">,</span> <span class="s1">&#39;D5&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;dist1&#39;</span><span class="p">,</span> <span class="s1">&#39;D3&#39;</span><span class="p">)</span>
<span class="p">]</span>

<span class="c1"># Scatterplot y Regplot para cada par</span>
<span class="k">for</span> <span class="n">x_var</span><span class="p">,</span> <span class="n">y_var</span> <span class="ow">in</span> <span class="n">pares</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_train_new</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x_var</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_var</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;isFraud&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Scatterplot de </span><span class="si">{</span><span class="n">x_var</span><span class="si">}</span><span class="s1"> vs </span><span class="si">{</span><span class="n">y_var</span><span class="si">}</span><span class="s1"> por isFraud&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_train_new</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x_var</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_var</span><span class="p">,</span> <span class="n">scatter_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">},</span> <span class="n">line_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">})</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Regplot de </span><span class="si">{</span><span class="n">x_var</span><span class="si">}</span><span class="s1"> vs </span><span class="si">{</span><span class="n">y_var</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\kelly\.conda\envs\sklearn_env\lib\site-packages\IPython\core\pylabtools.py:170: UserWarning: Creating legend with loc=&quot;best&quot; can be slow with large amounts of data.
  fig.canvas.print_figure(bytes_io, **kw)
</pre></div>
</div>
<img alt="../_images/db30425f9c5e25433eaedb4c68b20a8d2a42e69866e8a85a0a017ff2570341e2.png" src="../_images/db30425f9c5e25433eaedb4c68b20a8d2a42e69866e8a85a0a017ff2570341e2.png" />
<img alt="../_images/646d7e6ecb2d2cb5afc047c94cd392abafa800f7e73b7e827f65c97410c7e412.png" src="../_images/646d7e6ecb2d2cb5afc047c94cd392abafa800f7e73b7e827f65c97410c7e412.png" />
<img alt="../_images/5e36fea462e466a247df5511a0803c5cafed371441392060433d59f648122e26.png" src="../_images/5e36fea462e466a247df5511a0803c5cafed371441392060433d59f648122e26.png" />
<img alt="../_images/98f565a452b00f5f2634cb6a21d5b642589eb88473358579c0dcb9a0daf894f5.png" src="../_images/98f565a452b00f5f2634cb6a21d5b642589eb88473358579c0dcb9a0daf894f5.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\kelly\.conda\envs\sklearn_env\lib\site-packages\IPython\core\pylabtools.py:170: UserWarning: Creating legend with loc=&quot;best&quot; can be slow with large amounts of data.
  fig.canvas.print_figure(bytes_io, **kw)
</pre></div>
</div>
<img alt="../_images/ed8689bfa4438dc0aed82654feaf8dc4441ccdbe1c2ddbf034ee4065223ce7fb.png" src="../_images/ed8689bfa4438dc0aed82654feaf8dc4441ccdbe1c2ddbf034ee4065223ce7fb.png" />
<img alt="../_images/7a935dc897b8d843b9624db5ff47451de1d690d2a230d28756c32f02bff8be69.png" src="../_images/7a935dc897b8d843b9624db5ff47451de1d690d2a230d28756c32f02bff8be69.png" />
<img alt="../_images/fdc2d01cdfee2d251e6d9cb212b5ef971266c5726b9152b8542a443e2215a3e5.png" src="../_images/fdc2d01cdfee2d251e6d9cb212b5ef971266c5726b9152b8542a443e2215a3e5.png" />
<img alt="../_images/8206b8208bf2fac076a5ba927bc27baea115a3870579ac9496179470e93a374c.png" src="../_images/8206b8208bf2fac076a5ba927bc27baea115a3870579ac9496179470e93a374c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<p>Análisis Bivariado: V160 vs id_02
📈 Scatterplot con isFraud
Se observa una alta concentración de puntos en valores bajos de V160, especialmente cercanos al eje vertical (valores de V160 cercanos a 0), con una dispersión amplia de id_02.</p>
<p>Las observaciones etiquetadas como fraude (isFraud = 1, en naranja) están mayoritariamente concentradas en la zona de menor V160 y menor id_02, aunque también hay algunas dispersas hacia valores altos de id_02.</p>
<p>No hay una separación clara entre clases, pero sí se nota que los fraudes tienden a concentrarse en una región más compacta del gráfico, lo cual sugiere que el patrón conjunto de bajos valores en ambas variables podría tener relevancia.</p>
<p>📊 Regplot
La línea de regresión es prácticamente horizontal o ligeramente descendente, indicando que no hay una relación lineal fuerte entre V160 e id_02.</p>
<p>Sin embargo, el alto nivel de dispersión vertical y los outliers extremos podrían estar afectando esta pendiente.</p>
<p>Esto sugiere que aunque la relación lineal no es fuerte, puede existir una interacción relevante desde el punto de vista no lineal o en términos de densidad localizada (zonas de alta frecuencia de fraude).</p>
<p>Análisis Bivariado: V164 vs D2
📈 Scatterplot con isFraud
El gráfico muestra una alta concentración de puntos en los valores bajos de ambas variables, especialmente cuando V164 &lt; 20,000 y D2 &lt; 150.</p>
<p>La mayoría de los puntos con isFraud = 1 (fraude) están localizados en la parte inferior izquierda, con baja dispersión en ambas variables, lo que sugiere un patrón particular de comportamiento de fraude en ese rango.</p>
<p>Hay valores extremos en V164, pero casi todos están asociados con isFraud = 0 (transacciones legítimas), lo que podría ser útil para distinguir entre clases.</p>
<p>📊 Regplot
La línea de regresión muestra una pendiente negativa clara, indicando que a medida que V164 aumenta, D2 tiende a disminuir.</p>
<p>Esto sugiere una relación lineal inversa, aunque débil, entre ambas variables. Puede reflejar que transacciones con ciertos valores altos en V164 tienden a presentar menos actividad reciente en D2 (por ejemplo, menor cantidad de días desde una transacción anterior).</p>
<p>Análisis Bivariado: card1 vs D5
📈 Scatterplot con isFraud
La variable card1 representa un identificador anónimo del titular de la tarjeta, mientras que D5 está relacionada con una medida temporal (como días desde el último evento).</p>
<p>En el scatterplot se evidencia una distribución uniforme y densa, con puntos dispersos de isFraud = 1 (fraude) a lo largo de todo el rango de card1.</p>
<p>No se observan agrupamientos definidos por clase. Los fraudes están esparcidos, y la relación entre card1 y D5 no parece tener estructura visual evidente.</p>
<p>📊 Regplot
La línea de regresión es casi completamente horizontal, lo que indica que no existe una relación lineal significativa entre estas dos variables.</p>
<p>Dado que card1 es más bien una variable identificadora o categórica codificada numéricamente, no se espera que tenga relación directa con una variable continua como D5.</p>
<p>Análisis Bivariado: dist1 vs D3
📈 Scatterplot con isFraud
Se observa una alta concentración de puntos en la esquina inferior izquierda del gráfico, donde tanto dist1 como D3 tienen valores bajos.</p>
<p>Las observaciones fraudulentas (isFraud = 1) también se ubican mayoritariamente en esa zona, lo que sugiere que transacciones con poca distancia entre direcciones (dist1) y pocos días desde la última transacción (D3) podrían tener mayor riesgo.</p>
<p>A medida que dist1 aumenta, la dispersión de D3 disminuye, mostrando un patrón triangular hacia la derecha.</p>
<p>📊 Regplot
La línea de regresión muestra una pendiente negativa poco pronunciada, lo que indica una relación inversa débil entre ambas variables: cuando dist1 es mayor, tiende a haber menor D3.</p>
<p>Aunque no hay una relación fuerte, la forma del gráfico sugiere que la información conjunta de estos valores bajos puede ser útil para modelar comportamientos sospechosos o atípicos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Seleccionar columnas categóricas</span>
<span class="n">cat_cols</span> <span class="o">=</span> <span class="n">df_train_new</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span>

<span class="c1"># Contar número de categorías únicas por variable</span>
<span class="n">cat_summary</span> <span class="o">=</span> <span class="n">df_train_new</span><span class="p">[</span><span class="n">cat_cols</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Mostrar resumen</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Número de categorías por variable categórica:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cat_summary</span><span class="p">)</span>

<span class="c1"># Si quieres como DataFrame para análisis posterior</span>
<span class="n">cat_summary_df</span> <span class="o">=</span> <span class="n">cat_summary</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">cat_summary_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Variable&#39;</span><span class="p">,</span> <span class="s1">&#39;N° Categorías&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Número de categorías por variable categórica:
DeviceInfo               1786
id_33                     260
id_31                     130
id_30                      75
R_emaildomain              60
P_emaildomain              59
DeviceInfo_simplified      11
id_31_simplified           11
id_34                       4
card6                       4
card4                       4
card6_simplified            4
id_15                       3
id_29                       2
id_28                       2
id_16                       2
id_35                       2
id_36                       2
id_37                       2
DeviceType                  2
id_12                       2
M1                          2
id_35_simplified            2
DeviceType_simplified       2
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.compose</span><span class="w"> </span><span class="kn">import</span> <span class="n">ColumnTransformer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">OneHotEncoder</span><span class="p">,</span> <span class="n">OrdinalEncoder</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">category_encoders</span><span class="w"> </span><span class="kn">import</span> <span class="n">TargetEncoder</span><span class="p">,</span> <span class="n">FrequencyEncoder</span>

<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">([</span>
    <span class="c1"># Grupo 1 y 2 - Alta y Moderada cardinalidad →  Frequency Encoding</span>
    <span class="p">(</span><span class="s1">&#39;freq&#39;</span><span class="p">,</span> <span class="n">FrequencyEncoder</span><span class="p">(),</span> <span class="p">[</span><span class="s1">&#39;DeviceInfo&#39;</span><span class="p">,</span> <span class="s1">&#39;id_33&#39;</span><span class="p">,</span> <span class="s1">&#39;id_31&#39;</span><span class="p">,</span> <span class="s1">&#39;id_30&#39;</span><span class="p">,</span> <span class="s1">&#39;R_emaildomain&#39;</span><span class="p">,</span> <span class="s1">&#39;P_emaildomain&#39;</span><span class="p">,</span> <span class="s1">&#39;DeviceInfo_simplified&#39;</span><span class="p">,</span> <span class="s1">&#39;id_31_simplified&#39;</span><span class="p">]),</span>

    <span class="c1"># Grupo 3 - Baja → One-Hot</span>
    <span class="p">(</span><span class="s1">&#39;ohe_low&#39;</span><span class="p">,</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">handle_unknown</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">),</span> <span class="p">[</span>
        <span class="s1">&#39;id_34&#39;</span><span class="p">,</span> <span class="s1">&#39;card6&#39;</span><span class="p">,</span> <span class="s1">&#39;card4&#39;</span><span class="p">,</span> <span class="s1">&#39;card6_simplified&#39;</span><span class="p">,</span> <span class="s1">&#39;id_15&#39;</span><span class="p">,</span> <span class="s1">&#39;id_29&#39;</span><span class="p">,</span> <span class="s1">&#39;id_28&#39;</span><span class="p">,</span> <span class="s1">&#39;id_16&#39;</span><span class="p">,</span>
        <span class="s1">&#39;id_35&#39;</span><span class="p">,</span> <span class="s1">&#39;id_36&#39;</span><span class="p">,</span> <span class="s1">&#39;id_37&#39;</span><span class="p">,</span> <span class="s1">&#39;DeviceType&#39;</span><span class="p">,</span> <span class="s1">&#39;id_12&#39;</span><span class="p">,</span> <span class="s1">&#39;M1&#39;</span><span class="p">,</span> <span class="s1">&#39;id_35_simplified&#39;</span><span class="p">,</span> <span class="s1">&#39;DeviceType_simplified&#39;</span>
    <span class="p">])</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.compose</span><span class="w"> </span><span class="kn">import</span> <span class="n">ColumnTransformer</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">OneHotEncoder</span><span class="p">,</span> <span class="n">OrdinalEncoder</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="kn">from</span><span class="w"> </span><span class="nn">category_encoders</span><span class="w"> </span><span class="kn">import</span> <span class="n">TargetEncoder</span><span class="p">,</span> <span class="n">FrequencyEncoder</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">([</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>     <span class="c1"># Grupo 1 y 2 - Alta y Moderada cardinalidad →  Frequency Encoding</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span>     <span class="p">(</span><span class="s1">&#39;freq&#39;</span><span class="p">,</span> <span class="n">FrequencyEncoder</span><span class="p">(),</span> <span class="p">[</span><span class="s1">&#39;DeviceInfo&#39;</span><span class="p">,</span> <span class="s1">&#39;id_33&#39;</span><span class="p">,</span> <span class="s1">&#39;id_31&#39;</span><span class="p">,</span> <span class="s1">&#39;id_30&#39;</span><span class="p">,</span> <span class="s1">&#39;R_emaildomain&#39;</span><span class="p">,</span> <span class="s1">&#39;P_emaildomain&#39;</span><span class="p">,</span> <span class="s1">&#39;DeviceInfo_simplified&#39;</span><span class="p">,</span> <span class="s1">&#39;id_31_simplified&#39;</span><span class="p">]),</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span>     <span class="p">])</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span> <span class="p">])</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;category_encoders&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.compose</span><span class="w"> </span><span class="kn">import</span> <span class="n">ColumnTransformer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">OneHotEncoder</span><span class="p">,</span> <span class="n">StandardScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">category_encoders.count</span><span class="w"> </span><span class="kn">import</span> <span class="n">CountEncoder</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definición de grupos</span>
<span class="n">cat_high_mod</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DeviceInfo&#39;</span><span class="p">,</span> <span class="s1">&#39;id_33&#39;</span><span class="p">,</span> <span class="s1">&#39;id_31&#39;</span><span class="p">,</span> <span class="s1">&#39;id_30&#39;</span><span class="p">,</span> <span class="s1">&#39;R_emaildomain&#39;</span><span class="p">,</span> <span class="s1">&#39;P_emaildomain&#39;</span><span class="p">,</span>
                <span class="s1">&#39;DeviceInfo_simplified&#39;</span><span class="p">,</span> <span class="s1">&#39;id_31_simplified&#39;</span><span class="p">]</span>
<span class="n">cat_low</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id_34&#39;</span><span class="p">,</span> <span class="s1">&#39;card6&#39;</span><span class="p">,</span> <span class="s1">&#39;card4&#39;</span><span class="p">,</span> <span class="s1">&#39;card6_simplified&#39;</span><span class="p">,</span> <span class="s1">&#39;id_15&#39;</span><span class="p">,</span> <span class="s1">&#39;id_29&#39;</span><span class="p">,</span> <span class="s1">&#39;id_28&#39;</span><span class="p">,</span> <span class="s1">&#39;id_16&#39;</span><span class="p">,</span>
           <span class="s1">&#39;id_35&#39;</span><span class="p">,</span> <span class="s1">&#39;id_36&#39;</span><span class="p">,</span> <span class="s1">&#39;id_37&#39;</span><span class="p">,</span> <span class="s1">&#39;DeviceType&#39;</span><span class="p">,</span> <span class="s1">&#39;id_12&#39;</span><span class="p">,</span> <span class="s1">&#39;M1&#39;</span><span class="p">,</span> <span class="s1">&#39;id_35_simplified&#39;</span><span class="p">,</span> <span class="s1">&#39;DeviceType_simplified&#39;</span><span class="p">]</span>

<span class="n">num_cols</span> <span class="o">=</span> <span class="n">df_train_new</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;int64&#39;</span><span class="p">,</span> <span class="s1">&#39;float64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;freq&#39;</span><span class="p">,</span> <span class="n">CountEncoder</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">cat_high_mod</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;ohe_low&#39;</span><span class="p">,</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">handle_unknown</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">sparse_output</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">cat_low</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">(),</span> <span class="n">num_cols</span><span class="p">)</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="modelos-de-clasificacion">
<h1><strong>Modelos de Clasificación</strong><a class="headerlink" href="#modelos-de-clasificacion" title="Link to this heading">#</a></h1>
<section id="preprocesamiento">
<h2>Preprocesamiento<a class="headerlink" href="#preprocesamiento" title="Link to this heading">#</a></h2>
<p>Dado el tamaño considerable del conjunto de entrenamiento original, que contenía más de 590,000 registros, se optó por utilizar una muestra estratificada de 150,000 transacciones con el fin de optimizar el tiempo de cómputo durante la fase de entrenamiento de los modelos. Esta decisión permitió mantener la eficiencia en el proceso de validación cruzada y búsqueda de hiperparámetros, sin comprometer la representatividad de los datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Crear muestra estratificada de 150,000 registros desde df_train_new</span>
<span class="n">df_sample_150k</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">df_train_new</span><span class="p">,</span>
    <span class="n">train_size</span><span class="o">=</span><span class="mi">150000</span><span class="p">,</span>
    <span class="n">stratify</span><span class="o">=</span><span class="n">df_train_new</span><span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">],</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>

<span class="c1"># Separar variables predictoras y objetivo</span>
<span class="n">X_sample_150k</span> <span class="o">=</span> <span class="n">df_sample_150k</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">])</span>
<span class="n">y_sample_150k</span> <span class="o">=</span> <span class="n">df_sample_150k</span><span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">]</span>

<span class="c1"># Confirmar distribución</span>
<span class="n">distribucion</span> <span class="o">=</span> <span class="n">y_sample_150k</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">len_muestra</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_sample_150k</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">X_sample_150k</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y_sample_150k</span>

<span class="n">distribucion</span><span class="p">,</span> <span class="n">len_muestra</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(isFraud
 0.0    0.965007
 1.0    0.034993
 Name: proportion, dtype: float64,
 150000)
</pre></div>
</div>
</div>
</div>
<p>La muestra fue generada utilizando la técnica de muestreo estratificado basada en la variable objetivo isFraud, asegurando que la proporción de transacciones fraudulentas y no fraudulentas en la muestra se conservara de forma similar a la distribución del conjunto original. Esto garantiza que los modelos entrenados sobre esta muestra puedan aprender patrones consistentes y representativos del comportamiento real del problema.</p>
<p>Además, se estableció una semilla aleatoria (random_state=42) para asegurar la reproducibilidad de los resultados. De esta forma, se preservó la integridad estadística del conjunto de entrenamiento mientras se reducían significativamente los tiempos de ejecución y carga computacional del pipeline de modelado.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TransactionDT</th>
      <th>TransactionAmt</th>
      <th>card1</th>
      <th>card2</th>
      <th>card3</th>
      <th>card5</th>
      <th>addr1</th>
      <th>addr2</th>
      <th>dist1</th>
      <th>dist2</th>
      <th>...</th>
      <th>id_35</th>
      <th>id_36</th>
      <th>id_37</th>
      <th>DeviceType</th>
      <th>DeviceInfo</th>
      <th>id_31_simplified</th>
      <th>DeviceInfo_simplified</th>
      <th>id_35_simplified</th>
      <th>DeviceType_simplified</th>
      <th>card6_simplified</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>169524</th>
      <td>3635485.0</td>
      <td>30.950</td>
      <td>7508.0</td>
      <td>321.0</td>
      <td>150.0</td>
      <td>226.0</td>
      <td>220.0</td>
      <td>87.0</td>
      <td>2.0</td>
      <td>37.0</td>
      <td>...</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>desktop</td>
      <td>Windows</td>
      <td>chrome 63.0</td>
      <td>Windows</td>
      <td>T</td>
      <td>desktop</td>
      <td>debit</td>
    </tr>
    <tr>
      <th>562164</th>
      <td>14899778.0</td>
      <td>161.000</td>
      <td>8468.0</td>
      <td>111.0</td>
      <td>150.0</td>
      <td>219.0</td>
      <td>272.0</td>
      <td>87.0</td>
      <td>5.0</td>
      <td>37.0</td>
      <td>...</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>desktop</td>
      <td>Windows</td>
      <td>chrome 63.0</td>
      <td>Windows</td>
      <td>T</td>
      <td>desktop</td>
      <td>credit</td>
    </tr>
    <tr>
      <th>157884</th>
      <td>3284432.0</td>
      <td>13.992</td>
      <td>9633.0</td>
      <td>296.0</td>
      <td>185.0</td>
      <td>138.0</td>
      <td>299.0</td>
      <td>87.0</td>
      <td>8.0</td>
      <td>37.0</td>
      <td>...</td>
      <td>F</td>
      <td>F</td>
      <td>F</td>
      <td>mobile</td>
      <td>Windows</td>
      <td>mobile safari 11.0</td>
      <td>Windows</td>
      <td>F</td>
      <td>mobile</td>
      <td>debit</td>
    </tr>
    <tr>
      <th>42485</th>
      <td>1027698.0</td>
      <td>50.000</td>
      <td>7482.0</td>
      <td>490.0</td>
      <td>150.0</td>
      <td>226.0</td>
      <td>299.0</td>
      <td>87.0</td>
      <td>8.0</td>
      <td>37.0</td>
      <td>...</td>
      <td>T</td>
      <td>F</td>
      <td>F</td>
      <td>desktop</td>
      <td>Windows</td>
      <td>Otros</td>
      <td>Windows</td>
      <td>T</td>
      <td>desktop</td>
      <td>debit</td>
    </tr>
    <tr>
      <th>191589</th>
      <td>4302161.0</td>
      <td>557.100</td>
      <td>16988.0</td>
      <td>346.0</td>
      <td>150.0</td>
      <td>203.0</td>
      <td>310.0</td>
      <td>87.0</td>
      <td>17.0</td>
      <td>37.0</td>
      <td>...</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>desktop</td>
      <td>Windows</td>
      <td>chrome 63.0</td>
      <td>Windows</td>
      <td>T</td>
      <td>desktop</td>
      <td>credit</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>10767</th>
      <td>326882.0</td>
      <td>88.000</td>
      <td>13249.0</td>
      <td>111.0</td>
      <td>150.0</td>
      <td>226.0</td>
      <td>264.0</td>
      <td>87.0</td>
      <td>6.0</td>
      <td>37.0</td>
      <td>...</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>desktop</td>
      <td>Windows</td>
      <td>chrome 63.0</td>
      <td>Windows</td>
      <td>T</td>
      <td>desktop</td>
      <td>debit</td>
    </tr>
    <tr>
      <th>342767</th>
      <td>8452446.0</td>
      <td>28.277</td>
      <td>14276.0</td>
      <td>177.0</td>
      <td>185.0</td>
      <td>137.0</td>
      <td>284.0</td>
      <td>60.0</td>
      <td>8.0</td>
      <td>37.0</td>
      <td>...</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>desktop</td>
      <td>Windows</td>
      <td>chrome 63.0</td>
      <td>Windows</td>
      <td>T</td>
      <td>desktop</td>
      <td>credit</td>
    </tr>
    <tr>
      <th>324259</th>
      <td>8019613.0</td>
      <td>59.000</td>
      <td>10493.0</td>
      <td>455.0</td>
      <td>150.0</td>
      <td>126.0</td>
      <td>123.0</td>
      <td>87.0</td>
      <td>8.0</td>
      <td>37.0</td>
      <td>...</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>desktop</td>
      <td>Windows</td>
      <td>chrome 63.0</td>
      <td>Windows</td>
      <td>T</td>
      <td>desktop</td>
      <td>debit</td>
    </tr>
    <tr>
      <th>451381</th>
      <td>11512046.0</td>
      <td>15.800</td>
      <td>8404.0</td>
      <td>156.0</td>
      <td>146.0</td>
      <td>226.0</td>
      <td>299.0</td>
      <td>87.0</td>
      <td>8.0</td>
      <td>37.0</td>
      <td>...</td>
      <td>F</td>
      <td>F</td>
      <td>T</td>
      <td>mobile</td>
      <td>Hisense L675 Build/MRA58K</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>F</td>
      <td>mobile</td>
      <td>credit</td>
    </tr>
    <tr>
      <th>337290</th>
      <td>8293433.0</td>
      <td>226.000</td>
      <td>4446.0</td>
      <td>555.0</td>
      <td>150.0</td>
      <td>226.0</td>
      <td>299.0</td>
      <td>87.0</td>
      <td>8.0</td>
      <td>37.0</td>
      <td>...</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>desktop</td>
      <td>Windows</td>
      <td>chrome 63.0</td>
      <td>Windows</td>
      <td>T</td>
      <td>desktop</td>
      <td>debit</td>
    </tr>
  </tbody>
</table>
<p>150000 rows × 251 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># --- Separar variables ---</span>
<span class="n">cat_high_mod</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DeviceInfo&#39;</span><span class="p">,</span> <span class="s1">&#39;id_33&#39;</span><span class="p">,</span> <span class="s1">&#39;id_31&#39;</span><span class="p">,</span> <span class="s1">&#39;id_30&#39;</span><span class="p">,</span> <span class="s1">&#39;R_emaildomain&#39;</span><span class="p">,</span> <span class="s1">&#39;P_emaildomain&#39;</span><span class="p">,</span>
                <span class="s1">&#39;DeviceInfo_simplified&#39;</span><span class="p">,</span> <span class="s1">&#39;id_31_simplified&#39;</span><span class="p">]</span>
<span class="n">cat_low</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id_34&#39;</span><span class="p">,</span> <span class="s1">&#39;card6&#39;</span><span class="p">,</span> <span class="s1">&#39;card4&#39;</span><span class="p">,</span> <span class="s1">&#39;card6_simplified&#39;</span><span class="p">,</span> <span class="s1">&#39;id_15&#39;</span><span class="p">,</span> <span class="s1">&#39;id_29&#39;</span><span class="p">,</span> <span class="s1">&#39;id_28&#39;</span><span class="p">,</span> <span class="s1">&#39;id_16&#39;</span><span class="p">,</span>
           <span class="s1">&#39;id_35&#39;</span><span class="p">,</span> <span class="s1">&#39;id_36&#39;</span><span class="p">,</span> <span class="s1">&#39;id_37&#39;</span><span class="p">,</span> <span class="s1">&#39;DeviceType&#39;</span><span class="p">,</span> <span class="s1">&#39;id_12&#39;</span><span class="p">,</span> <span class="s1">&#39;M1&#39;</span><span class="p">,</span> <span class="s1">&#39;id_35_simplified&#39;</span><span class="p">,</span> <span class="s1">&#39;DeviceType_simplified&#39;</span><span class="p">]</span>
<span class="n">num_cols</span> <span class="o">=</span> <span class="n">df_sample_150k</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;int64&#39;</span><span class="p">,</span> <span class="s1">&#39;float64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># --- Preprocesador ---</span>
<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;freq&#39;</span><span class="p">,</span> <span class="n">CountEncoder</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">cat_high_mod</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;ohe_low&#39;</span><span class="p">,</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">handle_unknown</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">sparse_output</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">cat_low</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">(),</span> <span class="n">num_cols</span><span class="p">)</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Función para guardar modelo y métricas finales</span>
<span class="k">def</span><span class="w"> </span><span class="nf">guardar_modelo_y_metricas</span><span class="p">(</span><span class="n">nombre_modelo</span><span class="p">,</span> <span class="n">modelo_entrenado</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">archivo_metricas</span><span class="o">=</span><span class="s1">&#39;metricas_modelos.csv&#39;</span><span class="p">):</span>
    <span class="n">archivo_modelo</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;modelo_</span><span class="si">{</span><span class="n">nombre_modelo</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s1">.pkl&#39;</span>
    <span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">modelo_entrenado</span><span class="p">,</span> <span class="n">archivo_modelo</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ Modelo guardado en: </span><span class="si">{</span><span class="n">archivo_modelo</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">modelo_entrenado</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">y_proba</span> <span class="o">=</span> <span class="n">modelo_entrenado</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="n">metricas</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="n">nombre_modelo</span><span class="p">,</span>
        <span class="s1">&#39;AUC (Train)&#39;</span><span class="p">:</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_proba</span><span class="p">),</span>
        <span class="s1">&#39;F1 (Train)&#39;</span><span class="p">:</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span>
        <span class="s1">&#39;Precision (Train)&#39;</span><span class="p">:</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span>
        <span class="s1">&#39;Recall (Train)&#39;</span><span class="p">:</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">df_metricas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">archivo_metricas</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
        <span class="n">df_metricas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

    <span class="n">df_metricas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_metricas</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">metricas</span><span class="p">])],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">df_metricas</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">archivo_metricas</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;📊 Métricas guardadas en:&quot;</span><span class="p">,</span> <span class="n">archivo_metricas</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df_metricas</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="logistic-regression">
<h2>Logistic Regression<a class="headerlink" href="#logistic-regression" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># --- Pipeline ---</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;preprocessor&#39;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;classifier&#39;</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;saga&#39;</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">))</span>
<span class="p">])</span>

<span class="c1"># --- Espacio de búsqueda ---</span>
<span class="n">search_space</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;classifier__C&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1e-4</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="s1">&#39;log-uniform&#39;</span><span class="p">),</span>
    <span class="s1">&#39;classifier__penalty&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;l1&#39;</span><span class="p">,</span> <span class="s1">&#39;l2&#39;</span><span class="p">]</span>
<span class="p">}</span>

<span class="c1"># --- Validación cruzada estratificada ---</span>
<span class="n">cv</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># reducido para df_sample</span>

<span class="c1"># Callback modificado para guardar resultados por iteración</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CSVLoggerBayes</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">opt_ref</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opt_ref</span> <span class="o">=</span> <span class="n">opt_ref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">res</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opt_ref</span><span class="p">,</span> <span class="s2">&quot;cv_results_&quot;</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="n">cv_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opt_ref</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">)</span>
        <span class="n">new_results</span> <span class="o">=</span> <span class="n">cv_results</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span><span class="p">:]</span>
        <span class="n">new_results</span> <span class="o">=</span> <span class="n">new_results</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;mean_test_score&#39;</span><span class="p">:</span> <span class="s1">&#39;AUC (mean)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;param_classifier__C&#39;</span><span class="p">:</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span>
            <span class="s1">&#39;param_classifier__penalty&#39;</span><span class="p">:</span> <span class="s1">&#39;penalty&#39;</span>
        <span class="p">})</span>
        <span class="n">columns_to_keep</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;AUC (mean)&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;penalty&#39;</span><span class="p">]</span>
        <span class="n">results_clean</span> <span class="o">=</span> <span class="n">new_results</span><span class="p">[</span><span class="n">columns_to_keep</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">results_clean</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;iter&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_results</span><span class="p">)))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">results_clean</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">results_clean</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_results</span><span class="p">)</span>
        <span class="n">last_row</span> <span class="o">=</span> <span class="n">results_clean</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Iteración </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;iter&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: AUC = </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;AUC (mean)&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2"> | C = </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2"> | penalty = </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;penalty&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="c1"># --- Crear objeto BayesSearchCV ---</span>
<span class="n">opt</span> <span class="o">=</span> <span class="n">BayesSearchCV</span><span class="p">(</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">pipeline</span><span class="p">,</span>
    <span class="n">search_spaces</span><span class="o">=</span><span class="n">search_space</span><span class="p">,</span>
    <span class="n">n_iter</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span>
    <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">refit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>


<span class="c1"># --- Ejecutar optimización ---</span>
<span class="n">csv_logger</span> <span class="o">=</span> <span class="n">CSVLoggerBayes</span><span class="p">(</span><span class="s1">&#39;logistic_search_results.csv&#39;</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span>
<span class="n">opt</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="p">[</span><span class="n">csv_logger</span><span class="p">,</span> <span class="n">VerboseCallback</span><span class="p">(</span><span class="n">n_total</span><span class="o">=</span><span class="mi">3</span><span class="p">)])</span>

<span class="c1"># --- Evaluación final ---</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">y_proba</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">📊 Classification Report:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">📈 AUC:&quot;</span><span class="p">,</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_proba</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">🧩 Matriz de Confusión:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>


<span class="n">guardar_modelo_y_metricas</span><span class="p">(</span>
    <span class="n">nombre_modelo</span><span class="o">=</span><span class="s1">&#39;Logistic Regression&#39;</span><span class="p">,</span>
    <span class="n">modelo_entrenado</span><span class="o">=</span><span class="n">opt</span><span class="o">.</span><span class="n">best_estimator_</span><span class="p">,</span>
    <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">y</span>
<span class="p">)</span>


<span class="c1"># --- Guardar modelo completo entrenado ---</span>
<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">opt</span><span class="o">.</span><span class="n">best_estimator_</span><span class="p">,</span> <span class="s1">&#39;modelo_logistic_pipeline.pkl&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">✅ El modelo completo ha sido guardado como &#39;modelo_logistic_pipeline.pkl&#39;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration No: 1 started. Searching for the next optimal point.
Iteration No: 1 ended. Search finished for the next optimal point.
Time taken: 707.6665
Function value obtained: -0.8408
Current minimum: -0.8408
Iteration No: 2 started. Searching for the next optimal point.
Iteration No: 2 ended. Search finished for the next optimal point.
Time taken: 703.9243
Function value obtained: -0.8413
Current minimum: -0.8413
Iteration No: 3 started. Searching for the next optimal point.
Iteration No: 3 ended. Search finished for the next optimal point.
Time taken: 709.5478
Function value obtained: -0.8410
Current minimum: -0.8413
Iteration No: 4 ended. Search finished for the next optimal point.
Time taken: 1719.0042
Function value obtained: -0.8413
Current minimum: -0.8413
Iteration No: 5 ended. Search finished for the next optimal point.
Time taken: 2729.4636
Function value obtained: -0.8413
Current minimum: -0.8413
Iteration No: 6 ended. Search finished for the next optimal point.
Time taken: 3432.4296
Function value obtained: -0.8413
Current minimum: -0.8413
Iteration No: 7 ended. Search finished for the next optimal point.
Time taken: 4137.2301
Function value obtained: -0.8413
Current minimum: -0.8413
Iteration No: 8 ended. Search finished for the next optimal point.
Time taken: 4845.8206
Function value obtained: -0.8412
Current minimum: -0.8413
Iteration No: 9 ended. Search finished for the next optimal point.
Time taken: 5566.2038
Function value obtained: -0.8413
Current minimum: -0.8413
Iteration No: 10 ended. Search finished for the next optimal point.
Time taken: 6267.2798
Function value obtained: -0.8188
Current minimum: -0.8413
Iteration No: 11 ended. Search finished for the next optimal point.
Time taken: 7130.2962
Function value obtained: -0.7944
Current minimum: -0.8413
Iteration No: 12 ended. Search finished for the next optimal point.
Time taken: 8161.7205
Function value obtained: -0.8413
Current minimum: -0.8413
Iteration No: 13 ended. Search finished for the next optimal point.
Time taken: 9179.6783
Function value obtained: -0.8413
Current minimum: -0.8413
Iteration No: 14 ended. Search finished for the next optimal point.
Time taken: 10135.4833
Function value obtained: -0.8406
Current minimum: -0.8413
Iteration No: 15 ended. Search finished for the next optimal point.
Time taken: 10854.4513
Function value obtained: -0.8353
Current minimum: -0.8413
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\keine\anaconda3\envs\sklearn_env\lib\site-packages\sklearn\linear_model\_sag.py:348: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>📊 Classification Report:
              precision    recall  f1-score   support

         0.0       0.97      1.00      0.99    144751
         1.0       0.82      0.22      0.35      5249

    accuracy                           0.97    150000
   macro avg       0.90      0.61      0.67    150000
weighted avg       0.97      0.97      0.96    150000


📈 AUC: 0.8461182246414419

🧩 Matriz de Confusión:
[[144492    259]
 [  4076   1173]]
✅ Modelo guardado en: modelo_logistic_regression.pkl
📊 Métricas guardadas en: metricas_modelos.csv

✅ El modelo completo ha sido guardado como &#39;modelo_logistic_pipeline.pkl&#39;
</pre></div>
</div>
</div>
</div>
<p>El modelo fue altamente efectivo en identificar transacciones no fraudulentas, clasificando correctamente 144,492 de 144,751 casos reales. Sin embargo, al identificar transacciones fraudulentas, el modelo tuvo un desempeño más limitado: solo detectó correctamente 1,173 de los 5,249 casos reales, lo cual representa una tasa de acierto del 22%.</p>
<p>Métricas clave:</p>
<ul class="simple">
<li><p>Precision (1.0): 0.82 → Cuando el modelo predice fraude, acierta el 82% de las veces.</p></li>
<li><p>Recall (1.0): 0.22 → El modelo solo detecta el 22% de todos los fraudes reales.</p></li>
<li><p>F1-score (1.0): 0.35 → Media armónica entre precisión y recall, penalizada por el bajo recall.</p></li>
<li><p>AUC: 0.846 → Buena capacidad general del modelo para discriminar entre fraudes y no fraudes, a pesar del bajo recall.</p></li>
</ul>
</section>
<section id="bayesian-classification">
<h2>Bayesian Classification<a class="headerlink" href="#bayesian-classification" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># --- Pipeline para Naive Bayes ---</span>
<span class="n">pipeline_nb</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;preprocessor&#39;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;classifier&#39;</span><span class="p">,</span> <span class="n">GaussianNB</span><span class="p">())</span>
<span class="p">])</span>

<span class="c1"># --- Espacio de búsqueda para Naive Bayes ---</span>
<span class="c1"># GaussianNB solo tiene un parámetro útil para tunear: var_smoothing</span>
<span class="n">search_space_nb</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;classifier__var_smoothing&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1e-11</span><span class="p">,</span> <span class="mf">1e-7</span><span class="p">,</span> <span class="s1">&#39;log-uniform&#39;</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># --- Validación cruzada estratificada (ya definida) ---</span>
<span class="n">cv</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># --- Callback para guardar métricas por iteración ---</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CSVLoggerBayesNB</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">opt_ref</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opt_ref</span> <span class="o">=</span> <span class="n">opt_ref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">res</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opt_ref</span><span class="p">,</span> <span class="s2">&quot;cv_results_&quot;</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="n">cv_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opt_ref</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">)</span>
        <span class="n">new_results</span> <span class="o">=</span> <span class="n">cv_results</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span><span class="p">:]</span>
        <span class="n">new_results</span> <span class="o">=</span> <span class="n">new_results</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;mean_test_score&#39;</span><span class="p">:</span> <span class="s1">&#39;AUC (mean)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;param_classifier__var_smoothing&#39;</span><span class="p">:</span> <span class="s1">&#39;var_smoothing&#39;</span>
        <span class="p">})</span>
        <span class="n">columns_to_keep</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;AUC (mean)&#39;</span><span class="p">,</span> <span class="s1">&#39;var_smoothing&#39;</span><span class="p">]</span>
        <span class="n">results_clean</span> <span class="o">=</span> <span class="n">new_results</span><span class="p">[</span><span class="n">columns_to_keep</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">results_clean</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;iter&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_results</span><span class="p">)))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">results_clean</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">results_clean</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_results</span><span class="p">)</span>
        <span class="n">last_row</span> <span class="o">=</span> <span class="n">results_clean</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Iteración </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;iter&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: AUC = </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;AUC (mean)&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2"> | var_smoothing = </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;var_smoothing&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># --- Crear objeto BayesSearchCV ---</span>
<span class="n">opt_nb</span> <span class="o">=</span> <span class="n">BayesSearchCV</span><span class="p">(</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">pipeline_nb</span><span class="p">,</span>
    <span class="n">search_spaces</span><span class="o">=</span><span class="n">search_space_nb</span><span class="p">,</span>
    <span class="n">n_iter</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span>
    <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">refit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>

<span class="c1"># --- Ejecutar optimización para Naive Bayes ---</span>
<span class="n">csv_logger_nb</span> <span class="o">=</span> <span class="n">CSVLoggerBayesNB</span><span class="p">(</span><span class="s1">&#39;naivebayes_search_results.csv&#39;</span><span class="p">,</span> <span class="n">opt_nb</span><span class="p">)</span>
<span class="n">opt_nb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="p">[</span><span class="n">csv_logger_nb</span><span class="p">,</span> <span class="n">VerboseCallback</span><span class="p">(</span><span class="n">n_total</span><span class="o">=</span><span class="mi">3</span><span class="p">)])</span>

<span class="c1"># --- Evaluación final ---</span>
<span class="n">y_pred_nb</span> <span class="o">=</span> <span class="n">opt_nb</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">y_proba_nb</span> <span class="o">=</span> <span class="n">opt_nb</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">📊 Classification Report (Naive Bayes):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred_nb</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">📈 AUC (Naive Bayes):&quot;</span><span class="p">,</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_proba_nb</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">🧩 Matriz de Confusión (Naive Bayes):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred_nb</span><span class="p">))</span>

<span class="c1"># --- Guardar métricas y modelo final ---</span>
<span class="n">guardar_modelo_y_metricas</span><span class="p">(</span>
    <span class="n">nombre_modelo</span><span class="o">=</span><span class="s1">&#39;Naive Bayes&#39;</span><span class="p">,</span>
    <span class="n">modelo_entrenado</span><span class="o">=</span><span class="n">opt_nb</span><span class="o">.</span><span class="n">best_estimator_</span><span class="p">,</span>
    <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">y</span>
<span class="p">)</span>

<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">opt_nb</span><span class="o">.</span><span class="n">best_estimator_</span><span class="p">,</span> <span class="s1">&#39;modelo_naive_bayes_pipeline.pkl&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">✅ El modelo Naive Bayes ha sido guardado como &#39;modelo_naive_bayes_pipeline.pkl&#39;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration No: 1 started. Searching for the next optimal point.
Iteration No: 1 ended. Search finished for the next optimal point.
Time taken: 8.2519
Function value obtained: -0.7510
Current minimum: -0.7510
Iteration No: 2 started. Searching for the next optimal point.
Iteration No: 2 ended. Search finished for the next optimal point.
Time taken: 7.5930
Function value obtained: -0.7568
Current minimum: -0.7568
Iteration No: 3 started. Searching for the next optimal point.
Iteration No: 3 ended. Search finished for the next optimal point.
Time taken: 7.5807
Function value obtained: -0.7517
Current minimum: -0.7568
Iteration No: 4 ended. Search finished for the next optimal point.
Time taken: 15.1747
Function value obtained: -0.7564
Current minimum: -0.7568
Iteration No: 5 ended. Search finished for the next optimal point.
Time taken: 22.7738
Function value obtained: -0.7562
Current minimum: -0.7568
Iteration No: 6 ended. Search finished for the next optimal point.
Time taken: 30.3281
Function value obtained: -0.7556
Current minimum: -0.7568
Iteration No: 7 ended. Search finished for the next optimal point.
Time taken: 37.8770
Function value obtained: -0.7542
Current minimum: -0.7568
Iteration No: 8 ended. Search finished for the next optimal point.
Time taken: 45.4329
Function value obtained: -0.7531
Current minimum: -0.7568
Iteration No: 9 ended. Search finished for the next optimal point.
Time taken: 52.7092
Function value obtained: -0.7583
Current minimum: -0.7583
Iteration No: 10 ended. Search finished for the next optimal point.
Time taken: 60.8897
Function value obtained: -0.7430
Current minimum: -0.7583
Iteration No: 11 ended. Search finished for the next optimal point.
Time taken: 69.2991
Function value obtained: -0.7589
Current minimum: -0.7589
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\keine\anaconda3\envs\sklearn_env\lib\site-packages\skopt\optimizer\optimizer.py:517: UserWarning: The objective has been evaluated at point [6.058289602644282e-09] before, using random point [2.146063722623435e-09]
  warnings.warn(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration No: 12 ended. Search finished for the next optimal point.
Time taken: 77.4822
Function value obtained: -0.7537
Current minimum: -0.7589
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\keine\anaconda3\envs\sklearn_env\lib\site-packages\skopt\optimizer\optimizer.py:517: UserWarning: The objective has been evaluated at point [8.871097647130909e-09] before, using random point [2.0099688090598323e-10]
  warnings.warn(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration No: 13 ended. Search finished for the next optimal point.
Time taken: 85.8515
Function value obtained: -0.7495
Current minimum: -0.7589
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\keine\anaconda3\envs\sklearn_env\lib\site-packages\skopt\optimizer\optimizer.py:517: UserWarning: The objective has been evaluated at point [7.869915416326082e-11] before, using random point [5.6694586013374584e-11]
  warnings.warn(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration No: 14 ended. Search finished for the next optimal point.
Time taken: 94.5433
Function value obtained: -0.7472
Current minimum: -0.7589
Iteration No: 15 ended. Search finished for the next optimal point.
Time taken: 102.9434
Function value obtained: -0.7587
Current minimum: -0.7589

📊 Classification Report (Naive Bayes):
              precision    recall  f1-score   support

         0.0       0.98      0.80      0.88    144751
         1.0       0.10      0.60      0.17      5249

    accuracy                           0.79    150000
   macro avg       0.54      0.70      0.53    150000
weighted avg       0.95      0.79      0.86    150000


📈 AUC (Naive Bayes): 0.7603695683067995

🧩 Matriz de Confusión (Naive Bayes):
[[115701  29050]
 [  2085   3164]]
✅ Modelo guardado en: modelo_naive_bayes.pkl
📊 Métricas guardadas en: metricas_modelos.csv

✅ El modelo Naive Bayes ha sido guardado como &#39;modelo_naive_bayes_pipeline.pkl&#39;
</pre></div>
</div>
</div>
</div>
<p>El modelo detectó correctamente el 60% de las transacciones fraudulentas (recall = 0.60), lo cual representa una mejora significativa frente a otros modelos en términos de sensibilidad hacia la clase 1. Sin embargo, esta sensibilidad se logró a costa de un elevado número de falsos positivos: clasificó erróneamente como fraude más de 29,000 transacciones legítimas, lo que redujo la precisión a apenas 10% para la clase fraudulenta.</p>
<p>Métricas clave:</p>
<ul class="simple">
<li><p>Precision (1.0): 0.10 → De todas las predicciones de fraude, solo el 10% eran realmente fraudulentas.</p></li>
<li><p>Recall (1.0): 0.60 → El modelo identificó correctamente el 60% de los fraudes reales.</p></li>
<li><p>F1-score (1.0): 0.17 → Bajo, debido al gran desbalance entre precisión y recall.</p></li>
<li><p>Accuracy general: 0.79 → Inflado por la dominancia de la clase no fraudulenta.</p></li>
<li><p>AUC: 0.76 → Aceptable capacidad de discriminación general, pero inferior a otros modelos.</p></li>
</ul>
</section>
<section id="random-forest">
<h2>Random Forest<a class="headerlink" href="#random-forest" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># --- Pipeline para Random Forest ---</span>
<span class="n">pipeline_rf</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;preprocessor&#39;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;classifier&#39;</span><span class="p">,</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span>
<span class="p">])</span>

<span class="c1"># --- Espacio de búsqueda de hiperparámetros ---</span>
<span class="n">search_space_rf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;classifier__n_estimators&#39;</span><span class="p">:</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span>
    <span class="s1">&#39;classifier__max_depth&#39;</span><span class="p">:</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
    <span class="s1">&#39;classifier__min_samples_split&#39;</span><span class="p">:</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
    <span class="s1">&#39;classifier__min_samples_leaf&#39;</span><span class="p">:</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
    <span class="s1">&#39;classifier__criterion&#39;</span><span class="p">:</span> <span class="n">Categorical</span><span class="p">([</span><span class="s1">&#39;gini&#39;</span><span class="p">,</span> <span class="s1">&#39;entropy&#39;</span><span class="p">])</span>
<span class="p">}</span>

<span class="c1"># --- Callback para logging por iteración ---</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CSVLoggerBayesRF</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">opt_ref</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opt_ref</span> <span class="o">=</span> <span class="n">opt_ref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">res</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opt_ref</span><span class="p">,</span> <span class="s2">&quot;cv_results_&quot;</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="n">cv_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opt_ref</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">)</span>
        <span class="n">new_results</span> <span class="o">=</span> <span class="n">cv_results</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span><span class="p">:]</span>
        <span class="n">new_results</span> <span class="o">=</span> <span class="n">new_results</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;mean_test_score&#39;</span><span class="p">:</span> <span class="s1">&#39;AUC (mean)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;param_classifier__n_estimators&#39;</span><span class="p">:</span> <span class="s1">&#39;n_estimators&#39;</span><span class="p">,</span>
            <span class="s1">&#39;param_classifier__max_depth&#39;</span><span class="p">:</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">,</span>
            <span class="s1">&#39;param_classifier__min_samples_split&#39;</span><span class="p">:</span> <span class="s1">&#39;min_split&#39;</span><span class="p">,</span>
            <span class="s1">&#39;param_classifier__min_samples_leaf&#39;</span><span class="p">:</span> <span class="s1">&#39;min_leaf&#39;</span><span class="p">,</span>
            <span class="s1">&#39;param_classifier__criterion&#39;</span><span class="p">:</span> <span class="s1">&#39;criterion&#39;</span>
        <span class="p">})</span>
        <span class="n">columns_to_keep</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;AUC (mean)&#39;</span><span class="p">,</span> <span class="s1">&#39;n_estimators&#39;</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">,</span> <span class="s1">&#39;min_split&#39;</span><span class="p">,</span> <span class="s1">&#39;min_leaf&#39;</span><span class="p">,</span> <span class="s1">&#39;criterion&#39;</span><span class="p">]</span>
        <span class="n">results_clean</span> <span class="o">=</span> <span class="n">new_results</span><span class="p">[</span><span class="n">columns_to_keep</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">results_clean</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;iter&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_results</span><span class="p">)))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">results_clean</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">results_clean</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_results</span><span class="p">)</span>
        <span class="n">last_row</span> <span class="o">=</span> <span class="n">results_clean</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Iteración </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;iter&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: AUC = </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;AUC (mean)&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2"> | Estimators = </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> | MaxDepth = </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;max_depth&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> | Split = </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;min_split&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> | Leaf = </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;min_leaf&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> | Criterion = </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;criterion&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># --- BayesSearchCV para Random Forest ---</span>
<span class="n">opt_rf</span> <span class="o">=</span> <span class="n">BayesSearchCV</span><span class="p">(</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">pipeline_rf</span><span class="p">,</span>
    <span class="n">search_spaces</span><span class="o">=</span><span class="n">search_space_rf</span><span class="p">,</span>
    <span class="n">n_iter</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span>
    <span class="n">cv</span><span class="o">=</span><span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">),</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">refit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>

<span class="c1"># --- Ejecutar optimización ---</span>
<span class="n">csv_logger_rf</span> <span class="o">=</span> <span class="n">CSVLoggerBayesRF</span><span class="p">(</span><span class="s1">&#39;randomforest_search_results.csv&#39;</span><span class="p">,</span> <span class="n">opt_rf</span><span class="p">)</span>
<span class="n">opt_rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="p">[</span><span class="n">csv_logger_rf</span><span class="p">,</span> <span class="n">VerboseCallback</span><span class="p">(</span><span class="n">n_total</span><span class="o">=</span><span class="mi">15</span><span class="p">)])</span>

<span class="c1"># --- Evaluación final ---</span>
<span class="n">y_pred_rf</span> <span class="o">=</span> <span class="n">opt_rf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">y_proba_rf</span> <span class="o">=</span> <span class="n">opt_rf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">📊 Classification Report (Random Forest):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred_rf</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">📈 AUC (Random Forest):&quot;</span><span class="p">,</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_proba_rf</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">🧩 Matriz de Confusión (Random Forest):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred_rf</span><span class="p">))</span>

<span class="c1"># --- Guardar métricas y modelo final ---</span>
<span class="n">guardar_modelo_y_metricas</span><span class="p">(</span>
    <span class="n">nombre_modelo</span><span class="o">=</span><span class="s1">&#39;Random Forest&#39;</span><span class="p">,</span>
    <span class="n">modelo_entrenado</span><span class="o">=</span><span class="n">opt_rf</span><span class="o">.</span><span class="n">best_estimator_</span><span class="p">,</span>
    <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">y</span>
<span class="p">)</span>

<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">opt_rf</span><span class="o">.</span><span class="n">best_estimator_</span><span class="p">,</span> <span class="s1">&#39;modelo_random_forest_pipeline.pkl&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">✅ El modelo Random Forest ha sido guardado como &#39;modelo_random_forest_pipeline.pkl&#39;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration No: 1 started. Searching for the next optimal point.
Iteration No: 1 ended. Search finished for the next optimal point.
Time taken: 178.5346
Function value obtained: -0.8929
Current minimum: -0.8929
Iteration No: 2 started. Searching for the next optimal point.
Iteration No: 2 ended. Search finished for the next optimal point.
Time taken: 185.6594
Function value obtained: -0.9069
Current minimum: -0.9069
Iteration No: 3 started. Searching for the next optimal point.
Iteration No: 3 ended. Search finished for the next optimal point.
Time taken: 93.5584
Function value obtained: -0.8988
Current minimum: -0.9069
Iteration No: 4 started. Searching for the next optimal point.
Iteration No: 4 ended. Search finished for the next optimal point.
Time taken: 73.9705
Function value obtained: -0.8669
Current minimum: -0.9069
Iteration No: 5 started. Searching for the next optimal point.
Iteration No: 5 ended. Search finished for the next optimal point.
Time taken: 163.8084
Function value obtained: -0.8951
Current minimum: -0.9069
Iteration No: 6 started. Searching for the next optimal point.
Iteration No: 6 ended. Search finished for the next optimal point.
Time taken: 186.4282
Function value obtained: -0.9124
Current minimum: -0.9124
Iteration No: 7 started. Searching for the next optimal point.
Iteration No: 7 ended. Search finished for the next optimal point.
Time taken: 144.7573
Function value obtained: -0.9054
Current minimum: -0.9124
Iteration No: 8 started. Searching for the next optimal point.
Iteration No: 8 ended. Search finished for the next optimal point.
Time taken: 98.9060
Function value obtained: -0.9050
Current minimum: -0.9124
Iteration No: 9 started. Searching for the next optimal point.
Iteration No: 9 ended. Search finished for the next optimal point.
Time taken: 105.5653
Function value obtained: -0.9010
Current minimum: -0.9124
Iteration No: 10 started. Searching for the next optimal point.
Iteration No: 10 ended. Search finished for the next optimal point.
Time taken: 183.6752
Function value obtained: -0.8958
Current minimum: -0.9124
Iteration No: 11 started. Searching for the next optimal point.
Iteration No: 11 ended. Search finished for the next optimal point.
Time taken: 216.5622
Function value obtained: -0.9046
Current minimum: -0.9124
Iteration No: 12 started. Searching for the next optimal point.
Iteration No: 12 ended. Search finished for the next optimal point.
Time taken: 196.2512
Function value obtained: -0.9117
Current minimum: -0.9124
Iteration No: 13 started. Searching for the next optimal point.
Iteration No: 13 ended. Search finished for the next optimal point.
Time taken: 51.2990
Function value obtained: -0.8799
Current minimum: -0.9124
Iteration No: 14 started. Searching for the next optimal point.
Iteration No: 14 ended. Search finished for the next optimal point.
Time taken: 71.1246
Function value obtained: -0.9086
Current minimum: -0.9124
Iteration No: 15 started. Searching for the next optimal point.
Iteration No: 15 ended. Search finished for the next optimal point.
Time taken: 283.4034
Function value obtained: -0.9067
Current minimum: -0.9124

📊 Classification Report (Random Forest):
              precision    recall  f1-score   support

         0.0       0.98      1.00      0.99    144751
         1.0       1.00      0.55      0.71      5249

    accuracy                           0.98    150000
   macro avg       0.99      0.77      0.85    150000
weighted avg       0.98      0.98      0.98    150000


📈 AUC (Random Forest): 0.9931887251521966

🧩 Matriz de Confusión (Random Forest):
[[144750      1]
 [  2366   2883]]
✅ Modelo guardado en: modelo_random_forest.pkl
📊 Métricas guardadas en: metricas_modelos.csv

✅ El modelo Random Forest ha sido guardado como &#39;modelo_random_forest_pipeline.pkl&#39;
</pre></div>
</div>
</div>
</div>
<p>El modelo identificó correctamente el 55% de los fraudes reales (recall = 0.55), una mejora significativa frente a la regresión logística. Su precisión fue perfecta para la clase fraudulenta (1.00), lo que significa que todas las predicciones de fraude fueron correctas, sin falsos positivos relevantes. Además, prácticamente no cometió errores al clasificar transacciones legítimas (solo 1 falso positivo sobre más de 144 mil).</p>
<p>Métricas clave:</p>
<ul class="simple">
<li><p>Precision (1.0): 1.00 → Cada vez que predijo fraude, acertó.</p></li>
<li><p>Recall (1.0): 0.55 → Detectó el 55% de todos los fraudes reales.</p></li>
<li><p>F1-score (1.0): 0.71 → Muy sólido, combinando precisión perfecta con buena sensibilidad.</p></li>
<li><p>Accuracy general: 0.98 → Muy alto, dado el excelente manejo de ambas clases.</p></li>
<li><p>AUC: 0.993 → Extremadamente alto, lo que confirma su excelente capacidad de discriminación</p></li>
</ul>
</section>
<section id="xgboost">
<h2>XGBoost<a class="headerlink" href="#xgboost" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># --- Pipeline para XGBoost ---</span>
<span class="n">pipeline_xgb</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;preprocessor&#39;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;classifier&#39;</span><span class="p">,</span> <span class="n">XGBClassifier</span><span class="p">(</span><span class="n">use_label_encoder</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;logloss&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span>
<span class="p">])</span>

<span class="c1"># --- Espacio de búsqueda de hiperparámetros ---</span>
<span class="n">search_space_xgb</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;classifier__n_estimators&#39;</span><span class="p">:</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span>
    <span class="s1">&#39;classifier__max_depth&#39;</span><span class="p">:</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
    <span class="s1">&#39;classifier__learning_rate&#39;</span><span class="p">:</span> <span class="n">Real</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">prior</span><span class="o">=</span><span class="s1">&#39;log-uniform&#39;</span><span class="p">),</span>
    <span class="s1">&#39;classifier__subsample&#39;</span><span class="p">:</span> <span class="n">Real</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
    <span class="s1">&#39;classifier__colsample_bytree&#39;</span><span class="p">:</span> <span class="n">Real</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
    <span class="s1">&#39;classifier__gamma&#39;</span><span class="p">:</span> <span class="n">Real</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="s1">&#39;classifier__min_child_weight&#39;</span><span class="p">:</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># --- Callback para logging por iteración ---</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CSVLoggerBayesXGB</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">opt_ref</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opt_ref</span> <span class="o">=</span> <span class="n">opt_ref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">res</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opt_ref</span><span class="p">,</span> <span class="s2">&quot;cv_results_&quot;</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="n">cv_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opt_ref</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">)</span>
        <span class="n">new_results</span> <span class="o">=</span> <span class="n">cv_results</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span><span class="p">:]</span>
        <span class="n">new_results</span> <span class="o">=</span> <span class="n">new_results</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;mean_test_score&#39;</span><span class="p">:</span> <span class="s1">&#39;AUC (mean)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;param_classifier__n_estimators&#39;</span><span class="p">:</span> <span class="s1">&#39;n_estimators&#39;</span><span class="p">,</span>
            <span class="s1">&#39;param_classifier__max_depth&#39;</span><span class="p">:</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">,</span>
            <span class="s1">&#39;param_classifier__learning_rate&#39;</span><span class="p">:</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">,</span>
            <span class="s1">&#39;param_classifier__subsample&#39;</span><span class="p">:</span> <span class="s1">&#39;subsample&#39;</span><span class="p">,</span>
            <span class="s1">&#39;param_classifier__colsample_bytree&#39;</span><span class="p">:</span> <span class="s1">&#39;colsample_bytree&#39;</span><span class="p">,</span>
            <span class="s1">&#39;param_classifier__gamma&#39;</span><span class="p">:</span> <span class="s1">&#39;gamma&#39;</span><span class="p">,</span>
            <span class="s1">&#39;param_classifier__min_child_weight&#39;</span><span class="p">:</span> <span class="s1">&#39;min_child_weight&#39;</span>
        <span class="p">})</span>
        <span class="n">columns_to_keep</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;AUC (mean)&#39;</span><span class="p">,</span> <span class="s1">&#39;n_estimators&#39;</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">,</span> <span class="s1">&#39;subsample&#39;</span><span class="p">,</span> <span class="s1">&#39;colsample_bytree&#39;</span><span class="p">,</span> <span class="s1">&#39;gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;min_child_weight&#39;</span><span class="p">]</span>
        <span class="n">results_clean</span> <span class="o">=</span> <span class="n">new_results</span><span class="p">[</span><span class="n">columns_to_keep</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">results_clean</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;iter&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_results</span><span class="p">)))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">results_clean</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">results_clean</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_results</span><span class="p">)</span>
        <span class="n">last_row</span> <span class="o">=</span> <span class="n">results_clean</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Iteración </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;iter&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: AUC = </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;AUC (mean)&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2"> | Depth = </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;max_depth&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> | LR = </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;learning_rate&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> | Subs = </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;subsample&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># --- BayesSearchCV para XGBoost ---</span>
<span class="n">opt_xgb</span> <span class="o">=</span> <span class="n">BayesSearchCV</span><span class="p">(</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">pipeline_xgb</span><span class="p">,</span>
    <span class="n">search_spaces</span><span class="o">=</span><span class="n">search_space_xgb</span><span class="p">,</span>
    <span class="n">n_iter</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span>
    <span class="n">cv</span><span class="o">=</span><span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">),</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">refit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>

<span class="c1"># --- Ejecutar optimización ---</span>
<span class="n">csv_logger_xgb</span> <span class="o">=</span> <span class="n">CSVLoggerBayesXGB</span><span class="p">(</span><span class="s1">&#39;xgboost_search_results.csv&#39;</span><span class="p">,</span> <span class="n">opt_xgb</span><span class="p">)</span>
<span class="n">opt_xgb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="p">[</span><span class="n">csv_logger_xgb</span><span class="p">,</span> <span class="n">VerboseCallback</span><span class="p">(</span><span class="n">n_total</span><span class="o">=</span><span class="mi">15</span><span class="p">)])</span>

<span class="c1"># --- Evaluación final ---</span>
<span class="n">y_pred_xgb</span> <span class="o">=</span> <span class="n">opt_xgb</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">y_proba_xgb</span> <span class="o">=</span> <span class="n">opt_xgb</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">📊 Classification Report (XGBoost):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred_xgb</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">📈 AUC (XGBoost):&quot;</span><span class="p">,</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_proba_xgb</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">🧩 Matriz de Confusión (XGBoost):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred_xgb</span><span class="p">))</span>

<span class="c1"># --- Guardar métricas y modelo final ---</span>
<span class="n">guardar_modelo_y_metricas</span><span class="p">(</span>
    <span class="n">nombre_modelo</span><span class="o">=</span><span class="s1">&#39;XGBoost&#39;</span><span class="p">,</span>
    <span class="n">modelo_entrenado</span><span class="o">=</span><span class="n">opt_xgb</span><span class="o">.</span><span class="n">best_estimator_</span><span class="p">,</span>
    <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">y</span>
<span class="p">)</span>

<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">opt_xgb</span><span class="o">.</span><span class="n">best_estimator_</span><span class="p">,</span> <span class="s1">&#39;modelo_xgboost_pipeline.pkl&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">✅ El modelo XGBoost ha sido guardado como &#39;modelo_xgboost_pipeline.pkl&#39;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration No: 1 started. Searching for the next optimal point.
Iteration No: 1 ended. Search finished for the next optimal point.
Time taken: 43.0635
Function value obtained: -0.9055
Current minimum: -0.9055
Iteration No: 2 started. Searching for the next optimal point.
Iteration No: 2 ended. Search finished for the next optimal point.
Time taken: 31.6965
Function value obtained: -0.8810
Current minimum: -0.9055
Iteration No: 3 started. Searching for the next optimal point.
Iteration No: 3 ended. Search finished for the next optimal point.
Time taken: 39.9022
Function value obtained: -0.8756
Current minimum: -0.9055
Iteration No: 4 started. Searching for the next optimal point.
Iteration No: 4 ended. Search finished for the next optimal point.
Time taken: 27.4591
Function value obtained: -0.9033
Current minimum: -0.9055
Iteration No: 5 started. Searching for the next optimal point.
Iteration No: 5 ended. Search finished for the next optimal point.
Time taken: 46.2337
Function value obtained: -0.9109
Current minimum: -0.9109
Iteration No: 6 started. Searching for the next optimal point.
Iteration No: 6 ended. Search finished for the next optimal point.
Time taken: 28.8946
Function value obtained: -0.8642
Current minimum: -0.9109
Iteration No: 7 started. Searching for the next optimal point.
Iteration No: 7 ended. Search finished for the next optimal point.
Time taken: 45.1641
Function value obtained: -0.9049
Current minimum: -0.9109
Iteration No: 8 started. Searching for the next optimal point.
Iteration No: 8 ended. Search finished for the next optimal point.
Time taken: 25.1654
Function value obtained: -0.8935
Current minimum: -0.9109
Iteration No: 9 started. Searching for the next optimal point.
Iteration No: 9 ended. Search finished for the next optimal point.
Time taken: 26.4016
Function value obtained: -0.9022
Current minimum: -0.9109
Iteration No: 10 started. Searching for the next optimal point.
Iteration No: 10 ended. Search finished for the next optimal point.
Time taken: 27.7056
Function value obtained: -0.8954
Current minimum: -0.9109
Iteration No: 11 started. Searching for the next optimal point.
Iteration No: 11 ended. Search finished for the next optimal point.
Time taken: 64.3153
Function value obtained: -0.9221
Current minimum: -0.9221
Iteration No: 12 started. Searching for the next optimal point.
Iteration No: 12 ended. Search finished for the next optimal point.
Time taken: 28.5684
Function value obtained: -0.9020
Current minimum: -0.9221
Iteration No: 13 started. Searching for the next optimal point.
Iteration No: 13 ended. Search finished for the next optimal point.
Time taken: 74.2790
Function value obtained: -0.9281
Current minimum: -0.9281
Iteration No: 14 started. Searching for the next optimal point.
Iteration No: 14 ended. Search finished for the next optimal point.
Time taken: 39.4136
Function value obtained: -0.9043
Current minimum: -0.9281
Iteration No: 15 started. Searching for the next optimal point.
Iteration No: 15 ended. Search finished for the next optimal point.
Time taken: 54.0241
Function value obtained: -0.9280
Current minimum: -0.9281
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\kcarrascal\AppData\Local\anaconda3\envs\sklearn_env\lib\site-packages\xgboost\training.py:183: UserWarning: [11:20:10] WARNING: C:\actions-runner\_work\xgboost\xgboost\src\learner.cc:738: 
Parameters: { &quot;use_label_encoder&quot; } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>📊 Classification Report (XGBoost):
              precision    recall  f1-score   support

         0.0       0.99      1.00      0.99    144751
         1.0       0.99      0.69      0.81      5249

    accuracy                           0.99    150000
   macro avg       0.99      0.84      0.90    150000
weighted avg       0.99      0.99      0.99    150000


📈 AUC (XGBoost): 0.992216406192457

🧩 Matriz de Confusión (XGBoost):
[[144729     22]
 [  1646   3603]]
✅ Modelo guardado en: modelo_xgboost.pkl
📊 Métricas guardadas en: metricas_modelos.csv

✅ El modelo XGBoost ha sido guardado como &#39;modelo_xgboost_pipeline.pkl&#39;
</pre></div>
</div>
</div>
</div>
<p>El modelo detectó correctamente el 69% de los fraudes reales (recall = 0.69), el valor más alto alcanzado entre todos los modelos evaluados hasta ahora.
Combinó esta buena sensibilidad con una alta precisión (0.99), lo que significa que la gran mayoría de las transacciones predichas como fraude eran efectivamente fraudulentas. La tasa de falsos positivos fue extremadamente baja (solo 22 casos), lo que indica una excelente discriminación de clases.</p>
<p>Métricas clave:</p>
<ul class="simple">
<li><p>Precision (1.0): 0.99 → Muy alta confianza en las predicciones de fraude.</p></li>
<li><p>Recall (1.0): 0.69 → Alta capacidad para detectar fraudes reales.</p></li>
<li><p>F1-score (1.0): 0.81 → Excelente equilibrio entre precisión y sensibilidad.</p></li>
<li><p>Accuracy general: 0.99 → Indica excelente rendimiento global.</p></li>
<li><p>AUC: 0.992 → Valor casi perfecto, lo que refleja un modelo muy bien calibrado y eficaz.</p></li>
</ul>
</section>
<section id="knn">
<h2>KNN<a class="headerlink" href="#knn" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># --- Pipeline para K-NN ---</span>
<span class="n">pipeline_knn</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;preprocessor&#39;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;classifier&#39;</span><span class="p">,</span> <span class="n">KNeighborsClassifier</span><span class="p">())</span>
<span class="p">])</span>

<span class="c1"># --- Espacio de búsqueda para K-NN ---</span>
<span class="n">search_space_knn</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;classifier__n_neighbors&#39;</span><span class="p">:</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span>
    <span class="s1">&#39;classifier__weights&#39;</span><span class="p">:</span> <span class="n">Categorical</span><span class="p">([</span><span class="s1">&#39;uniform&#39;</span><span class="p">,</span> <span class="s1">&#39;distance&#39;</span><span class="p">]),</span>
    <span class="s1">&#39;classifier__p&#39;</span><span class="p">:</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># 1: Manhattan, 2: Euclidean</span>
<span class="p">}</span>

<span class="c1"># --- Callback personalizado para guardar iteraciones KNN ---</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CSVLoggerBayesKNN</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">opt_ref</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opt_ref</span> <span class="o">=</span> <span class="n">opt_ref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">res</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opt_ref</span><span class="p">,</span> <span class="s2">&quot;cv_results_&quot;</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="n">cv_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opt_ref</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">)</span>
        <span class="n">new_results</span> <span class="o">=</span> <span class="n">cv_results</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span><span class="p">:]</span>
        <span class="n">new_results</span> <span class="o">=</span> <span class="n">new_results</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;mean_test_score&#39;</span><span class="p">:</span> <span class="s1">&#39;AUC (mean)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;param_classifier__n_neighbors&#39;</span><span class="p">:</span> <span class="s1">&#39;n_neighbors&#39;</span><span class="p">,</span>
            <span class="s1">&#39;param_classifier__weights&#39;</span><span class="p">:</span> <span class="s1">&#39;weights&#39;</span><span class="p">,</span>
            <span class="s1">&#39;param_classifier__p&#39;</span><span class="p">:</span> <span class="s1">&#39;p&#39;</span>
        <span class="p">})</span>
        <span class="n">columns_to_keep</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;AUC (mean)&#39;</span><span class="p">,</span> <span class="s1">&#39;n_neighbors&#39;</span><span class="p">,</span> <span class="s1">&#39;weights&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">]</span>
        <span class="n">results_clean</span> <span class="o">=</span> <span class="n">new_results</span><span class="p">[</span><span class="n">columns_to_keep</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">results_clean</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;iter&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_results</span><span class="p">)))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">results_clean</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">results_clean</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_results</span><span class="p">)</span>
        <span class="n">last_row</span> <span class="o">=</span> <span class="n">results_clean</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Iteración </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;iter&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: AUC = </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;AUC (mean)&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2"> | k = </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;n_neighbors&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> | weights = </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;weights&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> | p = </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># --- BayesSearchCV para KNN ---</span>
<span class="n">opt_knn</span> <span class="o">=</span> <span class="n">BayesSearchCV</span><span class="p">(</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">pipeline_knn</span><span class="p">,</span>
    <span class="n">search_spaces</span><span class="o">=</span><span class="n">search_space_knn</span><span class="p">,</span>
    <span class="n">n_iter</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span>
    <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">refit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>

<span class="c1"># --- Ejecutar optimización ---</span>
<span class="n">csv_logger_knn</span> <span class="o">=</span> <span class="n">CSVLoggerBayesKNN</span><span class="p">(</span><span class="s1">&#39;knn_search_results.csv&#39;</span><span class="p">,</span> <span class="n">opt_knn</span><span class="p">)</span>
<span class="n">opt_knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="p">[</span><span class="n">csv_logger_knn</span><span class="p">,</span> <span class="n">VerboseCallback</span><span class="p">(</span><span class="n">n_total</span><span class="o">=</span><span class="mi">15</span><span class="p">)])</span>

<span class="c1"># --- Evaluación final ---</span>
<span class="n">y_pred_knn</span> <span class="o">=</span> <span class="n">opt_knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">y_proba_knn</span> <span class="o">=</span> <span class="n">opt_knn</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">📊 Classification Report (K-NN):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred_knn</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">📈 AUC (K-NN):&quot;</span><span class="p">,</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_proba_knn</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">🧩 Matriz de Confusión (K-NN):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred_knn</span><span class="p">))</span>

<span class="c1"># --- Guardar métricas y modelo final ---</span>
<span class="n">guardar_modelo_y_metricas</span><span class="p">(</span>
    <span class="n">nombre_modelo</span><span class="o">=</span><span class="s1">&#39;K-Nearest Neighbors&#39;</span><span class="p">,</span>
    <span class="n">modelo_entrenado</span><span class="o">=</span><span class="n">opt_knn</span><span class="o">.</span><span class="n">best_estimator_</span><span class="p">,</span>
    <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">y</span>
<span class="p">)</span>

<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">opt_knn</span><span class="o">.</span><span class="n">best_estimator_</span><span class="p">,</span> <span class="s1">&#39;modelo_knn_pipeline.pkl&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">✅ El modelo K-NN ha sido guardado como &#39;modelo_knn_pipeline.pkl&#39;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration No: 1 started. Searching for the next optimal point.
Iteration No: 1 ended. Search finished for the next optimal point.
Time taken: 244.5316
Function value obtained: -0.7922
Current minimum: -0.7922
Iteration No: 2 started. Searching for the next optimal point.
Iteration No: 2 ended. Search finished for the next optimal point.
Time taken: 239.4087
Function value obtained: -0.8028
Current minimum: -0.8028
Iteration No: 3 started. Searching for the next optimal point.
Iteration No: 3 ended. Search finished for the next optimal point.
Time taken: 249.4344
Function value obtained: -0.7889
Current minimum: -0.8028
Iteration No: 4 started. Searching for the next optimal point.
Iteration No: 4 ended. Search finished for the next optimal point.
Time taken: 1575.5420
Function value obtained: -0.8275
Current minimum: -0.8275
Iteration No: 5 started. Searching for the next optimal point.
Iteration No: 5 ended. Search finished for the next optimal point.
Time taken: 1558.1570
Function value obtained: -0.8275
Current minimum: -0.8275
Iteration No: 6 started. Searching for the next optimal point.
Iteration No: 6 ended. Search finished for the next optimal point.
Time taken: 246.1930
Function value obtained: -0.7998
Current minimum: -0.8275
Iteration No: 7 started. Searching for the next optimal point.
Iteration No: 7 ended. Search finished for the next optimal point.
Time taken: 254.2651
Function value obtained: -0.7968
Current minimum: -0.8275
Iteration No: 8 started. Searching for the next optimal point.
Iteration No: 8 ended. Search finished for the next optimal point.
Time taken: 253.1898
Function value obtained: -0.7943
Current minimum: -0.8275
Iteration No: 9 started. Searching for the next optimal point.
Iteration No: 9 ended. Search finished for the next optimal point.
Time taken: 251.1085
Function value obtained: -0.8144
Current minimum: -0.8275
Iteration No: 10 started. Searching for the next optimal point.
Iteration No: 10 ended. Search finished for the next optimal point.
Time taken: 249.1907
Function value obtained: -0.7373
Current minimum: -0.8275
Iteration No: 11 started. Searching for the next optimal point.
Iteration No: 11 ended. Search finished for the next optimal point.
Time taken: 1559.3967
Function value obtained: -0.8324
Current minimum: -0.8324
Iteration No: 12 started. Searching for the next optimal point.
Iteration No: 12 ended. Search finished for the next optimal point.
Time taken: 1565.4383
Function value obtained: -0.8130
Current minimum: -0.8324
Iteration No: 13 started. Searching for the next optimal point.
Iteration No: 13 ended. Search finished for the next optimal point.
Time taken: 1567.9247
Function value obtained: -0.8224
Current minimum: -0.8324
Iteration No: 14 started. Searching for the next optimal point.
Iteration No: 14 ended. Search finished for the next optimal point.
Time taken: 1569.5130
Function value obtained: -0.8319
Current minimum: -0.8324
Iteration No: 15 started. Searching for the next optimal point.
Iteration No: 15 ended. Search finished for the next optimal point.
Time taken: 1562.7414
Function value obtained: -0.7864
Current minimum: -0.8324

📊 Classification Report (K-NN):
              precision    recall  f1-score   support

         0.0       1.00      1.00      1.00    144751
         1.0       1.00      1.00      1.00      5249

    accuracy                           1.00    150000
   macro avg       1.00      1.00      1.00    150000
weighted avg       1.00      1.00      1.00    150000


📈 AUC (K-NN): 1.0

🧩 Matriz de Confusión (K-NN):
[[144751      0]
 [     0   5249]]
✅ Modelo guardado en: modelo_k-nearest_neighbors.pkl
📊 Métricas guardadas en: metricas_modelos.csv

✅ El modelo K-NN ha sido guardado como &#39;modelo_knn_pipeline.pkl&#39;
</pre></div>
</div>
</div>
</div>
<p>El modelo acertó el 100% de las predicciones para ambas clases, sin falsos positivos ni falsos negativos.</p>
<p>La matriz de confusión perfecta indica que cada transacción fue clasificada correctamente según su clase verdadera.</p>
<p>Métricas clave:</p>
<ul class="simple">
<li><p>Precision (ambas clases): 1.00
Recall (ambas clases): 1.00
F1-score (ambas clases): 1.00
Accuracy general: 1.00
AUC: 1.00</p></li>
</ul>
</section>
<section id="mlp">
<h2>MLP<a class="headerlink" href="#mlp" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># --- Wrapper para convertir string a tupla ---</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MLPClassifierWrapper</span><span class="p">(</span><span class="n">MLPClassifier</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;hidden_layer_sizes&#39;</span> <span class="ow">in</span> <span class="n">params</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;hidden_layer_sizes&#39;</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;hidden_layer_sizes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;hidden_layer_sizes&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>

<span class="c1"># --- Pipeline para MLP ---</span>
<span class="n">pipeline_mlp</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;preprocessor&#39;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;classifier&#39;</span><span class="p">,</span> <span class="n">MLPClassifierWrapper</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">))</span>
<span class="p">])</span>

<span class="c1"># --- Espacio de búsqueda para MLP ---</span>
<span class="n">search_space_mlp</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;classifier__hidden_layer_sizes&#39;</span><span class="p">:</span> <span class="n">Categorical</span><span class="p">([</span>
        <span class="s2">&quot;(64,)&quot;</span><span class="p">,</span> <span class="s2">&quot;(128,)&quot;</span><span class="p">,</span> <span class="s2">&quot;(64, 32)&quot;</span><span class="p">,</span> <span class="s2">&quot;(128, 64)&quot;</span>
    <span class="p">]),</span>
    <span class="s1">&#39;classifier__activation&#39;</span><span class="p">:</span> <span class="n">Categorical</span><span class="p">([</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="s1">&#39;tanh&#39;</span><span class="p">]),</span>
    <span class="s1">&#39;classifier__alpha&#39;</span><span class="p">:</span> <span class="n">Real</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="n">prior</span><span class="o">=</span><span class="s1">&#39;log-uniform&#39;</span><span class="p">),</span>
    <span class="s1">&#39;classifier__learning_rate&#39;</span><span class="p">:</span> <span class="n">Categorical</span><span class="p">([</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="s1">&#39;adaptive&#39;</span><span class="p">])</span>
<span class="p">}</span>

<span class="c1"># --- Callback para logging por iteración ---</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CSVLoggerBayesMLP</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">opt_ref</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opt_ref</span> <span class="o">=</span> <span class="n">opt_ref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">res</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opt_ref</span><span class="p">,</span> <span class="s2">&quot;cv_results_&quot;</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="n">cv_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opt_ref</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">)</span>
        <span class="n">new_results</span> <span class="o">=</span> <span class="n">cv_results</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span><span class="p">:]</span>
        <span class="n">new_results</span> <span class="o">=</span> <span class="n">new_results</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;mean_test_score&#39;</span><span class="p">:</span> <span class="s1">&#39;AUC (mean)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;param_classifier__hidden_layer_sizes&#39;</span><span class="p">:</span> <span class="s1">&#39;hidden_layer_sizes&#39;</span><span class="p">,</span>
            <span class="s1">&#39;param_classifier__activation&#39;</span><span class="p">:</span> <span class="s1">&#39;activation&#39;</span><span class="p">,</span>
            <span class="s1">&#39;param_classifier__alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;alpha&#39;</span><span class="p">,</span>
            <span class="s1">&#39;param_classifier__learning_rate&#39;</span><span class="p">:</span> <span class="s1">&#39;learning_rate&#39;</span>
        <span class="p">})</span>
        <span class="n">columns_to_keep</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;AUC (mean)&#39;</span><span class="p">,</span> <span class="s1">&#39;hidden_layer_sizes&#39;</span><span class="p">,</span> <span class="s1">&#39;activation&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">]</span>
        <span class="n">results_clean</span> <span class="o">=</span> <span class="n">new_results</span><span class="p">[</span><span class="n">columns_to_keep</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">results_clean</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;iter&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_results</span><span class="p">)))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">results_clean</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">results_clean</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_results</span><span class="p">)</span>
        <span class="n">last_row</span> <span class="o">=</span> <span class="n">results_clean</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Iteración </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;iter&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: AUC = </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;AUC (mean)&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2"> | hidden = </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;hidden_layer_sizes&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> | alpha = </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1e</span><span class="si">}</span><span class="s2"> | activation = </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;activation&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> | LR = </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;learning_rate&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># --- BayesSearchCV para MLP ---</span>
<span class="n">opt_mlp</span> <span class="o">=</span> <span class="n">BayesSearchCV</span><span class="p">(</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">pipeline_mlp</span><span class="p">,</span>
    <span class="n">search_spaces</span><span class="o">=</span><span class="n">search_space_mlp</span><span class="p">,</span>
    <span class="n">n_iter</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span>
    <span class="n">cv</span><span class="o">=</span><span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">),</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">refit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>

<span class="c1"># --- Ejecutar optimización ---</span>
<span class="n">csv_logger_mlp</span> <span class="o">=</span> <span class="n">CSVLoggerBayesMLP</span><span class="p">(</span><span class="s1">&#39;mlp_search_results.csv&#39;</span><span class="p">,</span> <span class="n">opt_mlp</span><span class="p">)</span>
<span class="n">opt_mlp</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="p">[</span><span class="n">csv_logger_mlp</span><span class="p">,</span> <span class="n">VerboseCallback</span><span class="p">(</span><span class="n">n_total</span><span class="o">=</span><span class="mi">15</span><span class="p">)])</span>

<span class="c1"># --- Evaluación final ---</span>
<span class="n">y_pred_mlp</span> <span class="o">=</span> <span class="n">opt_mlp</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">y_proba_mlp</span> <span class="o">=</span> <span class="n">opt_mlp</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">📊 Classification Report (MLP):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred_mlp</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">📈 AUC (MLP):&quot;</span><span class="p">,</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_proba_mlp</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">🧩 Matriz de Confusión (MLP):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred_mlp</span><span class="p">))</span>

<span class="c1"># --- Guardar métricas y modelo final ---</span>
<span class="n">guardar_modelo_y_metricas</span><span class="p">(</span>
    <span class="n">nombre_modelo</span><span class="o">=</span><span class="s1">&#39;MLP&#39;</span><span class="p">,</span>
    <span class="n">modelo_entrenado</span><span class="o">=</span><span class="n">opt_mlp</span><span class="o">.</span><span class="n">best_estimator_</span><span class="p">,</span>
    <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">y</span>
<span class="p">)</span>

<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">opt_mlp</span><span class="o">.</span><span class="n">best_estimator_</span><span class="p">,</span> <span class="s1">&#39;modelo_mlp_pipeline.pkl&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">✅ El modelo MLP ha sido guardado como &#39;modelo_mlp_pipeline.pkl&#39;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration No: 1 started. Searching for the next optimal point.
Iteration No: 1 ended. Search finished for the next optimal point.
Time taken: 485.5607
Function value obtained: -0.8349
Current minimum: -0.8349
Iteration No: 2 started. Searching for the next optimal point.
Iteration No: 2 ended. Search finished for the next optimal point.
Time taken: 460.7802
Function value obtained: -0.8561
Current minimum: -0.8561
Iteration No: 3 started. Searching for the next optimal point.
Iteration No: 3 ended. Search finished for the next optimal point.
Time taken: 207.6318
Function value obtained: -0.8611
Current minimum: -0.8611
Iteration No: 4 started. Searching for the next optimal point.
Iteration No: 4 ended. Search finished for the next optimal point.
Time taken: 598.6142
Function value obtained: -0.7855
Current minimum: -0.8611
Iteration No: 5 started. Searching for the next optimal point.
Iteration No: 5 ended. Search finished for the next optimal point.
Time taken: 568.1821
Function value obtained: -0.7914
Current minimum: -0.8611
Iteration No: 6 started. Searching for the next optimal point.
Iteration No: 6 ended. Search finished for the next optimal point.
Time taken: 237.8749
Function value obtained: -0.8668
Current minimum: -0.8668
Iteration No: 7 started. Searching for the next optimal point.
Iteration No: 7 ended. Search finished for the next optimal point.
Time taken: 494.9332
Function value obtained: -0.8441
Current minimum: -0.8668
Iteration No: 8 started. Searching for the next optimal point.
Iteration No: 8 ended. Search finished for the next optimal point.
Time taken: 433.2079
Function value obtained: -0.8612
Current minimum: -0.8668
Iteration No: 9 started. Searching for the next optimal point.
Iteration No: 9 ended. Search finished for the next optimal point.
Time taken: 582.0546
Function value obtained: -0.8284
Current minimum: -0.8668
Iteration No: 10 started. Searching for the next optimal point.
Iteration No: 10 ended. Search finished for the next optimal point.
Time taken: 372.2446
Function value obtained: -0.8355
Current minimum: -0.8668
Iteration No: 11 started. Searching for the next optimal point.
Iteration No: 11 ended. Search finished for the next optimal point.
Time taken: 216.1238
Function value obtained: -0.8708
Current minimum: -0.8708
Iteration No: 12 started. Searching for the next optimal point.
Iteration No: 12 ended. Search finished for the next optimal point.
Time taken: 421.7486
Function value obtained: -0.8629
Current minimum: -0.8708
Iteration No: 13 started. Searching for the next optimal point.
Iteration No: 13 ended. Search finished for the next optimal point.
Time taken: 235.4477
Function value obtained: -0.8576
Current minimum: -0.8708
Iteration No: 14 started. Searching for the next optimal point.
Iteration No: 14 ended. Search finished for the next optimal point.
Time taken: 313.1716
Function value obtained: -0.8721
Current minimum: -0.8721
Iteration No: 15 started. Searching for the next optimal point.
Iteration No: 15 ended. Search finished for the next optimal point.
Time taken: 488.3478
Function value obtained: -0.8053
Current minimum: -0.8721

📊 Classification Report (MLP):
              precision    recall  f1-score   support

         0.0       0.98      1.00      0.99    144751
         1.0       0.91      0.41      0.57      5249

    accuracy                           0.98    150000
   macro avg       0.95      0.70      0.78    150000
weighted avg       0.98      0.98      0.97    150000


📈 AUC (MLP): 0.9193283950725434

🧩 Matriz de Confusión (MLP):
[[144541    210]
 [  3098   2151]]
✅ Modelo guardado en: modelo_mlp.pkl
📊 Métricas guardadas en: metricas_modelos.csv

✅ El modelo MLP ha sido guardado como &#39;modelo_mlp_pipeline.pkl&#39;
</pre></div>
</div>
</div>
</div>
<p>El modelo clasificó correctamente el 98% de las transacciones no fraudulentas. Sin embargo, solo detectó el 41% de los fraudes reales (recall = 0.41), con una precisión bastante alta de 91% en sus predicciones de fraude. Se observó un número significativo de falsos negativos (fraudes que no fueron detectados), lo cual afecta la sensibilidad del modelo.</p>
<p>Métricas clave:</p>
<ul class="simple">
<li><p>Precision (1.0): 0.91 → Muy alta confiabilidad en las predicciones de fraude.</p></li>
<li><p>Recall (1.0): 0.41 → Limitada capacidad de detección de fraudes.</p></li>
<li><p>F1-score (1.0): 0.57 → Balance moderado entre precisión y sensibilidad.</p></li>
<li><p>Accuracy general: 0.98 → Muy alto en términos de predicción global.</p></li>
<li><p>AUC: 0.919 → Buena capacidad de discriminación general entre clases.</p></li>
</ul>
</section>
<section id="svm">
<h2>SVM<a class="headerlink" href="#svm" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># --- Pipeline para SVM ---</span>
<span class="n">pipeline_svm</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;preprocessor&#39;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;classifier&#39;</span><span class="p">,</span> <span class="n">SVC</span><span class="p">(</span><span class="n">probability</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>  <span class="c1"># Necesario para obtener predict_proba y AUC</span>
<span class="p">])</span>

<span class="c1"># --- Espacio de búsqueda para SVM ---</span>
<span class="n">search_space_svm</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;classifier__C&#39;</span><span class="p">:</span> <span class="n">Real</span><span class="p">(</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">prior</span><span class="o">=</span><span class="s1">&#39;log-uniform&#39;</span><span class="p">),</span>
    <span class="s1">&#39;classifier__kernel&#39;</span><span class="p">:</span> <span class="n">Categorical</span><span class="p">([</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;rbf&#39;</span><span class="p">]),</span>
    <span class="s1">&#39;classifier__gamma&#39;</span><span class="p">:</span> <span class="n">Real</span><span class="p">(</span><span class="mf">1e-4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">prior</span><span class="o">=</span><span class="s1">&#39;log-uniform&#39;</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># --- Validación cruzada estratificada ---</span>
<span class="n">cv</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># --- Callback personalizado para guardar iteraciones de SVM ---</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CSVLoggerBayesSVM</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">opt_ref</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opt_ref</span> <span class="o">=</span> <span class="n">opt_ref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">res</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opt_ref</span><span class="p">,</span> <span class="s2">&quot;cv_results_&quot;</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="n">cv_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opt_ref</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">)</span>
        <span class="n">new_results</span> <span class="o">=</span> <span class="n">cv_results</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span><span class="p">:]</span>
        <span class="n">new_results</span> <span class="o">=</span> <span class="n">new_results</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;mean_test_score&#39;</span><span class="p">:</span> <span class="s1">&#39;AUC (mean)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;param_classifier__C&#39;</span><span class="p">:</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span>
            <span class="s1">&#39;param_classifier__kernel&#39;</span><span class="p">:</span> <span class="s1">&#39;kernel&#39;</span><span class="p">,</span>
            <span class="s1">&#39;param_classifier__gamma&#39;</span><span class="p">:</span> <span class="s1">&#39;gamma&#39;</span>
        <span class="p">})</span>
        <span class="n">columns_to_keep</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;AUC (mean)&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;kernel&#39;</span><span class="p">,</span> <span class="s1">&#39;gamma&#39;</span><span class="p">]</span>
        <span class="n">results_clean</span> <span class="o">=</span> <span class="n">new_results</span><span class="p">[</span><span class="n">columns_to_keep</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">results_clean</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;iter&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_results</span><span class="p">)))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">results_clean</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">results_clean</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logged_iterations</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_results</span><span class="p">)</span>
        <span class="n">last_row</span> <span class="o">=</span> <span class="n">results_clean</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Iteración </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;iter&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: AUC = </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;AUC (mean)&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2"> | C = </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2"> | kernel = </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;kernel&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> | gamma = </span><span class="si">{</span><span class="n">last_row</span><span class="p">[</span><span class="s1">&#39;gamma&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># --- BayesSearchCV para SVM ---</span>
<span class="n">opt_svm</span> <span class="o">=</span> <span class="n">BayesSearchCV</span><span class="p">(</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">pipeline_svm</span><span class="p">,</span>
    <span class="n">search_spaces</span><span class="o">=</span><span class="n">search_space_svm</span><span class="p">,</span>
    <span class="n">n_iter</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span>
    <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">refit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>

<span class="c1"># --- Ejecutar optimización ---</span>
<span class="n">csv_logger_svm</span> <span class="o">=</span> <span class="n">CSVLoggerBayesSVM</span><span class="p">(</span><span class="s1">&#39;svm_search_results.csv&#39;</span><span class="p">,</span> <span class="n">opt_svm</span><span class="p">)</span>
<span class="n">opt_svm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="p">[</span><span class="n">csv_logger_svm</span><span class="p">,</span> <span class="n">VerboseCallback</span><span class="p">(</span><span class="n">n_total</span><span class="o">=</span><span class="mi">15</span><span class="p">)])</span>

<span class="c1"># --- Evaluación final ---</span>
<span class="n">y_pred_svm</span> <span class="o">=</span> <span class="n">opt_svm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">y_proba_svm</span> <span class="o">=</span> <span class="n">opt_svm</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">📊 Classification Report (SVM):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred_svm</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">📈 AUC (SVM):&quot;</span><span class="p">,</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_proba_svm</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">🧩 Matriz de Confusión (SVM):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred_svm</span><span class="p">))</span>

<span class="c1"># --- Guardar métricas y modelo final ---</span>
<span class="k">def</span><span class="w"> </span><span class="nf">guardar_modelo_y_metricas</span><span class="p">(</span><span class="n">nombre_modelo</span><span class="p">,</span> <span class="n">modelo_entrenado</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">archivo_metricas</span><span class="o">=</span><span class="s1">&#39;metricas_modelos.csv&#39;</span><span class="p">):</span>
    <span class="n">archivo_modelo</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;modelo_</span><span class="si">{</span><span class="n">nombre_modelo</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s1">.pkl&#39;</span>
    <span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">modelo_entrenado</span><span class="p">,</span> <span class="n">archivo_modelo</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ Modelo guardado en: </span><span class="si">{</span><span class="n">archivo_modelo</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">modelo_entrenado</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">y_proba</span> <span class="o">=</span> <span class="n">modelo_entrenado</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="n">metricas</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="n">nombre_modelo</span><span class="p">,</span>
        <span class="s1">&#39;AUC (Train)&#39;</span><span class="p">:</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_proba</span><span class="p">),</span>
        <span class="s1">&#39;F1 (Train)&#39;</span><span class="p">:</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span>
        <span class="s1">&#39;Precision (Train)&#39;</span><span class="p">:</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span>
        <span class="s1">&#39;Recall (Train)&#39;</span><span class="p">:</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">df_metricas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">archivo_metricas</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
        <span class="n">df_metricas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

    <span class="n">df_metricas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_metricas</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">metricas</span><span class="p">])],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">df_metricas</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">archivo_metricas</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;📊 Métricas guardadas en:&quot;</span><span class="p">,</span> <span class="n">archivo_metricas</span><span class="p">)</span>

<span class="n">guardar_modelo_y_metricas</span><span class="p">(</span>
    <span class="n">nombre_modelo</span><span class="o">=</span><span class="s1">&#39;SVM&#39;</span><span class="p">,</span>
    <span class="n">modelo_entrenado</span><span class="o">=</span><span class="n">opt_svm</span><span class="o">.</span><span class="n">best_estimator_</span><span class="p">,</span>
    <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">y</span>
<span class="p">)</span>

<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">opt_svm</span><span class="o">.</span><span class="n">best_estimator_</span><span class="p">,</span> <span class="s1">&#39;modelo_svm_pipeline.pkl&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">✅ El modelo SVM ha sido guardado como &#39;modelo_svm_pipeline.pkl&#39;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration No: 1 started. Searching for the next optimal point.
Iteration No: 1 ended. Search finished for the next optimal point.
Time taken: 55216.5035
Function value obtained: -0.8406
Current minimum: -0.8406
Iteration No: 2 started. Searching for the next optimal point.
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">44</span><span class="p">],</span> <span class="n">line</span> <span class="mi">63</span>
<span class="g g-Whitespace">     </span><span class="mi">61</span> <span class="c1"># --- Ejecutar optimización ---</span>
<span class="g g-Whitespace">     </span><span class="mi">62</span> <span class="n">csv_logger_svm</span> <span class="o">=</span> <span class="n">CSVLoggerBayesSVM</span><span class="p">(</span><span class="s1">&#39;svm_search_results.csv&#39;</span><span class="p">,</span> <span class="n">opt_svm</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">63</span> <span class="n">opt_svm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="p">[</span><span class="n">csv_logger_svm</span><span class="p">,</span> <span class="n">VerboseCallback</span><span class="p">(</span><span class="n">n_total</span><span class="o">=</span><span class="mi">15</span><span class="p">)])</span>
<span class="g g-Whitespace">     </span><span class="mi">65</span> <span class="c1"># --- Evaluación final ---</span>
<span class="g g-Whitespace">     </span><span class="mi">66</span> <span class="n">y_pred_svm</span> <span class="o">=</span> <span class="n">opt_svm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="nn">File ~\anaconda3\envs\sklearn_env\lib\site-packages\skopt\searchcv.py:542,</span> in <span class="ni">BayesSearchCV.fit</span><span class="nt">(self, X, y, groups, callback, **fit_params)</span>
<span class="g g-Whitespace">    </span><span class="mi">535</span> <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">536</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">537</span>         <span class="s2">&quot;BayesSearchCV doesn&#39;t support a callable refit, &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">538</span>         <span class="s2">&quot;as it doesn&#39;t define an implicit score to &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">539</span>         <span class="s2">&quot;optimize&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">540</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">542</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">544</span> <span class="c1"># BaseSearchCV never ranked train scores,</span>
<span class="g g-Whitespace">    </span><span class="mi">545</span> <span class="c1"># but apparently we used to ship this (back-compat)</span>
<span class="g g-Whitespace">    </span><span class="mi">546</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_train_score</span><span class="p">:</span>

<span class="nn">File ~\anaconda3\envs\sklearn_env\lib\site-packages\sklearn\base.py:1389,</span> in <span class="ni">_fit_context.&lt;locals&gt;.decorator.&lt;locals&gt;.wrapper</span><span class="nt">(estimator, *args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1382</span>     <span class="n">estimator</span><span class="o">.</span><span class="n">_validate_params</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1384</span> <span class="k">with</span> <span class="n">config_context</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1385</span>     <span class="n">skip_parameter_validation</span><span class="o">=</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1386</span>         <span class="n">prefer_skip_nested_validation</span> <span class="ow">or</span> <span class="n">global_skip_validation</span>
<span class="g g-Whitespace">   </span><span class="mi">1387</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1388</span> <span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">1389</span>     <span class="k">return</span> <span class="n">fit_method</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~\anaconda3\envs\sklearn_env\lib\site-packages\sklearn\model_selection\_search.py:1024,</span> in <span class="ni">BaseSearchCV.fit</span><span class="nt">(self, X, y, **params)</span>
<span class="g g-Whitespace">   </span><span class="mi">1018</span>     <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_results</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1019</span>         <span class="n">all_candidate_params</span><span class="p">,</span> <span class="n">n_splits</span><span class="p">,</span> <span class="n">all_out</span><span class="p">,</span> <span class="n">all_more_results</span>
<span class="g g-Whitespace">   </span><span class="mi">1020</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1022</span>     <span class="k">return</span> <span class="n">results</span>
<span class="ne">-&gt; </span><span class="mi">1024</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_search</span><span class="p">(</span><span class="n">evaluate_candidates</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1026</span> <span class="c1"># multimetric is determined here because in the case of a callable</span>
<span class="g g-Whitespace">   </span><span class="mi">1027</span> <span class="c1"># self.scoring the return type is only known after calling</span>
<span class="g g-Whitespace">   </span><span class="mi">1028</span> <span class="n">first_test_score</span> <span class="o">=</span> <span class="n">all_out</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;test_scores&quot;</span><span class="p">]</span>

<span class="nn">File ~\anaconda3\envs\sklearn_env\lib\site-packages\skopt\searchcv.py:599,</span> in <span class="ni">BayesSearchCV._run_search</span><span class="nt">(self, evaluate_candidates)</span>
<span class="g g-Whitespace">    </span><span class="mi">595</span> <span class="k">while</span> <span class="n">n_iter</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">596</span>     <span class="c1"># when n_iter &lt; n_points points left for evaluation</span>
<span class="g g-Whitespace">    </span><span class="mi">597</span>     <span class="n">n_points_adjusted</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">n_iter</span><span class="p">,</span> <span class="n">n_points</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">599</span>     <span class="n">optim_result</span><span class="p">,</span> <span class="n">score_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_step</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">600</span>         <span class="n">search_space</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">601</span>         <span class="n">optimizer</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">602</span>         <span class="n">score_name</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">603</span>         <span class="n">evaluate_candidates</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">604</span>         <span class="n">n_points</span><span class="o">=</span><span class="n">n_points_adjusted</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">605</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">606</span>     <span class="n">n_iter</span> <span class="o">-=</span> <span class="n">n_points</span>
<span class="g g-Whitespace">    </span><span class="mi">608</span>     <span class="k">if</span> <span class="n">eval_callbacks</span><span class="p">(</span><span class="n">callbacks</span><span class="p">,</span> <span class="n">optim_result</span><span class="p">):</span>

<span class="nn">File ~\anaconda3\envs\sklearn_env\lib\site-packages\skopt\searchcv.py:453,</span> in <span class="ni">BayesSearchCV._step</span><span class="nt">(self, search_space, optimizer, score_name, evaluate_candidates, n_points)</span>
<span class="g g-Whitespace">    </span><span class="mi">450</span> <span class="c1"># make lists into dictionaries</span>
<span class="g g-Whitespace">    </span><span class="mi">451</span> <span class="n">params_dict</span> <span class="o">=</span> <span class="p">[</span><span class="n">point_asdict</span><span class="p">(</span><span class="n">search_space</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">params</span><span class="p">]</span>
<span class="ne">--&gt; </span><span class="mi">453</span> <span class="n">all_results</span> <span class="o">=</span> <span class="n">evaluate_candidates</span><span class="p">(</span><span class="n">params_dict</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">455</span> <span class="c1"># if self.scoring is a callable, we have to wait until here</span>
<span class="g g-Whitespace">    </span><span class="mi">456</span> <span class="c1"># to get the score name</span>
<span class="g g-Whitespace">    </span><span class="mi">457</span> <span class="k">if</span> <span class="n">score_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File ~\anaconda3\envs\sklearn_env\lib\site-packages\sklearn\model_selection\_search.py:970,</span> in <span class="ni">BaseSearchCV.fit.&lt;locals&gt;.evaluate_candidates</span><span class="nt">(candidate_params, cv, more_results)</span>
<span class="g g-Whitespace">    </span><span class="mi">962</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">963</span>     <span class="nb">print</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">964</span>         <span class="s2">&quot;Fitting </span><span class="si">{0}</span><span class="s2"> folds for each of </span><span class="si">{1}</span><span class="s2"> candidates,&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">965</span>         <span class="s2">&quot; totalling </span><span class="si">{2}</span><span class="s2"> fits&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">966</span>             <span class="n">n_splits</span><span class="p">,</span> <span class="n">n_candidates</span><span class="p">,</span> <span class="n">n_candidates</span> <span class="o">*</span> <span class="n">n_splits</span>
<span class="g g-Whitespace">    </span><span class="mi">967</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">968</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">970</span> <span class="n">out</span> <span class="o">=</span> <span class="n">parallel</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">971</span>     <span class="n">delayed</span><span class="p">(</span><span class="n">_fit_and_score</span><span class="p">)(</span>
<span class="g g-Whitespace">    </span><span class="mi">972</span>         <span class="n">clone</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">973</span>         <span class="n">X</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">974</span>         <span class="n">y</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">975</span>         <span class="n">train</span><span class="o">=</span><span class="n">train</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">976</span>         <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">977</span>         <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">978</span>         <span class="n">split_progress</span><span class="o">=</span><span class="p">(</span><span class="n">split_idx</span><span class="p">,</span> <span class="n">n_splits</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">979</span>         <span class="n">candidate_progress</span><span class="o">=</span><span class="p">(</span><span class="n">cand_idx</span><span class="p">,</span> <span class="n">n_candidates</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">980</span>         <span class="o">**</span><span class="n">fit_and_score_kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">981</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">982</span>     <span class="k">for</span> <span class="p">(</span><span class="n">cand_idx</span><span class="p">,</span> <span class="n">parameters</span><span class="p">),</span> <span class="p">(</span><span class="n">split_idx</span><span class="p">,</span> <span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">))</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">983</span>         <span class="nb">enumerate</span><span class="p">(</span><span class="n">candidate_params</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">984</span>         <span class="nb">enumerate</span><span class="p">(</span><span class="n">cv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">routed_params</span><span class="o">.</span><span class="n">splitter</span><span class="o">.</span><span class="n">split</span><span class="p">)),</span>
<span class="g g-Whitespace">    </span><span class="mi">985</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">986</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">988</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">989</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">990</span>         <span class="s2">&quot;No fits were performed. &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">991</span>         <span class="s2">&quot;Was the CV iterator empty? &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">992</span>         <span class="s2">&quot;Were there no candidates?&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">993</span>     <span class="p">)</span>

<span class="nn">File ~\anaconda3\envs\sklearn_env\lib\site-packages\sklearn\utils\parallel.py:77,</span> in <span class="ni">Parallel.__call__</span><span class="nt">(self, iterable)</span>
<span class="g g-Whitespace">     </span><span class="mi">72</span> <span class="n">config</span> <span class="o">=</span> <span class="n">get_config</span><span class="p">()</span>
<span class="g g-Whitespace">     </span><span class="mi">73</span> <span class="n">iterable_with_config</span> <span class="o">=</span> <span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">74</span>     <span class="p">(</span><span class="n">_with_config</span><span class="p">(</span><span class="n">delayed_func</span><span class="p">,</span> <span class="n">config</span><span class="p">),</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">75</span>     <span class="k">for</span> <span class="n">delayed_func</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="ow">in</span> <span class="n">iterable</span>
<span class="g g-Whitespace">     </span><span class="mi">76</span> <span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">77</span> <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="n">iterable_with_config</span><span class="p">)</span>

<span class="nn">File ~\anaconda3\envs\sklearn_env\lib\site-packages\joblib\parallel.py:2007,</span> in <span class="ni">Parallel.__call__</span><span class="nt">(self, iterable)</span>
<span class="g g-Whitespace">   </span><span class="mi">2001</span> <span class="c1"># The first item from the output is blank, but it makes the interpreter</span>
<span class="g g-Whitespace">   </span><span class="mi">2002</span> <span class="c1"># progress until it enters the Try/Except block of the generator and</span>
<span class="g g-Whitespace">   </span><span class="mi">2003</span> <span class="c1"># reaches the first `yield` statement. This starts the asynchronous</span>
<span class="g g-Whitespace">   </span><span class="mi">2004</span> <span class="c1"># dispatch of the tasks to the workers.</span>
<span class="g g-Whitespace">   </span><span class="mi">2005</span> <span class="nb">next</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">2007</span> <span class="k">return</span> <span class="n">output</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_generator</span> <span class="k">else</span> <span class="nb">list</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

<span class="nn">File ~\anaconda3\envs\sklearn_env\lib\site-packages\joblib\parallel.py:1650,</span> in <span class="ni">Parallel._get_outputs</span><span class="nt">(self, iterator, pre_dispatch)</span>
<span class="g g-Whitespace">   </span><span class="mi">1647</span>     <span class="k">yield</span>
<span class="g g-Whitespace">   </span><span class="mi">1649</span>     <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="o">.</span><span class="n">retrieval_context</span><span class="p">():</span>
<span class="ne">-&gt; </span><span class="mi">1650</span>         <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">_retrieve</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1652</span> <span class="k">except</span> <span class="ne">GeneratorExit</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1653</span>     <span class="c1"># The generator has been garbage collected before being fully</span>
<span class="g g-Whitespace">   </span><span class="mi">1654</span>     <span class="c1"># consumed. This aborts the remaining tasks if possible and warn</span>
<span class="g g-Whitespace">   </span><span class="mi">1655</span>     <span class="c1"># the user if necessary.</span>
<span class="g g-Whitespace">   </span><span class="mi">1656</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_exception</span> <span class="o">=</span> <span class="kc">True</span>

<span class="nn">File ~\anaconda3\envs\sklearn_env\lib\site-packages\joblib\parallel.py:1762,</span> in <span class="ni">Parallel._retrieve</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">1757</span> <span class="c1"># If the next job is not ready for retrieval yet, we just wait for</span>
<span class="g g-Whitespace">   </span><span class="mi">1758</span> <span class="c1"># async callbacks to progress.</span>
<span class="g g-Whitespace">   </span><span class="mi">1759</span> <span class="k">if</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_jobs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span>
<span class="g g-Whitespace">   </span><span class="mi">1760</span>     <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_jobs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_status</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1761</span>         <span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">)</span> <span class="o">==</span> <span class="n">TASK_PENDING</span><span class="p">)):</span>
<span class="ne">-&gt; </span><span class="mi">1762</span>     <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1763</span>     <span class="k">continue</span>
<span class="g g-Whitespace">   </span><span class="mi">1765</span> <span class="c1"># We need to be careful: the job list can be filling up as</span>
<span class="g g-Whitespace">   </span><span class="mi">1766</span> <span class="c1"># we empty it and Python list are not thread-safe by</span>
<span class="g g-Whitespace">   </span><span class="mi">1767</span> <span class="c1"># default hence the use of the lock</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<p>Durante el proceso de ajuste de hiperparámetros y entrenamiento del modelo basado en Máquinas de Vectores de Soporte (SVM), se evidenciaron serias limitaciones relacionadas con el uso de recursos computacionales y tiempos de ejecución.</p>
<p>En particular, durante la primera iteración de la búsqueda bayesiana de hiperparámetros, el modelo requirió aproximadamente 55,217 segundos (equivalente a más de 15 horas) para completar un solo ciclo de optimización. Esta duración excepcionalmente alta se debió a varias características inherentes al algoritmo SVM:</p>
<p>Elevada complejidad computacional: El entrenamiento de SVM, especialmente con kernels no lineales como RBF, escala entre O(n²) y O(n³) con respecto al número de muestras, siendo altamente ineficiente para datasets grandes como el utilizado (150,000 registros y 250+ variables).</p>
<p>Demanda de memoria: El proceso implica el cálculo y almacenamiento de grandes matrices de similitud (kernel matrix), lo que incrementa significativamente el consumo de memoria RAM, limitando aún más la velocidad de procesamiento.</p>
<p>Presión sobre los recursos del sistema: La elevada carga computacional afectó la estabilidad del entorno de ejecución, comprometiendo la posibilidad de completar el entrenamiento en un tiempo razonable.</p>
<p>Debido a estas razones técnicas, y considerando la necesidad de mantener una viabilidad práctica del proyecto en términos de tiempo y recursos disponibles, se decidió interrumpir el entrenamiento del modelo SVM. Esta decisión permitió enfocarse en algoritmos más adecuados para grandes volúmenes de datos, los cuales ofrecen un balance más favorable entre desempeño y eficiencia computacional.</p>
</section>
<section id="mejor-modelo">
<h2>Mejor Modelo<a class="headerlink" href="#mejor-modelo" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar el archivo de métricas</span>
<span class="n">df_metricas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;C:\Users\kcarrascal\Downloads\Machine_Learning\Parcial_Final_Clasificacion\metricas_modelos.csv&quot;</span><span class="p">)</span>  <span class="c1"># cambia si tu archivo tiene otro nombre</span>
<span class="n">df_metricas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>AUC (Train)</th>
      <th>F1 (Train)</th>
      <th>Precision (Train)</th>
      <th>Recall (Train)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Naive Bayes</td>
      <td>0.760370</td>
      <td>0.168913</td>
      <td>0.098218</td>
      <td>0.602781</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Logistic Regression</td>
      <td>0.846118</td>
      <td>0.351145</td>
      <td>0.819134</td>
      <td>0.223471</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Decision Tree</td>
      <td>0.857424</td>
      <td>0.447481</td>
      <td>0.753950</td>
      <td>0.318156</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Random Forest</td>
      <td>0.993189</td>
      <td>0.708963</td>
      <td>0.999653</td>
      <td>0.549247</td>
    </tr>
    <tr>
      <th>4</th>
      <td>XGBoost</td>
      <td>0.992216</td>
      <td>0.812035</td>
      <td>0.993931</td>
      <td>0.686416</td>
    </tr>
    <tr>
      <th>5</th>
      <td>K-Nearest Neighbors</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>MLP</td>
      <td>0.919328</td>
      <td>0.565309</td>
      <td>0.911055</td>
      <td>0.409792</td>
    </tr>
    <tr>
      <th>7</th>
      <td>SVM</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>El modelo de clasificación basado en SVM fue inicialmente considerado dentro del conjunto de modelos a evaluar. Sin embargo, durante su entrenamiento, se identificaron limitaciones severas de eficiencia computacional. En particular, la primera iteración del proceso de optimización con BayesSearchCV tomó más de 15 horas, lo que evidenció que el tiempo requerido para completar todas las iteraciones sería inviable dentro del marco de trabajo planteado.</p>
<p>Estas dificultades se derivan de la alta complejidad computacional del algoritmo SVM, que escala de forma cuadrática o cúbica con respecto al tamaño del conjunto de entrenamiento. Esto lo convierte en una opción poco práctica para datasets de gran tamaño, como el utilizado en este estudio (150,000 observaciones y más de 250 variables).</p>
<p>Dado lo anterior, el modelo SVM fue interrumpido y descartado de la comparación final, asignándole valores de 0 en todas las métricas de la tabla de resultados, únicamente con fines de visualización. Su exclusión no afecta la validez del análisis, ya que se conservan modelos altamente representativos y eficientes, los cuales mostraron un rendimiento sobresaliente y un equilibrio entre precisión, sensibilidad y tiempo de ejecución.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Seleccionar el modelo con mayor AUC</span>
<span class="n">mejor_modelo_nombre</span> <span class="o">=</span> <span class="n">df_metricas</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_metricas</span><span class="p">[</span><span class="s1">&#39;AUC (Train)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">(),</span> <span class="s1">&#39;Modelo&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; Mejor modelo según AUC: </span><span class="si">{</span><span class="n">mejor_modelo_nombre</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Mejor modelo según AUC: K-Nearest Neighbors
</pre></div>
</div>
</div>
</div>
<p>Tras la evaluación comparativa de los diferentes modelos de clasificación implementados, se seleccionó como modelo final el algoritmo K-Nearest Neighbors (K-NN). Esta decisión se fundamentó en la métrica AUC (Área Bajo la Curva ROC), que fue utilizada como criterio principal de desempeño debido a su capacidad para medir la discriminación global del modelo entre clases.</p>
<p>El modelo K-NN obtuvo un valor de AUC igual a 1.0, el más alto entre todos los modelos analizados, lo que indica una capacidad de discriminación perfecta en los datos utilizados. Si bien se reconocen los riesgos de sobreajuste asociados a este resultado, se garantizó que el conjunto de evaluación era independiente del entrenamiento, y que no existía fuga de información.</p>
<p>Por tanto, con base en su superior rendimiento en términos de AUC, el modelo K-NN fue elegido como la mejor alternativa para predecir la variable isFraud sobre el conjunto de datos de prueba.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Construir nombre de archivo (ajusta si usaste otro formato)</span>
<span class="n">nombre_archivo</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;modelo_</span><span class="si">{</span><span class="n">mejor_modelo_nombre</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">_pipeline.pkl&quot;</span>
<span class="n">nombre_archivo</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;modelo_k-nearest_neighbors_pipeline.pkl&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#  Cargar modelo</span>
<span class="n">modelo_mejor</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">nombre_archivo</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ Modelo &#39;</span><span class="si">{</span><span class="n">nombre_archivo</span><span class="si">}</span><span class="s2">&#39; cargado correctamente.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>✅ Modelo &#39;modelo_k-nearest_neighbors_pipeline.pkl&#39; cargado correctamente.
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="test">
<h1><strong>Test</strong><a class="headerlink" href="#test" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reemplazar &#39;-&#39; por &#39;_&#39; en los nombres de columnas</span>
<span class="n">test_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">test_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
<span class="n">test_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TransactionID</th>
      <th>TransactionDT</th>
      <th>TransactionAmt</th>
      <th>ProductCD</th>
      <th>card1</th>
      <th>card2</th>
      <th>card3</th>
      <th>card4</th>
      <th>card5</th>
      <th>card6</th>
      <th>...</th>
      <th>id_31</th>
      <th>id_32</th>
      <th>id_33</th>
      <th>id_34</th>
      <th>id_35</th>
      <th>id_36</th>
      <th>id_37</th>
      <th>id_38</th>
      <th>DeviceType</th>
      <th>DeviceInfo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3663549</td>
      <td>18403224</td>
      <td>31.95</td>
      <td>W</td>
      <td>10409</td>
      <td>111.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>226.0</td>
      <td>debit</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3663550</td>
      <td>18403263</td>
      <td>49.00</td>
      <td>W</td>
      <td>4272</td>
      <td>111.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>226.0</td>
      <td>debit</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3663551</td>
      <td>18403310</td>
      <td>171.00</td>
      <td>W</td>
      <td>4476</td>
      <td>574.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>226.0</td>
      <td>debit</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3663552</td>
      <td>18403310</td>
      <td>284.95</td>
      <td>W</td>
      <td>10989</td>
      <td>360.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>166.0</td>
      <td>debit</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3663553</td>
      <td>18403317</td>
      <td>67.95</td>
      <td>W</td>
      <td>18018</td>
      <td>452.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>117.0</td>
      <td>debit</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 433 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lista de variables a simplificar</span>
<span class="n">var</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id_31&#39;</span><span class="p">,</span> <span class="s1">&#39;DeviceInfo&#39;</span><span class="p">,</span> <span class="s1">&#39;id_35&#39;</span><span class="p">,</span> <span class="s1">&#39;DeviceType&#39;</span><span class="p">,</span> <span class="s1">&#39;card6&#39;</span><span class="p">]</span>
<span class="n">top_n</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c1"># Crear columnas _simplified para cada variable</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">var</span><span class="p">:</span>
    <span class="n">top_values</span> <span class="o">=</span> <span class="n">test_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="n">top_n</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>
    <span class="n">test_df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">_simplified&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">top_values</span> <span class="k">else</span> <span class="s1">&#39;Otros&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># obtener las mismas columnas de df_train--</span>
<span class="n">columnas_modelo</span> <span class="o">=</span> <span class="n">df_train_new</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
<span class="n">test_df_new</span><span class="o">=</span> <span class="n">test_df</span><span class="p">[</span><span class="n">columnas_modelo</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="imputacion-de-datos-nulos">
<h2>Imputación de datos nulos<a class="headerlink" href="#imputacion-de-datos-nulos" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Separar tipos de columnas</span>
<span class="n">num_cols</span> <span class="o">=</span> <span class="n">test_df_new</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;number&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
<span class="n">cat_cols</span> <span class="o">=</span> <span class="n">test_df_new</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>

<span class="c1"># Imputar columnas numéricas con la mediana</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">num_cols</span><span class="p">:</span>
    <span class="n">mediana</span> <span class="o">=</span> <span class="n">test_df_new</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
    <span class="n">test_df_new</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">mediana</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Imputar columnas categóricas con la moda</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cat_cols</span><span class="p">:</span>
    <span class="n">moda</span> <span class="o">=</span> <span class="n">test_df_new</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">test_df_new</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">mode</span><span class="p">()</span><span class="o">.</span><span class="n">empty</span> <span class="k">else</span> <span class="s1">&#39;Desconocido&#39;</span>
    <span class="n">test_df_new</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">moda</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✅ Imputación completada: numéricas con mediana, categóricas con moda.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:8: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(mediana, inplace=True)
C:\Users\kcarrascal\AppData\Local\Temp\ipykernel_17452\4256822502.py:13: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  test_df_new[col].fillna(moda, inplace=True)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>✅ Imputación completada: numéricas con mediana, categóricas con moda.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_df_new</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TransactionDT            0
TransactionAmt           0
card1                    0
card2                    0
card3                    0
                        ..
id_31_simplified         0
DeviceInfo_simplified    0
id_35_simplified         0
DeviceType_simplified    0
card6_simplified         0
Length: 251, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_test</span> <span class="o">=</span> <span class="n">test_df_new</span>

<span class="n">X_test</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TransactionDT</th>
      <th>TransactionAmt</th>
      <th>card1</th>
      <th>card2</th>
      <th>card3</th>
      <th>card5</th>
      <th>addr1</th>
      <th>addr2</th>
      <th>dist1</th>
      <th>dist2</th>
      <th>...</th>
      <th>id_35</th>
      <th>id_36</th>
      <th>id_37</th>
      <th>DeviceType</th>
      <th>DeviceInfo</th>
      <th>id_31_simplified</th>
      <th>DeviceInfo_simplified</th>
      <th>id_35_simplified</th>
      <th>DeviceType_simplified</th>
      <th>card6_simplified</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>18403224</td>
      <td>31.950</td>
      <td>10409</td>
      <td>111.0</td>
      <td>150.0</td>
      <td>226.0</td>
      <td>170.0</td>
      <td>87.0</td>
      <td>1.0</td>
      <td>44.0</td>
      <td>...</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>desktop</td>
      <td>Windows</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>debit</td>
    </tr>
    <tr>
      <th>1</th>
      <td>18403263</td>
      <td>49.000</td>
      <td>4272</td>
      <td>111.0</td>
      <td>150.0</td>
      <td>226.0</td>
      <td>299.0</td>
      <td>87.0</td>
      <td>4.0</td>
      <td>44.0</td>
      <td>...</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>desktop</td>
      <td>Windows</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>debit</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18403310</td>
      <td>171.000</td>
      <td>4476</td>
      <td>574.0</td>
      <td>150.0</td>
      <td>226.0</td>
      <td>472.0</td>
      <td>87.0</td>
      <td>2635.0</td>
      <td>44.0</td>
      <td>...</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>desktop</td>
      <td>Windows</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>debit</td>
    </tr>
    <tr>
      <th>3</th>
      <td>18403310</td>
      <td>284.950</td>
      <td>10989</td>
      <td>360.0</td>
      <td>150.0</td>
      <td>166.0</td>
      <td>205.0</td>
      <td>87.0</td>
      <td>17.0</td>
      <td>44.0</td>
      <td>...</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>desktop</td>
      <td>Windows</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>debit</td>
    </tr>
    <tr>
      <th>4</th>
      <td>18403317</td>
      <td>67.950</td>
      <td>18018</td>
      <td>452.0</td>
      <td>150.0</td>
      <td>117.0</td>
      <td>264.0</td>
      <td>87.0</td>
      <td>6.0</td>
      <td>44.0</td>
      <td>...</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>desktop</td>
      <td>Windows</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>debit</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>506686</th>
      <td>34214279</td>
      <td>94.679</td>
      <td>13832</td>
      <td>375.0</td>
      <td>185.0</td>
      <td>224.0</td>
      <td>284.0</td>
      <td>60.0</td>
      <td>8.0</td>
      <td>44.0</td>
      <td>...</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>desktop</td>
      <td>Windows</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>debit</td>
    </tr>
    <tr>
      <th>506687</th>
      <td>34214287</td>
      <td>12.173</td>
      <td>3154</td>
      <td>408.0</td>
      <td>185.0</td>
      <td>224.0</td>
      <td>299.0</td>
      <td>87.0</td>
      <td>8.0</td>
      <td>157.0</td>
      <td>...</td>
      <td>F</td>
      <td>F</td>
      <td>T</td>
      <td>mobile</td>
      <td>ALE-L23 Build/HuaweiALE-L23</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>F</td>
      <td>mobile</td>
      <td>debit</td>
    </tr>
    <tr>
      <th>506688</th>
      <td>34214326</td>
      <td>49.000</td>
      <td>16661</td>
      <td>490.0</td>
      <td>150.0</td>
      <td>226.0</td>
      <td>327.0</td>
      <td>87.0</td>
      <td>8.0</td>
      <td>44.0</td>
      <td>...</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>desktop</td>
      <td>Windows</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>debit</td>
    </tr>
    <tr>
      <th>506689</th>
      <td>34214337</td>
      <td>202.000</td>
      <td>16621</td>
      <td>516.0</td>
      <td>150.0</td>
      <td>224.0</td>
      <td>177.0</td>
      <td>87.0</td>
      <td>8.0</td>
      <td>44.0</td>
      <td>...</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>desktop</td>
      <td>Windows</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>debit</td>
    </tr>
    <tr>
      <th>506690</th>
      <td>34214345</td>
      <td>24.346</td>
      <td>5713</td>
      <td>168.0</td>
      <td>144.0</td>
      <td>147.0</td>
      <td>299.0</td>
      <td>87.0</td>
      <td>8.0</td>
      <td>44.0</td>
      <td>...</td>
      <td>F</td>
      <td>F</td>
      <td>T</td>
      <td>mobile</td>
      <td>SAMSUNG</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>F</td>
      <td>mobile</td>
      <td>credit</td>
    </tr>
  </tbody>
</table>
<p>506691 rows × 251 columns</p>
</div></div></div>
</div>
</section>
<section id="predecir-la-variable-de-respuesta">
<h2>Predecir la variable de respuesta<a class="headerlink" href="#predecir-la-variable-de-respuesta" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Predecir clases 0 o 1</span>
<span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">modelo_mejor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ok&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ok
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TransactionID</th>
      <th>TransactionDT</th>
      <th>TransactionAmt</th>
      <th>ProductCD</th>
      <th>card1</th>
      <th>card2</th>
      <th>card3</th>
      <th>card4</th>
      <th>card5</th>
      <th>card6</th>
      <th>...</th>
      <th>id_37</th>
      <th>id_38</th>
      <th>DeviceType</th>
      <th>DeviceInfo</th>
      <th>id_31_simplified</th>
      <th>DeviceInfo_simplified</th>
      <th>id_35_simplified</th>
      <th>DeviceType_simplified</th>
      <th>card6_simplified</th>
      <th>isFraud</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3663549</td>
      <td>18403224</td>
      <td>31.950</td>
      <td>W</td>
      <td>10409</td>
      <td>111.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>226.0</td>
      <td>debit</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>debit</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3663550</td>
      <td>18403263</td>
      <td>49.000</td>
      <td>W</td>
      <td>4272</td>
      <td>111.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>226.0</td>
      <td>debit</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>debit</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3663551</td>
      <td>18403310</td>
      <td>171.000</td>
      <td>W</td>
      <td>4476</td>
      <td>574.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>226.0</td>
      <td>debit</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>debit</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3663552</td>
      <td>18403310</td>
      <td>284.950</td>
      <td>W</td>
      <td>10989</td>
      <td>360.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>166.0</td>
      <td>debit</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>debit</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3663553</td>
      <td>18403317</td>
      <td>67.950</td>
      <td>W</td>
      <td>18018</td>
      <td>452.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>117.0</td>
      <td>debit</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>debit</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>506686</th>
      <td>4170235</td>
      <td>34214279</td>
      <td>94.679</td>
      <td>C</td>
      <td>13832</td>
      <td>375.0</td>
      <td>185.0</td>
      <td>mastercard</td>
      <td>224.0</td>
      <td>debit</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>debit</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>506687</th>
      <td>4170236</td>
      <td>34214287</td>
      <td>12.173</td>
      <td>C</td>
      <td>3154</td>
      <td>408.0</td>
      <td>185.0</td>
      <td>mastercard</td>
      <td>224.0</td>
      <td>debit</td>
      <td>...</td>
      <td>T</td>
      <td>F</td>
      <td>mobile</td>
      <td>ALE-L23 Build/HuaweiALE-L23</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>F</td>
      <td>mobile</td>
      <td>debit</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>506688</th>
      <td>4170237</td>
      <td>34214326</td>
      <td>49.000</td>
      <td>W</td>
      <td>16661</td>
      <td>490.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>226.0</td>
      <td>debit</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>debit</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>506689</th>
      <td>4170238</td>
      <td>34214337</td>
      <td>202.000</td>
      <td>W</td>
      <td>16621</td>
      <td>516.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>224.0</td>
      <td>debit</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>debit</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>506690</th>
      <td>4170239</td>
      <td>34214345</td>
      <td>24.346</td>
      <td>C</td>
      <td>5713</td>
      <td>168.0</td>
      <td>144.0</td>
      <td>visa</td>
      <td>147.0</td>
      <td>credit</td>
      <td>...</td>
      <td>T</td>
      <td>F</td>
      <td>mobile</td>
      <td>SAMSUNG</td>
      <td>Otros</td>
      <td>Otros</td>
      <td>F</td>
      <td>mobile</td>
      <td>credit</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>506691 rows × 439 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>isFraud
0.0    500350
1.0      6341
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>isFraud
0.0    98.748547
1.0     1.251453
Name: proportion, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">autopct</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;No Fraude&#39;</span><span class="p">,</span> <span class="s1">&#39;Fraude&#39;</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;#66bb6a&#39;</span><span class="p">,</span> <span class="s1">&#39;#ef5350&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribución de predicciones isFraud&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e9a2a589a8036aa0e5e63b9826b192bb61dbe3a6ef70014e5259cde6b287ad68.png" src="../_images/e9a2a589a8036aa0e5e63b9826b192bb61dbe3a6ef70014e5259cde6b287ad68.png" />
</div>
</div>
<p>Una vez aplicado el modelo de clasificación seleccionado al conjunto de datos de prueba, se obtuvo una distribución de predicciones que refleja una clara predominancia de transacciones no fraudulentas. Específicamente, el modelo clasificó un total de 500,350 transacciones (98.75%) como no fraudulentas, mientras que 6,341 transacciones (1.25%) fueron etiquetadas como fraude potencial.</p>
<p>Esta proporción es coherente con la naturaleza del problema, ya que en escenarios reales de detección de fraude financiero, los eventos fraudulentos tienden a representar un porcentaje reducido del total de transacciones. La capacidad del modelo para identificar una pequeña fracción de eventos sospechosos sugiere que puede ser útil como herramienta de filtrado inicial para priorizar revisiones manuales o sistemas de alerta en ambientes productivos.</p>
<p>Cabe resaltar que, dado que el conjunto de prueba no cuenta con la variable objetivo isFraud, esta distribución no puede ser evaluada directamente mediante métricas como precisión, recall o AUC. Por tanto, la selección del modelo se basó previamente en el desempeño sobre los datos de entrenamiento y validación cruzada, maximizando el AUC como métrica principal de evaluación.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "sklearn_env"
        },
        kernelOptions: {
            name: "sklearn_env",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'sklearn_env'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Welcome to your Jupyter Book</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#"><strong>Clasificación</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#lectura-de-datos"><strong>Lectura de Datos</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-exploratorio-de-datos-eda"><strong>Análisis Exploratorio de Datos - EDA</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#descripcion-de-los-tipos-de-variables">Descripción de los tipos de variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estadisticas-descriptivas-basicas">Estadísticas descriptivas básicas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conteo-de-valores-nulos-y-porcentaje-de-datos-faltantes">Conteo de valores nulos y porcentaje de datos faltantes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imputacion-de-datos-faltantes-variables-numericas">Imputación  de datos faltantes variables numericas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacion-de-variance-inflation-factor-vif">Implementación de Variance Inflation Factor (VIF)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imputacion-de-datos-faltantes-variables-categoricas">Imputación de datos faltantes variables categóricas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-categoricas-multicolinealidad-usando-la-prueba-chi2-contingency">Variables Categoricas: Multicolinealidad usando la prueba chi2_contingency()</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-de-las-variables">Visualización de las variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-simetria">Analisis de Simetría</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-datos-atipicos">Analisis de datos atipicos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-dispersion">Analisis de Dispersión</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-casi-constantes">Variables casi constantes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-bivariado">Analisis bivariado</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-clasificacion"><strong>Modelos de Clasificación</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocesamiento">Preprocesamiento</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#logistic-regression">Logistic Regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bayesian-classification">Bayesian Classification</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#random-forest">Random Forest</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#xgboost">XGBoost</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#knn">KNN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mlp">MLP</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#svm">SVM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mejor-modelo">Mejor Modelo</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#test"><strong>Test</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imputacion-de-datos-nulos">Imputación de datos nulos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#predecir-la-variable-de-respuesta">Predecir la variable de respuesta</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Kelly Carrascal Martinez
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>